{"id":"rush-2pv","title":"Rush 1.0 Critical Features","description":"Complete the essential missing features to make Rush production-ready for 1.0 release.\n\n## Success Criteria\n- All 8 stories completed with tests\n- 1.0 release candidate builds successfully\n- All existing 109 tests still pass\n- Can replace bash/zsh for daily development work\n- Installation takes \u003c 5 minutes on any platform\n- Documentation updated for all new features","status":"open","priority":2,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-20T09:10:32.205825-08:00","created_by":"Asher","updated_at":"2026-01-20T09:10:32.205825-08:00","labels":["1.0","epic","rush"]}
{"id":"rush-2pv.1","title":"US-003: Robust Pipeline Implementation","description":"As a power user, I want complex multi-stage pipelines to work reliably so that I can compose commands like any Unix shell.\n\n## Acceptance Criteria\n- [ ] Multi-stage pipes work: `cat file | grep pattern | sort | uniq -c`\n- [ ] Proper error propagation through pipeline\n- [ ] Pipeline exit code is last command's exit code\n- [ ] SIGPIPE handling (broken pipe errors)\n- [ ] Handles large data streams without blocking\n- [ ] Works with builtins and external commands\n- [ ] cargo test passes (all tests including new pipeline tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n- [ ] Manual testing: complex pipelines with 5+ stages\n\n## Technical Notes\n- Review and harden src/executor/pipeline.rs\n- Add comprehensive pipeline tests\n- Handle backpressure and buffering\n- Test with large files and many pipeline stages","status":"open","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T09:10:32.32608-08:00","created_by":"Asher","updated_at":"2026-01-20T09:10:32.32608-08:00","labels":["1.0","backend","critical","rush"],"dependencies":[{"issue_id":"rush-2pv.1","depends_on_id":"rush-2pv","type":"parent-child","created_at":"2026-01-20T09:10:32.327547-08:00","created_by":"Asher"}]}
{"id":"rush-2pv.2","title":"US-002: File Redirections","description":"As a shell user, I want standard Unix redirections (\u003e, \u003e\u003e, 2\u003e, \u0026\u003e) so that I can redirect output to files like any Unix shell.\n\n## Acceptance Criteria\n- [ ] stdout redirection: `echo \"test\" \u003e file.txt`\n- [ ] Append mode: `echo \"more\" \u003e\u003e file.txt`\n- [ ] stderr redirection: `command 2\u003e errors.log`\n- [ ] Combined redirection: `command \u0026\u003e output.log`\n- [ ] Input redirection: `command \u003c input.txt`\n- [ ] Works with pipes: `cmd | grep foo \u003e results.txt`\n- [ ] cargo test passes (all tests including new redirection tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n- [ ] Manual testing: verify files created with correct content\n\n## Technical Notes\n- Extend src/executor/pipeline.rs\n- Parse redirection operators in lexer/parser\n- Handle file creation/appending\n- Properly separate stdout/stderr streams","status":"open","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T09:10:32.445054-08:00","created_by":"Asher","updated_at":"2026-01-20T09:10:32.445054-08:00","labels":["1.0","backend","critical","rush"],"dependencies":[{"issue_id":"rush-2pv.2","depends_on_id":"rush-2pv","type":"parent-child","created_at":"2026-01-20T09:10:32.446095-08:00","created_by":"Asher"},{"issue_id":"rush-2pv.2","depends_on_id":"rush-2pv.1","type":"blocks","created_at":"2026-01-20T09:10:32.54342-08:00","created_by":"Asher"}]}
{"id":"rush-2pv.3","title":"US-001: Script Execution","description":"As a developer, I want to execute Rush shell scripts from files so that I can automate tasks and run saved scripts.\n\n## Acceptance Criteria\n- [ ] Can execute .rush files: `rush script.rush`\n- [ ] Shebang support: `#!/usr/bin/env rush`\n- [ ] Script arguments accessible via $1, $2, etc.\n- [ ] Exit codes propagate correctly\n- [ ] Error messages show script name and line number\n- [ ] Scripts can source other scripts\n- [ ] cargo test passes (all tests including new script execution tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n- [ ] Manual testing: run sample scripts with various features\n\n## Technical Notes\n- Modify src/executor/mod.rs to accept file input\n- Add script argument parsing\n- Implement file reading and execution loop\n- Add line number tracking for errors","status":"open","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T09:10:32.65802-08:00","created_by":"Asher","updated_at":"2026-01-20T09:10:32.65802-08:00","labels":["1.0","backend","critical","rush"],"dependencies":[{"issue_id":"rush-2pv.3","depends_on_id":"rush-2pv","type":"parent-child","created_at":"2026-01-20T09:10:32.659146-08:00","created_by":"Asher"}]}
{"id":"rush-2pv.4","title":"US-004: Configuration File Support","description":"As a Rush user, I want a startup config file (~/.rushrc) so that I can customize my environment, aliases, and preferences.\n\n## Acceptance Criteria\n- [ ] Loads ~/.rushrc on startup (if exists)\n- [ ] Supports setting environment variables\n- [ ] Supports defining aliases\n- [ ] Supports defining functions\n- [ ] Supports setting shell options\n- [ ] Errors in config show helpful messages\n- [ ] Can skip config with --no-config flag\n- [ ] cargo test passes (all tests including config tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n- [ ] Manual testing: create ~/.rushrc and verify it loads\n\n## Technical Notes\n- Create config module\n- Parse Rush script syntax from file\n- Execute config before REPL starts\n- Add error handling for bad config\n- Document config file format","status":"open","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T09:10:32.775504-08:00","created_by":"Asher","updated_at":"2026-01-20T09:10:32.775504-08:00","labels":["1.0","feature","rush"],"dependencies":[{"issue_id":"rush-2pv.4","depends_on_id":"rush-2pv","type":"parent-child","created_at":"2026-01-20T09:10:32.776528-08:00","created_by":"Asher"},{"issue_id":"rush-2pv.4","depends_on_id":"rush-2pv.3","type":"blocks","created_at":"2026-01-20T09:10:32.872525-08:00","created_by":"Asher"}]}
{"id":"rush-2pv.5","title":"US-005: Confirmation Prompts for Destructive Operations","description":"As a cautious user, I want confirmation prompts before destructive operations so that I don't accidentally delete important files.\n\n## Acceptance Criteria\n- [ ] rm -rf prompts for confirmation\n- [ ] Shows what will be deleted (file count, size)\n- [ ] y/N prompt with default to No\n- [ ] Can force with --yes flag to skip prompt\n- [ ] Works in scripts (auto-yes or auto-no based on flag)\n- [ ] Integrates with undo system\n- [ ] cargo test passes (all tests including prompt tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n- [ ] Manual testing: verify prompts appear and work correctly\n\n## Technical Notes\n- Add prompt logic to rm builtin\n- Calculate total size before deletion\n- Add --yes and --force flags\n- Make it work non-interactively for scripts","status":"open","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T09:10:32.991811-08:00","created_by":"Asher","updated_at":"2026-01-20T09:10:32.991811-08:00","labels":["1.0","feature","rush","safety"],"dependencies":[{"issue_id":"rush-2pv.5","depends_on_id":"rush-2pv","type":"parent-child","created_at":"2026-01-20T09:10:32.992881-08:00","created_by":"Asher"}]}
{"id":"rush-2pv.6","title":"US-006: Better Error Messages with Suggestions","description":"As a user who makes typos, I want helpful error messages with suggestions so that I can quickly fix my mistakes.\n\n## Acceptance Criteria\n- [ ] \"command not found\" suggests similar commands\n- [ ] Uses fuzzy matching (edit distance)\n- [ ] Suggests from builtins, aliases, and PATH\n- [ ] Shows \"Did you mean: X?\" for close matches\n- [ ] Suggests common flag typos\n- [ ] Works for Git commands and other builtins\n- [ ] cargo test passes (all tests including suggestion tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n- [ ] Manual testing: verify suggestions for common typos\n\n## Technical Notes\n- Implement fuzzy string matching (use strsim or similar)\n- Build suggestion system\n- Integrate into error handling\n- Add tests for common typos","status":"open","priority":3,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T09:10:33.109985-08:00","created_by":"Asher","updated_at":"2026-01-20T09:10:33.109985-08:00","labels":["1.0","feature","rush","ux"],"dependencies":[{"issue_id":"rush-2pv.6","depends_on_id":"rush-2pv","type":"parent-child","created_at":"2026-01-20T09:10:33.110935-08:00","created_by":"Asher"}]}
{"id":"rush-2pv.7","title":"US-008: Command Suggestions (Did You Mean?)","description":"As a user learning Rush, I want command suggestions when I mistype so that I can discover the correct command.\n\n## Acceptance Criteria\n- [ ] Typo detection for commands: \"carg\" → \"cargo\"\n- [ ] Suggests from command history\n- [ ] Suggests based on current context (git repo → git commands)\n- [ ] Configurable threshold for suggestions\n- [ ] Shows multiple suggestions if close match\n- [ ] Works for both builtins and external commands\n- [ ] cargo test passes (all tests including suggestion tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n- [ ] Manual testing: verify context-aware suggestions\n\n## Technical Notes\n- Reuse fuzzy matcher from Story 6 or history module\n- Build command suggestion index\n- Integrate with error handling\n- Add configuration option to disable","status":"open","priority":3,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T09:10:33.221208-08:00","created_by":"Asher","updated_at":"2026-01-20T09:10:33.221208-08:00","labels":["1.0","feature","rush","ux"],"dependencies":[{"issue_id":"rush-2pv.7","depends_on_id":"rush-2pv","type":"parent-child","created_at":"2026-01-20T09:10:33.222458-08:00","created_by":"Asher"}]}
{"id":"rush-2pv.8","title":"US-007: CI/CD and Distribution","description":"As a potential Rush user, I want easy installation via package managers so that I don't have to build from source.\n\n## Acceptance Criteria\n- [ ] GitHub Actions workflow for releases\n- [ ] Pre-built binaries for macOS (Intel + ARM)\n- [ ] Pre-built binaries for Linux (x86_64)\n- [ ] Homebrew formula\n- [ ] Installation instructions in README\n- [ ] Version tags trigger automated builds\n- [ ] Checksums for all binaries\n- [ ] GitHub Actions workflow runs successfully\n- [ ] Test installation on clean macOS machine\n- [ ] Test installation on clean Linux machine\n\n## Technical Notes\n- Create .github/workflows/release.yml\n- Set up cross-compilation\n- Create Homebrew tap\n- Document installation process\n- Test on clean machines","status":"open","priority":4,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T09:10:33.341861-08:00","created_by":"Asher","updated_at":"2026-01-20T09:10:33.341861-08:00","labels":["1.0","distribution","infrastructure","rush"],"dependencies":[{"issue_id":"rush-2pv.8","depends_on_id":"rush-2pv","type":"parent-child","created_at":"2026-01-20T09:10:33.343023-08:00","created_by":"Asher"}]}
{"id":"rush-4et","title":"Add custom themes and prompt configuration","description":"Implement customizable shell appearance: 1) Custom prompt templates, 2) Color themes, 3) Git status in prompt, 4) Dynamic prompt elements, 5) Multi-line prompt support, 6) Vi/Emacs mode indicators","status":"open","priority":3,"issue_type":"feature","owner":"a@kf.cafe","created_at":"2026-01-20T03:03:36.298633-08:00","created_by":"Asher","updated_at":"2026-01-20T03:03:36.298633-08:00","labels":["enhancement","phase5","ux"]}
{"id":"rush-5z6","title":"Improve pipeline support for complex multi-stage pipelines","description":"Current pipeline implementation is basic. Need to support: 1) Multi-stage pipelines (cmd1 | cmd2 | cmd3), 2) Pipeline error handling, 3) PIPESTATUS equivalent, 4) Process substitution, 5) Proper file descriptor handling","status":"open","priority":2,"issue_type":"feature","owner":"a@kf.cafe","created_at":"2026-01-20T03:03:03.335862-08:00","created_by":"Asher","updated_at":"2026-01-20T03:03:03.335862-08:00","labels":["enhancement","phase4"]}
{"id":"rush-7sz","title":"Implement plugin system for extensibility","description":"Design and implement a plugin system that allows: 1) Loading external Rust plugins, 2) Custom builtin commands, 3) Hook system for events, 4) Safe plugin sandboxing, 5) Plugin dependency management, 6) Plugin configuration","status":"open","priority":3,"issue_type":"feature","owner":"a@kf.cafe","created_at":"2026-01-20T03:03:22.475413-08:00","created_by":"Asher","updated_at":"2026-01-20T03:03:22.475413-08:00","labels":["architecture","enhancement","phase5"]}
{"id":"rush-ai","title":"AI Agent Batteries Included","description":"Transform Rush into the ideal shell for AI coding agents by providing structured, parseable output and native data handling.\n\n## Motivation\nAI coding agents (like Claude Code) make hundreds of shell calls per task. They currently suffer from:\n- Parsing unstructured text output (fragile, slow)\n- Spawning jq/external tools for JSON (overhead)\n- Insufficient error context (can't respond intelligently)\n- Performance bottlenecks at scale\n\n## Target Users\nPrimarily: AI coding assistants (Claude Code, Cursor, Copilot Workspace, etc.)\nSecondarily: Human developers who want structured data\n\n## Success Criteria\n- All git commands return structured JSON (--json flag)\n- Native JSON parsing and querying (no jq needed)\n- All file operations support --json output\n- HTTP fetch builtin for API/docs access\n- Structured error responses with error types\n- 10x faster than bash+jq for common agent workflows\n- Documentation with AI agent examples\n\n## Design Principles\n1. **Dual-mode**: Human-friendly by default, `--json` for structured output\n2. **Performance**: Native Rust, no subprocess overhead\n3. **Reliability**: Typed data, predictable output format\n4. **Composition**: Structured data flows through pipes\n5. **Error clarity**: Machine-readable error types\n\n## Competitive Advantage\nWhat makes Rush better than bash+jq for AI agents:\n- **Speed**: 10-100x faster (no process spawning)\n- **Integration**: Commands share state, optimize together\n- **Reliability**: Type-safe, no string parsing bugs\n- **Simplicity**: One tool, not a pipeline of tools","status":"closed","priority":1,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude","updated_at":"2026-01-24T14:12:21.428293-08:00","closed_at":"2026-01-24T14:12:21.428293-08:00","close_reason":"Closed","labels":["ai-agents","batteries-included","epic","json","phase5"]}
{"id":"rush-ai.1","title":"AI-001: Structured git log with JSON output","description":"As an AI coding agent, I need git log to return structured JSON so I can analyze commit history programmatically without fragile parsing.\n\n## Priority: P0 - CRITICAL\nGit log is queried constantly by AI agents to understand code evolution, find relevant commits, and generate changelogs.\n\n## Acceptance Criteria\n- [ ] `git_log` builtin command implemented\n- [ ] Human-readable output by default (like git log --oneline)\n- [ ] `git_log --json` returns structured JSON array\n- [ ] JSON includes: hash, author, date, message, files_changed\n- [ ] `git_log --json -n N` limits to N commits\n- [ ] `git_log --json --since=\"1 week ago\"` date filtering\n- [ ] `git_log --json path/to/file` file-specific history\n- [ ] `git_log --json --grep=\"pattern\"` search messages\n- [ ] Performance: \u003c5ms for 100 commits on large repos\n- [ ] Error handling: clear messages for non-git repos\n- [ ] cargo test passes with integration tests\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# AI agent: Get recent commits for context\ngit_log --json -n 10\n# Returns:\n# [\n#   {\n#     \"hash\": \"a1b2c3d\",\n#     \"short_hash\": \"a1b2c3d\",\n#     \"author\": \"Alice \u003calice@example.com\u003e\",\n#     \"date\": \"2026-01-24T12:00:00Z\",\n#     \"timestamp\": 1706097600,\n#     \"message\": \"Add user authentication\",\n#     \"files_changed\": 5,\n#     \"insertions\": 123,\n#     \"deletions\": 45\n#   },\n#   ...\n# ]\n\n# AI agent: Find commits related to auth\ngit_log --json --grep=\"auth\" -n 20\n\n# AI agent: Get file history\ngit_log --json src/auth.rs\n\n# Human: Quick overview\ngit_log -n 10\n# a1b2c3d Add user authentication\n# b2c3d4e Fix login bug\n# ...\n```\n\n## Technical Implementation\n1. **Create src/builtins/git_log.rs**\n   - Leverage existing GitContext from git_status.rs\n   - Use git2-rs crate (already in dependencies)\n   - Parse flags: --json, -n, --since, --grep, paths\n\n2. **Data Structure**\n   ```rust\n   #[derive(Serialize)]\n   struct Commit {\n       hash: String,\n       short_hash: String,\n       author: String,\n       author_email: String,\n       date: String,  // ISO 8601\n       timestamp: i64,\n       message: String,\n       files_changed: usize,\n       insertions: usize,\n       deletions: usize,\n   }\n   ```\n\n3. **Output Modes**\n   - Default: `{short_hash} {message_first_line}`\n   - `--json`: JSON array of Commit objects\n   - Pipe to jq-compatible format\n\n4. **Performance Optimization**\n   - Lazy loading (don't compute stats unless needed)\n   - Limit default to 100 commits\n   - Cache git2 repo handle in GitContext\n\n5. **Error Handling**\n   - Not a git repo: clear error message\n   - Invalid refs: helpful suggestion\n   - Permission errors: actionable message\n\n## Testing Strategy\n- Unit tests: parsing, formatting, edge cases\n- Integration tests:\n  - git_log in actual repo\n  - --json output validation\n  - Filter flags work correctly\n  - Performance benchmark (\u003c5ms for 100 commits)\n- Error cases: non-git repo, invalid flags\n\n## Documentation\n- Add to README.md examples\n- Create docs/AI_AGENT_GIT.md with:\n  - All git_log use cases for AI agents\n  - JSON schema reference\n  - Performance characteristics\n  - Comparison with git log + parsing\n\n## Dependencies\n- git2-rs crate (already in Cargo.toml)\n- serde_json for JSON serialization\n- Extends GitContext from src/git.rs\n\n## Estimated Effort\n40-50k tokens:\n- Implementation: 20k\n- Tests: 15k\n- Documentation: 10k\n- Debugging/refinement: 5k","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude","updated_at":"2026-01-24T14:12:10.077141-08:00","closed_at":"2026-01-24T14:12:10.077141-08:00","close_reason":"Closed","labels":["ai-agents","builtin","critical","git","json","p0"],"dependencies":[{"issue_id":"rush-ai.1","depends_on_id":"rush-ai","type":"parent-child","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"}]}
{"id":"rush-ai.10","title":"AI-010: Documentation and examples for AI agent integration","description":"As an AI coding agent developer, I need comprehensive documentation and examples so I can integrate Rush into my agent effectively.\n\n## Priority: P2 - MEDIUM\nEven the best features are useless if AI agents don't know how to use them. Documentation is critical for adoption.\n\n## Acceptance Criteria\n- [ ] Create docs/AI_AGENT_GUIDE.md with complete integration guide\n- [ ] Create docs/AI_AGENT_JSON_REFERENCE.md with all JSON schemas\n- [ ] Add examples/ directory with real-world agent workflows\n- [ ] Update README.md with AI agent section\n- [ ] Create migration guide from bash+jq to Rush\n- [ ] Add inline help for all --json flags\n- [ ] Create video/GIF demos for README\n- [ ] All code examples tested and working\n\n## Documentation Structure\n\n### 1. docs/AI_AGENT_GUIDE.md\n```markdown\n# Rush for AI Coding Agents\n\nComprehensive guide for integrating Rush into AI coding assistants.\n\n## Table of Contents\n1. Why Rush for AI Agents?\n2. Quick Start\n3. Structured Git Operations\n4. JSON Native Operations\n5. File Operations with JSON\n6. HTTP Client\n7. Error Handling\n8. Performance Optimization\n9. Best Practices\n10. Migration from Bash\n\n## Why Rush?\n- **10x faster**: Native Rust, no subprocess overhead\n- **Structured output**: JSON by default, no parsing\n- **Typed errors**: Machine-readable error types\n- **Reliability**: Type-safe, predictable behavior\n- **All-in-one**: Git, JSON, HTTP, file ops built-in\n\n## Quick Start\n### Installation\n```bash\ncargo install rush-shell\n```\n\n### First Steps\n```bash\n# Enable JSON errors for better error handling\nexport RUSH_ERROR_FORMAT=json\n\n# Get repository status\nrush -c \"git_status --json\"\n\n# Find and process files\nrush -c \"find --json src/ -name '*.rs' | json_get '.[].path'\"\n```\n\n## [Continue with detailed sections...]\n```\n\n### 2. docs/AI_AGENT_JSON_REFERENCE.md\n```markdown\n# JSON Schema Reference\n\nComplete reference for all JSON output formats.\n\n## git_status --json\n\n### Schema\n```json\n{\n  \"branch\": \"string | null\",\n  \"tracking\": \"string | null\",\n  \"ahead\": \"number\",\n  \"behind\": \"number\",\n  \"state\": \"clean | merge | rebase | cherry-pick\",\n  \"staged\": [\n    {\n      \"path\": \"string\",\n      \"status\": \"modified | added | deleted | renamed\"\n    }\n  ],\n  // ... etc\n}\n```\n\n### Example\n[Include real example]\n\n### Fields\n- `branch`: Current branch name, null if detached HEAD\n- `tracking`: Remote tracking branch, null if none\n- `ahead`: Number of commits ahead of tracking\n- ...\n\n## [Continue for all commands...]\n```\n\n### 3. examples/\n\nCreate real-world example workflows:\n\n**examples/commit_message_generator.rush**\n```bash\n#!/usr/bin/env rush\n# Generate intelligent commit messages from git diff\n\nset -e\nexport RUSH_ERROR_FORMAT=json\n\n# Get staged changes\ndiff=$(git_diff --json --staged)\n\nif [ \"$(echo \"$diff\" | json_get '.summary.files_changed')\" = \"0\" ]; then\n  echo \"No staged changes\"\n  exit 1\nfi\n\n# Extract file changes\nfiles=$(echo \"$diff\" | json_get '.files[].path' | head -5)\ninsertions=$(echo \"$diff\" | json_get '.summary.insertions')\ndeletions=$(echo \"$diff\" | json_get '.summary.deletions')\n\n# Generate message\necho \"Update $files\"\necho \"\"\necho \"Changed files: $(echo \"$diff\" | json_get '.summary.files_changed')\"\necho \"+$insertions -$deletions lines\"\n```\n\n**examples/find_todos.rush**\n```bash\n#!/usr/bin/env rush\n# Find all TODO comments in codebase with context\n\ngrep --json \"TODO\" src/**/*.rs | \\\n  json_query '.[] | {file, line: .line_number, todo: .match}' | \\\n  json_get '.[] | \"\\(.file):\\(.line) - \\(.todo)\"'\n```\n\n**examples/dependency_check.rush**\n```bash\n#!/usr/bin/env rush\n# Check if dependencies are up to date\n\nset -e\n\n# Fetch latest crate info\nfor crate in $(json_get '.dependencies | keys[]' Cargo.toml); do\n  latest=$(fetch --json \"https://crates.io/api/v1/crates/$crate\" | \\\n           json_get '.crate.max_version')\n  current=$(json_get \".dependencies.$crate\" Cargo.toml)\n  \n  if [ \"$current\" != \"$latest\" ]; then\n    echo \"$crate: $current -\u003e $latest\"\n  fi\ndone\n```\n\n**examples/code_review_prep.rush**\n```bash\n#!/usr/bin/env rush\n# Prepare code review summary\n\nset -e\n\n# Get commit range\nbase_branch=\"origin/main\"\ncurrent_branch=$(git_status --json | json_get '.branch')\n\necho \"# Code Review: $current_branch\"\necho \"\"\n\n# Commit summary\necho \"## Commits\"\ngit_log --json \"$base_branch..$current_branch\" | \\\n  json_get '.[].message' | \\\n  while read -r msg; do\n    echo \"- $msg\"\n  done\n\necho \"\"\necho \"## Files Changed\"\ngit_diff --json \"$base_branch..HEAD\" --stat | \\\n  json_get '.files[] | \"\\(.path): +\\(.additions) -\\(.deletions)\"'\n\necho \"\"\necho \"## TODOs Added\"\ngit_diff --json \"$base_branch..HEAD\" | \\\n  json_query '.files[].hunks[].changes[] | select(.type == \"add\" and .line | contains(\"TODO\"))'\n```\n\n### 4. README.md Updates\n\nAdd prominent section:\n```markdown\n## For AI Coding Agents\n\nRush is designed for AI agents that make hundreds of shell calls per task.\n\n### Why Rush?\n- **10x faster** than bash+jq for typical agent workflows\n- **Structured output**: All commands support `--json` flag\n- **Typed errors**: Machine-readable error types for intelligent error handling\n- **All-in-one**: Git, JSON, HTTP, file operations built-in\n\n### Quick Example\n```bash\n# Get repository status and analyze changes\nrush -c \"git_status --json | json_get '.unstaged[] | select(.status == \\\"modified\\\")'\"\n\n# Find all TODO comments with context\nrush -c \"grep --json 'TODO' src/**/*.rs | json_query '.[] | {file, line, text}'\"\n\n# Fetch API data and extract fields\nrush -c \"fetch --json https://api.github.com/repos/rust-lang/rust | json_get '.stargazers_count'\"\n```\n\n### Documentation\n- [AI Agent Integration Guide](docs/AI_AGENT_GUIDE.md)\n- [JSON Schema Reference](docs/AI_AGENT_JSON_REFERENCE.md)\n- [Example Workflows](examples/)\n- [Performance Benchmarks](docs/PERFORMANCE.md)\n\n### Benchmarks\n| Operation | Rush | Bash+jq | Speedup |\n|-----------|------|---------|----------|\n| git_status 100x | 500ms | 2000ms | 4x |\n| find + filter | 10ms | 100ms | 10x |\n| git_log + parse | 50ms | 200ms | 4x |\n| Complex pipeline | 100ms | 500ms | 5x |\n```\n\n### 5. Video/GIF Demos\n\nCreate demos showing:\n1. Rush vs bash speed comparison (side-by-side)\n2. JSON output and querying\n3. Error handling with typed errors\n4. Complex workflow example\n\nUse asciinema or similar for terminal recordings.\n\n## Testing Strategy\n- All code examples must be tested\n- Create tests/docs_examples.rs that runs all examples\n- Ensure examples work with current Rush version\n- Update examples when APIs change\n\n## Deliverables\n1. **AI_AGENT_GUIDE.md** - Complete integration guide\n2. **AI_AGENT_JSON_REFERENCE.md** - All JSON schemas\n3. **examples/** - 10+ working examples\n4. **README.md** - Updated with AI agent section\n5. **Migration guide** - Bash to Rush conversion\n6. **Video demos** - 3-5 demo recordings\n7. **Inline help** - All commands have --help with JSON info\n\n## Dependencies\n- No new dependencies\n- asciinema or vhs for terminal recordings\n\n## Estimated Effort\n45-55k tokens:\n- AI_AGENT_GUIDE.md: 15k\n- AI_AGENT_JSON_REFERENCE.md: 10k\n- Examples: 10k\n- README updates: 5k\n- Migration guide: 8k\n- Video demos: 7k","status":"closed","priority":3,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude","updated_at":"2026-01-24T14:12:17.35723-08:00","closed_at":"2026-01-24T14:12:17.35723-08:00","close_reason":"Closed","labels":["ai-agents","documentation","examples","p2"],"dependencies":[{"issue_id":"rush-ai.10","depends_on_id":"rush-ai","type":"parent-child","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"},{"issue_id":"rush-ai.10","depends_on_id":"rush-ai.1","type":"depends-on","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"},{"issue_id":"rush-ai.10","depends_on_id":"rush-ai.2","type":"depends-on","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"},{"issue_id":"rush-ai.10","depends_on_id":"rush-ai.3","type":"depends-on","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"},{"issue_id":"rush-ai.10","depends_on_id":"rush-ai.4","type":"depends-on","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"},{"issue_id":"rush-ai.10","depends_on_id":"rush-ai.5","type":"depends-on","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"},{"issue_id":"rush-ai.10","depends_on_id":"rush-ai.6","type":"depends-on","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"},{"issue_id":"rush-ai.10","depends_on_id":"rush-ai.7","type":"depends-on","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"},{"issue_id":"rush-ai.10","depends_on_id":"rush-ai.8","type":"depends-on","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"}]}
{"id":"rush-ai.2","title":"AI-002: Structured git diff with JSON output","description":"As an AI coding agent, I need git diff to return structured JSON so I can analyze code changes programmatically and generate smart commit messages.\n\n## Priority: P0 - CRITICAL\nGit diff is the #1 most-called git command by AI agents - used for commit message generation, code review, change analysis.\n\n## Acceptance Criteria\n- [ ] `git_diff` builtin command implemented\n- [ ] Human-readable unified diff by default\n- [ ] `git_diff --json` returns structured JSON\n- [ ] JSON includes: files, hunks, line changes, stats\n- [ ] `git_diff --json --staged` for staged changes\n- [ ] `git_diff --json HEAD~1..HEAD` commit ranges\n- [ ] `git_diff --json --stat` summary statistics only\n- [ ] `git_diff --json file.txt` specific file diff\n- [ ] Performance: \u003c10ms for typical diffs (\u003c1000 lines)\n- [ ] Handles binary files gracefully\n- [ ] cargo test passes with integration tests\n- [ ] cargo build --release succeeds  \n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# AI agent: Analyze unstaged changes for commit message\ngit_diff --json\n# Returns:\n# {\n#   \"files\": [\n#     {\n#       \"path\": \"src/auth.rs\",\n#       \"status\": \"modified\",\n#       \"additions\": 15,\n#       \"deletions\": 3,\n#       \"hunks\": [\n#         {\n#           \"old_start\": 42,\n#           \"old_lines\": 5,\n#           \"new_start\": 42,\n#           \"new_lines\": 10,\n#           \"header\": \"@@ -42,5 +42,10 @@ impl Auth {\",\n#           \"changes\": [\n#             {\"type\": \"context\", \"line\": \"fn login() {\"},\n#             {\"type\": \"delete\", \"line\": \"    // TODO: implement\"},\n#             {\"type\": \"add\", \"line\": \"    let token = generate_token();\"},\n#             {\"type\": \"add\", \"line\": \"    validate_token(token)\"}\n#           ]\n#         }\n#       ]\n#     }\n#   ],\n#   \"summary\": {\n#     \"files_changed\": 1,\n#     \"insertions\": 15,\n#     \"deletions\": 3\n#   }\n# }\n\n# AI agent: Just get summary stats\ngit_diff --json --stat\n# {\"files_changed\": 3, \"insertions\": 45, \"deletions\": 12}\n\n# AI agent: Staged changes for commit message\ngit_diff --json --staged\n\n# Human: normal diff\ngit_diff src/auth.rs\n```\n\n## Technical Implementation\n1. **Create src/builtins/git_diff.rs**\n   - Use git2-rs Diff API\n   - Parse flags: --json, --staged, --stat, paths, ranges\n   - Handle both working tree and staged diffs\n\n2. **Data Structures**\n   ```rust\n   #[derive(Serialize)]\n   struct DiffOutput {\n       files: Vec\u003cFileDiff\u003e,\n       summary: DiffSummary,\n   }\n   \n   #[derive(Serialize)]\n   struct FileDiff {\n       path: String,\n       old_path: Option\u003cString\u003e,  // for renames\n       status: FileStatus,  // modified, added, deleted, renamed\n       additions: usize,\n       deletions: usize,\n       hunks: Vec\u003cHunk\u003e,\n   }\n   \n   #[derive(Serialize)]\n   struct Hunk {\n       old_start: u32,\n       old_lines: u32,\n       new_start: u32,\n       new_lines: u32,\n       header: String,\n       changes: Vec\u003cLineChange\u003e,\n   }\n   \n   #[derive(Serialize)]\n   struct LineChange {\n       change_type: ChangeType,  // context, add, delete\n       line: String,\n   }\n   ```\n\n3. **Output Modes**\n   - Default: Standard unified diff format\n   - `--json`: Full structured output with hunks\n   - `--json --stat`: Summary only (fast)\n   - `--json --name-only`: Just file paths\n\n4. **Performance Optimization**\n   - Lazy hunk parsing (skip if --stat only)\n   - Streaming for large diffs\n   - Limit line context to ±3 lines by default\n\n5. **Edge Cases**\n   - Binary files: include in files array but no hunks\n   - Renames: show old_path and new_path\n   - New files: status=\"added\", no old content\n   - Deleted files: status=\"deleted\", no new content\n\n## Testing Strategy\n- Unit tests: diff parsing, JSON serialization\n- Integration tests:\n  - Simple file modification\n  - Multiple files changed\n  - File rename detection\n  - Binary files\n  - Large diffs (performance)\n  - Staged vs unstaged\n  - Commit ranges\n- Error cases: invalid refs, permission errors\n\n## Documentation\n- Add to docs/AI_AGENT_GIT.md\n- JSON schema reference\n- Common AI agent patterns:\n  - Commit message generation\n  - Code review analysis\n  - Change summarization\n- Performance guide\n\n## Dependencies\n- git2-rs crate\n- serde_json\n- Extends GitContext\n\n## Estimated Effort\n50-60k tokens:\n- Implementation: 25k (more complex than git_log)\n- Tests: 20k (many edge cases)\n- Documentation: 10k\n- Debugging: 5k","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude","updated_at":"2026-01-24T14:12:16.648522-08:00","closed_at":"2026-01-24T14:12:16.648522-08:00","close_reason":"Closed","labels":["ai-agents","builtin","critical","git","json","p0"],"dependencies":[{"issue_id":"rush-ai.2","depends_on_id":"rush-ai","type":"parent-child","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"}]}
{"id":"rush-ai.3","title":"AI-003: Extend git_status with --json and full file listing","description":"As an AI coding agent, I need git_status to return complete file listings and support JSON output so I can understand repository state without parsing text.\n\n## Priority: P0 - CRITICAL\nGit status is called on almost every agent action to understand what files have changed.\n\n## Acceptance Criteria\n- [ ] Extend existing src/builtins/git_status.rs\n- [ ] `git_status --json` returns structured JSON\n- [ ] Include all file categories: staged, unstaged, untracked\n- [ ] Include ahead/behind counts\n- [ ] Include current branch and tracking info\n- [ ] Include merge/rebase state if applicable\n- [ ] `git_status --json --porcelain` machine-readable format\n- [ ] Performance: \u003c5ms on repos with \u003c1000 files\n- [ ] Handle submodules gracefully\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# AI agent: Get full repository state\ngit_status --json\n# Returns:\n# {\n#   \"branch\": \"feature/auth\",\n#   \"tracking\": \"origin/feature/auth\",\n#   \"ahead\": 2,\n#   \"behind\": 0,\n#   \"state\": \"clean\",  // or \"merge\", \"rebase\", \"cherry-pick\"\n#   \"staged\": [\n#     {\"path\": \"src/auth.rs\", \"status\": \"modified\"},\n#     {\"path\": \"tests/auth_test.rs\", \"status\": \"added\"}\n#   ],\n#   \"unstaged\": [\n#     {\"path\": \"src/main.rs\", \"status\": \"modified\"},\n#     {\"path\": \"README.md\", \"status\": \"modified\"}\n#   ],\n#   \"untracked\": [\n#     \"temp.txt\",\n#     \"debug.log\"\n#   ],\n#   \"conflicted\": [],\n#   \"summary\": {\n#     \"staged_count\": 2,\n#     \"unstaged_count\": 2,\n#     \"untracked_count\": 2,\n#     \"conflicted_count\": 0\n#   }\n# }\n\n# AI agent: Quick check if repo is dirty\ngit_status --json --porcelain | jq -r '.summary.unstaged_count'\n\n# Human: normal output (existing behavior)\ngit_status\n```\n\n## Current State Analysis\nLooking at src/builtins/git_status.rs:61-68:\n```rust\nif git_ctx.is_dirty() {\n    output.push_str(\"Changes not staged for commit:\\n\");\n    // TODO: List actual changed files\n} else {\n    output.push_str(\"nothing to commit, working tree clean\\n\");\n}\n```\n\n**This TODO is what we're implementing!**\n\n## Technical Implementation\n1. **Extend GitContext (src/git.rs)**\n   - Add methods:\n     - `staged_files() -\u003e Vec\u003c(PathBuf, Status)\u003e`\n     - `unstaged_files() -\u003e Vec\u003c(PathBuf, Status)\u003e`\n     - `untracked_files() -\u003e Vec\u003cPathBuf\u003e`\n     - `conflicted_files() -\u003e Vec\u003cPathBuf\u003e`\n   - Use git2::Repository::statuses()\n\n2. **Update src/builtins/git_status.rs**\n   - Add --json flag parsing\n   - Implement JSON serialization\n   - Fix the TODO: actually list files in human output\n   - Add file status details\n\n3. **Data Structure**\n   ```rust\n   #[derive(Serialize)]\n   struct GitStatusOutput {\n       branch: Option\u003cString\u003e,\n       tracking: Option\u003cString\u003e,\n       ahead: u32,\n       behind: u32,\n       state: RepoState,  // clean, merge, rebase, etc.\n       staged: Vec\u003cFileStatus\u003e,\n       unstaged: Vec\u003cFileStatus\u003e,\n       untracked: Vec\u003cString\u003e,\n       conflicted: Vec\u003cString\u003e,\n       summary: StatusSummary,\n   }\n   ```\n\n4. **Output Modes**\n   - Default: Enhanced human-readable (list actual files!)\n   - `--json`: Full structured output\n   - `--porcelain`: Git-compatible machine format\n\n5. **Performance**\n   - Cache status results in GitContext\n   - Lazy loading of file lists\n   - Ignore rules respected (.gitignore)\n\n## Testing Strategy\n- Unit tests: status categorization, JSON serialization\n- Integration tests:\n  - Clean repo\n  - Staged files only\n  - Unstaged files only\n  - Mixed state\n  - Untracked files\n  - Merge conflicts\n  - Ahead/behind tracking\n- Performance: benchmark on large repos\n\n## Documentation\n- Update existing git_status docs\n- Add JSON schema\n- Add AI agent examples\n- Document performance characteristics\n\n## Dependencies\n- Extends existing git_status.rs and GitContext\n- git2-rs (already in use)\n- serde_json\n\n## Estimated Effort\n35-45k tokens:\n- GitContext extension: 10k\n- git_status update: 15k\n- Tests: 12k\n- Documentation: 8k","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude","updated_at":"2026-01-24T14:12:16.735956-08:00","closed_at":"2026-01-24T14:12:16.735956-08:00","close_reason":"Closed","labels":["ai-agents","builtin","critical","git","json","p0"],"dependencies":[{"issue_id":"rush-ai.3","depends_on_id":"rush-ai","type":"parent-child","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"}]}
{"id":"rush-ai.4","title":"AI-004: JSON query and manipulation builtins","description":"As an AI coding agent, I need native JSON parsing and querying so I don't have to spawn jq for every JSON operation.\n\n## Priority: P1 - HIGH\nAI agents constantly work with JSON (API responses, config files, structured command output). Spawning jq adds 10-50ms overhead per call.\n\n## Acceptance Criteria\n- [ ] `json_get` builtin: extract values from JSON\n- [ ] `json_set` builtin: modify JSON values\n- [ ] `json_query` builtin: JSONPath or jq-like queries\n- [ ] Pipe support: `cat file.json | json_get '.user.name'`\n- [ ] File support: `json_get '.data' file.json`\n- [ ] Array indexing: `json_get '.[0].name'`\n- [ ] Multiple queries: `json_get '.name' '.email' '.age'`\n- [ ] Error handling: clear messages for invalid JSON/paths\n- [ ] Performance: \u003c1ms for typical queries (\u003c100KB JSON)\n- [ ] cargo test passes with extensive tests\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# AI agent: Extract value from API response\ncurl -s api.example.com/user | json_get '.name'\n# \"Alice\"\n\n# AI agent: Navigate nested structures\necho '{\"user\":{\"profile\":{\"age\":30}}}' | json_get '.user.profile.age'\n# 30\n\n# AI agent: Array operations\necho '[{\"name\":\"Alice\"},{\"name\":\"Bob\"}]' | json_get '.[].name'\n# Alice\n# Bob\n\n# AI agent: Multiple fields\ngit_status --json | json_get '.branch' '.ahead' '.behind'\n# feature/auth\n# 2\n# 0\n\n# AI agent: Modify JSON\necho '{\"count\":5}' | json_set '.count' 10\n# {\"count\":10}\n\n# AI agent: Query with filter\njson_query '.files[] | select(.status == \"modified\")' changes.json\n```\n\n## Technical Implementation\n1. **Create src/builtins/json.rs**\n   - Three main functions: json_get, json_set, json_query\n   - Use serde_json for parsing\n   - Use serde_json::Value for manipulation\n   - Consider jsonpath_lib or similar for path queries\n\n2. **Query Syntax**\n   Start simple, expand as needed:\n   - `.field` - get field\n   - `.field.nested` - nested access\n   - `.[0]` - array index\n   - `.[]` - array iteration\n   - Later: filters, functions (like jq)\n\n3. **Data Flow**\n   ```rust\n   // Input sources\n   enum JsonSource {\n       Stdin(String),\n       File(PathBuf),\n       Argument(String),\n   }\n   \n   // Parse -\u003e Query -\u003e Output\n   fn json_get(path: \u0026str, source: JsonSource) -\u003e Result\u003cValue\u003e {\n       let json: Value = parse_source(source)?;\n       let result = query_path(\u0026json, path)?;\n       Ok(result)\n   }\n   ```\n\n4. **Output Formats**\n   - Raw value (no quotes for primitives)\n   - JSON (for objects/arrays)\n   - `--raw` flag for unquoted strings\n   - `--compact` vs `--pretty` for objects\n\n5. **Error Handling**\n   - Invalid JSON: show line/column\n   - Invalid path: show where it failed\n   - Type errors: \"expected array, got object\"\n\n## Performance Optimization\n- Lazy parsing (don't parse if not needed)\n- Streaming for large files (consider json-stream)\n- Cache parsed JSON for multiple queries\n- Benchmark vs jq\n\n## Testing Strategy\n- Unit tests:\n  - Path parsing\n  - Query execution\n  - Edge cases (null, empty, nested)\n- Integration tests:\n  - Pipe input\n  - File input\n  - Multiple queries\n  - Error cases\n- Performance tests:\n  - Small JSON (\u003c1KB): \u003c0.1ms\n  - Medium JSON (100KB): \u003c1ms\n  - Large JSON (10MB): \u003c50ms\n- Comparison: Rush vs jq on same queries\n\n## Documentation\n- Create docs/JSON_BUILTINS.md:\n  - All query syntax\n  - Examples for AI agents\n  - Performance guide\n  - Migration from jq\n- Add to README examples\n- Inline help for each builtin\n\n## Future Extensions (not in this bead)\n- `json_merge`: combine multiple JSON files\n- `json_validate`: schema validation\n- `json_format`: pretty-print\n- Full jq compatibility layer\n\n## Dependencies\n- serde_json (already in use)\n- Consider: jsonpath_lib, jq-rs, or implement simple path parser\n\n## Estimated Effort\n50-60k tokens:\n- Implementation (3 builtins): 25k\n- Path query parser: 10k\n- Tests: 15k\n- Documentation: 10k","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude","updated_at":"2026-01-24T14:12:16.824473-08:00","closed_at":"2026-01-24T14:12:16.824473-08:00","close_reason":"Closed","labels":["ai-agents","builtin","json","p1"],"dependencies":[{"issue_id":"rush-ai.4","depends_on_id":"rush-ai","type":"parent-child","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"}]}
{"id":"rush-ai.5","title":"AI-005: Add --json flag to ls builtin","description":"As an AI coding agent, I need ls to output structured JSON so I can process file listings programmatically without parsing text columns.\n\n## Priority: P1 - HIGH\nLs is one of the most-called commands by AI agents. Text parsing is fragile (spaces in filenames, different ls implementations).\n\n## Acceptance Criteria\n- [ ] Extend existing src/builtins/ls.rs\n- [ ] `ls --json` returns JSON array of file objects\n- [ ] Include: name, path, size, modified, type, permissions\n- [ ] `ls --json -l` includes full metadata\n- [ ] `ls --json -R` recursive directory tree\n- [ ] Handle symlinks: include target info\n- [ ] Handle errors gracefully (permission denied, etc.)\n- [ ] Performance: \u003c5ms for \u003c1000 files\n- [ ] Works with all existing ls flags (filter, sort)\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# AI agent: Get file listing with metadata\nls --json src/\n# [\n#   {\n#     \"name\": \"main.rs\",\n#     \"path\": \"src/main.rs\",\n#     \"type\": \"file\",\n#     \"size\": 4523,\n#     \"modified\": \"2026-01-24T12:00:00Z\",\n#     \"permissions\": \"rw-r--r--\",\n#     \"mode\": 420\n#   },\n#   {\n#     \"name\": \"lib.rs\",\n#     \"path\": \"src/lib.rs\",\n#     \"type\": \"file\",\n#     \"size\": 1234,\n#     \"modified\": \"2026-01-23T10:30:00Z\",\n#     \"permissions\": \"rw-r--r--\",\n#     \"mode\": 420\n#   },\n#   {\n#     \"name\": \"builtins\",\n#     \"path\": \"src/builtins\",\n#     \"type\": \"directory\",\n#     \"size\": 4096,\n#     \"modified\": \"2026-01-24T11:00:00Z\",\n#     \"permissions\": \"rwxr-xr-x\",\n#     \"mode\": 493\n#   }\n# ]\n\n# AI agent: Find large files\nls --json -R | json_query '.[] | select(.size \u003e 1000000)'\n\n# AI agent: Get just Rust files with metadata\nls --json src/*.rs\n\n# AI agent: Check if file exists and get size\nls --json file.txt | json_get '.[0].size'\n\n# Human: normal ls (existing behavior)\nls -la\n```\n\n## Current State Analysis\nLooking at existing ls.rs, it already:\n- Handles color output\n- Sorts files\n- Shows hidden files\n- Long format (-l)\n\nWe need to add:\n- JSON output mode\n- Structured metadata\n- Recursive JSON tree\n\n## Technical Implementation\n1. **Extend src/builtins/ls.rs**\n   - Add --json flag parsing\n   - Add OutputFormat enum (Human | Json)\n   - Extract metadata collection into separate function\n   - Implement JSON serialization\n\n2. **Data Structure**\n   ```rust\n   #[derive(Serialize)]\n   struct FileEntry {\n       name: String,\n       path: PathBuf,\n       file_type: FileType,  // file, directory, symlink\n       size: u64,\n       modified: String,  // ISO 8601\n       modified_timestamp: i64,\n       permissions: String,  // \"rw-r--r--\"\n       mode: u32,  // Unix mode bits\n       #[serde(skip_serializing_if = \"Option::is_none\")]\n       symlink_target: Option\u003cPathBuf\u003e,\n       #[serde(skip_serializing_if = \"Option::is_none\")]\n       owner: Option\u003cString\u003e,  // Unix only\n       #[serde(skip_serializing_if = \"Option::is_none\")]\n       group: Option\u003cString\u003e,  // Unix only\n   }\n   \n   #[derive(Serialize)]\n   enum FileType {\n       File,\n       Directory,\n       Symlink,\n       Other,\n   }\n   ```\n\n3. **Output Modes**\n   - Default: Current human-readable format (no changes)\n   - `--json`: JSON array of FileEntry objects\n   - `--json -l`: Include owner/group if available\n   - `--json -R`: Nested structure with children arrays\n\n4. **Recursive Structure**\n   ```rust\n   #[derive(Serialize)]\n   struct DirectoryEntry {\n       name: String,\n       path: PathBuf,\n       // ... other fields ...\n       #[serde(skip_serializing_if = \"Option::is_none\")]\n       children: Option\u003cVec\u003cDirectoryEntry\u003e\u003e,\n   }\n   ```\n\n5. **Error Handling**\n   - Permission denied: include error in entry\n   - Broken symlinks: include in output with target=null\n   - Invalid UTF-8: use lossy conversion\n\n## Performance Optimization\n- Parallel metadata collection for large directories\n- Lazy stat() calls (only when needed)\n- Limit recursive depth to prevent stack overflow\n\n## Testing Strategy\n- Unit tests: metadata extraction, JSON serialization\n- Integration tests:\n  - Simple directory\n  - Recursive listing\n  - Symlinks\n  - Permission errors\n  - Empty directory\n  - Large directory (performance)\n- Cross-platform: Windows vs Unix permissions\n\n## Documentation\n- Update existing ls docs\n- Add JSON schema reference\n- Add AI agent examples\n- Document performance characteristics\n- Create docs/AI_AGENT_FILES.md\n\n## Dependencies\n- Extends existing ls.rs\n- serde_json\n- No new external crates needed\n\n## Estimated Effort\n35-45k tokens:\n- Implementation: 15k\n- Recursive support: 10k\n- Tests: 12k\n- Documentation: 8k","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude","updated_at":"2026-01-24T14:12:16.912858-08:00","closed_at":"2026-01-24T14:12:16.912858-08:00","close_reason":"Closed","labels":["ai-agents","builtin","enhancement","json","p1"],"dependencies":[{"issue_id":"rush-ai.5","depends_on_id":"rush-ai","type":"parent-child","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"},{"issue_id":"rush-ai.5","depends_on_id":"rush-ai.4","type":"depends-on","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"}]}
{"id":"rush-ai.6","title":"AI-006: Add --json flag to find and grep builtins","description":"As an AI coding agent, I need find and grep to output structured JSON so I can process search results programmatically.\n\n## Priority: P1 - HIGH\nFind and grep are core search tools. AI agents use them constantly but have to parse line-oriented output.\n\n## Acceptance Criteria\n- [ ] Extend src/builtins/find.rs: add --json flag\n- [ ] Extend src/builtins/grep.rs: add --json flag\n- [ ] find --json: array of file paths with metadata\n- [ ] grep --json: array of matches with line numbers, context\n- [ ] find --json -type f: filter by type in structured output\n- [ ] grep --json -C 2: include context lines in structure\n- [ ] Performance: no slowdown vs text output\n- [ ] All existing flags work with --json\n- [ ] cargo test passes for both\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n\n### Find with JSON\n```bash\n# AI agent: Find all Rust files with metadata\nfind --json src/ -name \"*.rs\"\n# [\n#   {\n#     \"path\": \"src/main.rs\",\n#     \"type\": \"file\",\n#     \"size\": 4523,\n#     \"modified\": \"2026-01-24T12:00:00Z\"\n#   },\n#   {\n#     \"path\": \"src/lib.rs\",\n#     \"type\": \"file\",\n#     \"size\": 1234,\n#     \"modified\": \"2026-01-23T10:30:00Z\"\n#   }\n# ]\n\n# AI agent: Find files modified today\nfind --json . -mtime -1 | json_query '.[] | .path'\n```\n\n### Grep with JSON\n```bash\n# AI agent: Find all TODO comments with context\ngrep --json \"TODO\" src/**/*.rs\n# [\n#   {\n#     \"file\": \"src/builtins/git_status.rs\",\n#     \"line_number\": 66,\n#     \"match\": \"// TODO: List actual changed files\",\n#     \"context_before\": [\n#       \"if git_ctx.is_dirty() {\",\n#       \"    output.push_str(\\\"Changes not staged for commit:\\\\n\\\");\"\n#     ],\n#     \"context_after\": [\n#       \"} else {\",\n#       \"    output.push_str(\\\"nothing to commit\\\");\"\n#     ]\n#   }\n# ]\n\n# AI agent: Count matches per file\ngrep --json \"fn \" src/*.rs | json_query 'group_by(.file) | map({file: .[0].file, count: length})'\n\n# AI agent: Get just matching lines\ngrep --json \"error\" logfile.txt | json_get '.[].match'\n```\n\n## Technical Implementation\n\n### Find JSON Output\n1. **Extend src/builtins/find.rs**\n   ```rust\n   #[derive(Serialize)]\n   struct FindResult {\n       path: PathBuf,\n       file_type: FileType,\n       size: u64,\n       modified: String,\n       modified_timestamp: i64,\n       #[serde(skip_serializing_if = \"Option::is_none\")]\n       permissions: Option\u003cString\u003e,\n   }\n   ```\n\n2. **Collect results, serialize at end**\n   - Store all FindResult objects\n   - Output JSON array when search completes\n   - Maintain same search logic, different output\n\n### Grep JSON Output\n1. **Extend src/builtins/grep.rs**\n   ```rust\n   #[derive(Serialize)]\n   struct GrepMatch {\n       file: PathBuf,\n       line_number: usize,\n       column: Option\u003cusize\u003e,  // if available\n       match_text: String,\n       full_line: String,\n       #[serde(skip_serializing_if = \"Option::is_none\")]\n       context_before: Option\u003cVec\u003cString\u003e\u003e,\n       #[serde(skip_serializing_if = \"Option::is_none\")]\n       context_after: Option\u003cVec\u003cString\u003e\u003e,\n   }\n   ```\n\n2. **Context Handling**\n   - Parse -A, -B, -C flags\n   - Include context lines in JSON\n   - Track line numbers correctly\n\n## Output Modes\n- Default: Current text output (no changes)\n- `--json`: Array of result objects\n- `--json --count`: Just counts, not full results\n- Compatible with all existing flags\n\n## Performance Considerations\n- JSON serialization shouldn't slow down search\n- Stream results for very large outputs (consider JSONL)\n- Benchmark vs text mode\n\n## Testing Strategy\n- **Find tests:**\n  - Simple file search\n  - Type filtering\n  - Name patterns\n  - Time-based filters\n  - Large directory trees\n- **Grep tests:**\n  - Simple pattern match\n  - Multiple files\n  - Context lines\n  - Line numbers\n  - Binary file handling\n  - Large files\n- Cross-platform: path separators, permissions\n\n## Documentation\n- Update find.rs and grep.rs docs\n- Add to docs/AI_AGENT_FILES.md\n- JSON schema reference for both\n- Performance comparison\n- Migration guide from text parsing\n\n## Dependencies\n- Extends existing find.rs and grep.rs\n- serde_json\n- regex crate (already in use for grep)\n\n## Estimated Effort\n45-55k tokens:\n- Find implementation: 12k\n- Grep implementation: 15k\n- Tests (both): 15k\n- Documentation: 8k\n- Integration: 5k","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude","updated_at":"2026-01-24T14:12:16.999946-08:00","closed_at":"2026-01-24T14:12:16.999946-08:00","close_reason":"Closed","labels":["ai-agents","builtin","enhancement","json","p1"],"dependencies":[{"issue_id":"rush-ai.6","depends_on_id":"rush-ai","type":"parent-child","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"},{"issue_id":"rush-ai.6","depends_on_id":"rush-ai.4","type":"depends-on","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"}]}
{"id":"rush-ai.7","title":"AI-007: HTTP fetch builtin with structured responses","description":"As an AI coding agent, I need a native HTTP client so I can fetch documentation, APIs, and package info without spawning curl.\n\n## Priority: P2 - MEDIUM\nAI agents frequently need to fetch external resources (docs, package registries, APIs). Currently requires curl + JSON parsing.\n\n## Acceptance Criteria\n- [ ] `fetch` builtin command implemented\n- [ ] `fetch URL` performs GET request\n- [ ] `fetch --json URL` returns structured response\n- [ ] `fetch -X POST -d 'data' URL` POST requests\n- [ ] `fetch -H \"Header: value\" URL` custom headers\n- [ ] JSON response body automatically parsed\n- [ ] `fetch --timeout 5 URL` request timeout\n- [ ] Follow redirects by default, `--no-follow` to disable\n- [ ] Error handling: network errors, timeouts, HTTP errors\n- [ ] Performance: comparable to curl\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# AI agent: Fetch API data\nfetch --json https://api.github.com/repos/rust-lang/rust\n# {\n#   \"status\": 200,\n#   \"headers\": {\n#     \"content-type\": \"application/json\",\n#     \"...\": \"...\"\n#   },\n#   \"body\": {\n#     \"name\": \"rust\",\n#     \"description\": \"Empowering everyone...\",\n#     \"stars\": 95000,\n#     ...\n#   },\n#   \"response_time_ms\": 234\n# }\n\n# AI agent: Check if URL is reachable\nfetch --json --method HEAD https://example.com | json_get '.status'\n# 200\n\n# AI agent: POST JSON data\necho '{\"title\":\"test\"}' | fetch --json -X POST -H \"Content-Type: application/json\" -d @- https://api.example.com/posts\n\n# AI agent: Get just response body\nfetch https://api.example.com/data\n# {\"result\": \"success\"}\n\n# AI agent: Download with error handling\nif fetch --timeout 5 https://example.com/large-file -o output.bin; then\n  echo \"Downloaded successfully\"\nelse\n  echo \"Download failed: $?\"\nfi\n```\n\n## Technical Implementation\n1. **Create src/builtins/fetch.rs**\n   - Use reqwest crate (popular, well-maintained)\n   - Parse HTTP-like CLI arguments\n   - Execute request\n   - Format response\n\n2. **Data Structure**\n   ```rust\n   #[derive(Serialize)]\n   struct FetchResponse {\n       status: u16,\n       status_text: String,\n       headers: HashMap\u003cString, String\u003e,\n       body: Value,  // Parsed JSON or string\n       response_time_ms: u64,\n       url: String,  // Final URL after redirects\n   }\n   ```\n\n3. **Request Builder**\n   ```rust\n   struct FetchOptions {\n       method: Method,  // GET, POST, PUT, DELETE, etc.\n       headers: Vec\u003c(String, String)\u003e,\n       body: Option\u003cString\u003e,\n       timeout: Option\u003cDuration\u003e,\n       follow_redirects: bool,\n       output_file: Option\u003cPathBuf\u003e,\n   }\n   ```\n\n4. **Output Modes**\n   - Default: Response body only (like curl)\n   - `--json`: Full structured response\n   - `--headers`: Include headers in text mode\n   - `--verbose`: Full request/response details\n   - `-o file`: Save to file instead of stdout\n\n5. **Error Handling**\n   - Network errors: clear message, non-zero exit\n   - Timeout: specific error, non-zero exit\n   - HTTP errors (4xx, 5xx): include in JSON, exit code reflects status\n   - Invalid URLs: helpful message\n\n## Advanced Features (in scope)\n- Auto-detect JSON responses and parse\n- Support @filename for request body\n- Basic auth: `fetch -u user:pass URL`\n- Custom user agent\n- Progress bar for large downloads (optional)\n\n## NOT in scope (future)\n- Complex auth (OAuth, etc.) - use curl for now\n- Cookies/session management\n- HTTP/2 multiplexing\n- Certificate pinning\n- Proxy support (maybe later)\n\n## Performance Optimization\n- Reuse HTTP client (connection pooling)\n- Async I/O with tokio (reqwest already does this)\n- Streaming for large responses\n- Benchmark vs curl\n\n## Testing Strategy\n- Unit tests: argument parsing, response formatting\n- Integration tests (need test HTTP server):\n  - GET requests\n  - POST with body\n  - Custom headers\n  - Redirects\n  - Timeouts\n  - Error responses\n  - JSON auto-parsing\n- Use httpbin.org for live tests (optional)\n- Mock HTTP server for reliable tests\n\n## Documentation\n- Create docs/HTTP_BUILTIN.md:\n  - All flags and options\n  - Examples for AI agents\n  - Comparison with curl\n  - JSON schema for --json output\n- Add to README\n- Inline help\n\n## Dependencies\n- reqwest = { version = \"0.11\", features = [\"json\", \"blocking\"] }\n  - Consider async vs blocking API\n  - Blocking might be simpler for shell use\n- serde_json (already in use)\n\n## Platform Considerations\n- Use native TLS (OpenSSL on Linux, SChannel on Windows, SecureTransport on macOS)\n- reqwest handles this automatically\n\n## Estimated Effort\n50-60k tokens:\n- Implementation: 20k\n- Request/response handling: 15k\n- Tests: 15k\n- Documentation: 10k","status":"closed","priority":3,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude","updated_at":"2026-01-24T14:12:17.089526-08:00","closed_at":"2026-01-24T14:12:17.089526-08:00","close_reason":"Closed","labels":["ai-agents","builtin","http","json","p2"],"dependencies":[{"issue_id":"rush-ai.7","depends_on_id":"rush-ai","type":"parent-child","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"},{"issue_id":"rush-ai.7","depends_on_id":"rush-ai.4","type":"depends-on","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"}]}
{"id":"rush-ai.8","title":"AI-008: Structured error responses with error types","description":"As an AI coding agent, I need machine-readable error types so I can respond intelligently to failures instead of parsing error messages.\n\n## Priority: P1 - HIGH\nError handling is critical for AI agents. Exit codes alone are insufficient - agents need to know *why* something failed to take appropriate action.\n\n## Acceptance Criteria\n- [ ] Define standard error type taxonomy\n- [ ] All builtins return typed errors\n- [ ] `RUSH_ERROR_FORMAT=json` environment variable\n- [ ] Errors include: type, message, context, exit_code\n- [ ] `--error-json` flag for command-level override\n- [ ] Backwards compatible: default is text errors\n- [ ] Document all error types\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# AI agent: Enable JSON errors\nexport RUSH_ERROR_FORMAT=json\n\n# AI agent: Handle git errors intelligently\ngit_status --json 2\u003e error.json\nif [ $? -ne 0 ]; then\n  error_type=$(json_get '.error.type' error.json)\n  case $error_type in\n    \"not_a_git_repo\")\n      echo \"Initializing git repo...\"\n      git init\n      ;;\n    \"permission_denied\")\n      echo \"Need sudo access\"\n      ;;\n    *)\n      echo \"Unknown error: $error_type\"\n      ;;\n  esac\nfi\n\n# Error format example:\n# {\n#   \"error\": {\n#     \"type\": \"not_a_git_repo\",\n#     \"category\": \"git\",\n#     \"message\": \"fatal: not a git repository\",\n#     \"context\": {\n#       \"cwd\": \"/tmp/foo\",\n#       \"command\": \"git_status\"\n#     },\n#     \"exit_code\": 128,\n#     \"suggestion\": \"Run 'git init' to create a new repository\"\n#   }\n# }\n```\n\n## Error Type Taxonomy\n\n### Git Errors\n- `not_a_git_repo`: Not in a git repository\n- `no_upstream`: Branch has no upstream\n- `merge_conflict`: Merge conflict in progress\n- `detached_head`: In detached HEAD state\n- `git_command_failed`: Generic git error\n\n### File Errors\n- `file_not_found`: File doesn't exist\n- `permission_denied`: Insufficient permissions\n- `is_a_directory`: Expected file, got directory\n- `not_a_directory`: Expected directory, got file\n- `disk_full`: No space left on device\n\n### Network Errors (for fetch)\n- `network_unreachable`: No network connection\n- `dns_failed`: DNS resolution failed\n- `connection_timeout`: Request timed out\n- `connection_refused`: Server refused connection\n- `http_error`: HTTP error (4xx, 5xx)\n\n### Parse Errors\n- `invalid_json`: JSON parsing failed\n- `invalid_syntax`: Command syntax error\n- `invalid_argument`: Invalid argument value\n\n### System Errors\n- `command_not_found`: Command doesn't exist\n- `killed_by_signal`: Process terminated by signal\n- `resource_exhausted`: Out of memory/resources\n\n## Technical Implementation\n1. **Create src/error.rs**\n   ```rust\n   #[derive(Debug, Clone, Serialize)]\n   pub struct RushError {\n       pub error_type: ErrorType,\n       pub category: ErrorCategory,\n       pub message: String,\n       pub context: HashMap\u003cString, Value\u003e,\n       pub exit_code: i32,\n       pub suggestion: Option\u003cString\u003e,\n   }\n   \n   #[derive(Debug, Clone, Serialize)]\n   #[serde(rename_all = \"snake_case\")]\n   pub enum ErrorType {\n       // Git\n       NotAGitRepo,\n       NoUpstream,\n       MergeConflict,\n       // File\n       FileNotFound,\n       PermissionDenied,\n       // Network\n       NetworkUnreachable,\n       ConnectionTimeout,\n       HttpError,\n       // Parse\n       InvalidJson,\n       InvalidSyntax,\n       // System\n       CommandNotFound,\n       // ... etc\n   }\n      \n   #[derive(Debug, Clone, Serialize)]\n   #[serde(rename_all = \"lowercase\")]\n   pub enum ErrorCategory {\n       Git,\n       File,\n       Network,\n       Parse,\n       System,\n   }\n   ```\n\n2. **Update ExecutionResult**\n   ```rust\n   pub struct ExecutionResult {\n       pub stdout: String,\n       pub stderr: String,\n       pub exit_code: i32,\n       pub error: Option\u003cRushError\u003e,  // NEW\n   }\n   \n   impl ExecutionResult {\n       pub fn error_typed(error: RushError) -\u003e Self {\n           let stderr = if should_output_json_errors() {\n               serde_json::to_string(\u0026error).unwrap()\n           } else {\n               error.message.clone()\n           };\n           \n           Self {\n               stdout: String::new(),\n               stderr,\n               exit_code: error.exit_code,\n               error: Some(error),\n           }\n       }\n   }\n   ```\n\n3. **Environment Variable Check**\n   ```rust\n   fn should_output_json_errors() -\u003e bool {\n       std::env::var(\"RUSH_ERROR_FORMAT\")\n           .map(|v| v == \"json\")\n           .unwrap_or(false)\n   }\n   ```\n\n4. **Update All Builtins**\n   - Convert string errors to RushError\n   - Add context (cwd, args, etc.)\n   - Add suggestions where helpful\n   - Example:\n     ```rust\n     // Old:\n     return Ok(ExecutionResult::error(\n         \"fatal: not a git repository\\n\".to_string()\n     ));\n     \n     // New:\n     return Ok(ExecutionResult::error_typed(\n         RushError {\n             error_type: ErrorType::NotAGitRepo,\n             category: ErrorCategory::Git,\n             message: \"fatal: not a git repository\".to_string(),\n             context: hashmap!{\n                 \"cwd\" =\u003e json!(runtime.get_cwd()),\n             },\n             exit_code: 128,\n             suggestion: Some(\"Run 'git init' to create a new repository\".to_string()),\n         }\n     ));\n     ```\n\n## Migration Strategy\n1. Add RushError infrastructure (non-breaking)\n2. Update one builtin as example (git_status)\n3. Update remaining builtins incrementally\n4. Ensure backwards compatibility (text by default)\n\n## Testing Strategy\n- Unit tests: error type serialization\n- Integration tests:\n  - Default text errors (backwards compat)\n  - JSON errors with env var\n  - All error types represented\n  - Context includes expected fields\n- Error catalog test: ensure all documented errors exist\n\n## Documentation\n- Create docs/ERROR_HANDLING.md:\n  - Complete error type reference\n  - Examples for each error\n  - AI agent error handling patterns\n  - Migration guide\n- Update builtin docs with error types\n- JSON schema for error format\n\n## Dependencies\n- serde_json (already in use)\n- No new crates needed\n\n## Estimated Effort\n50-60k tokens:\n- Error infrastructure: 15k\n- Update all builtins: 20k\n- Tests: 15k\n- Documentation: 10k","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude","updated_at":"2026-01-24T14:12:17.178765-08:00","closed_at":"2026-01-24T14:12:17.178765-08:00","close_reason":"Closed","labels":["ai-agents","error-handling","infrastructure","p1"],"dependencies":[{"issue_id":"rush-ai.8","depends_on_id":"rush-ai","type":"parent-child","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"}]}
{"id":"rush-ai.9","title":"AI-009: Performance benchmarking and optimization for AI agent workloads","description":"As a Rush developer, I need to measure and optimize performance for typical AI agent workloads so Rush is 10x faster than bash+jq.\n\n## Priority: P2 - MEDIUM\nPerformance is a key differentiator. We claim to be fast - let's prove it and optimize bottlenecks.\n\n## Acceptance Criteria\n- [ ] Benchmark suite for AI agent workflows\n- [ ] Comparison benchmarks vs bash+jq+curl\n- [ ] Identify and fix performance bottlenecks\n- [ ] Document performance characteristics\n- [ ] Achieve \u003c5ms for git operations on typical repos\n- [ ] Achieve \u003c1ms for JSON queries on typical data\n- [ ] Achieve 10x speedup vs bash for combined workflows\n- [ ] Continuous performance monitoring setup\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n\n## Benchmark Scenarios\n\n### Scenario 1: Git Status Check Loop\n```bash\n# AI agents do this constantly while working\nfor i in {1..100}; do\n  git_status --json \u003e /dev/null\ndone\n# Target: \u003c500ms total (5ms per call)\n# Baseline (bash): ~2000ms (20ms per call)\n```\n\n### Scenario 2: Find + Filter + JSON\n```bash\n# Find all Rust files modified today\nfind --json src/ -name \"*.rs\" -mtime -1 | json_query '.[] | select(.size \u003e 1000)'\n# Target: \u003c10ms for 1000 files\n# Baseline (bash): ~100ms\n```\n\n### Scenario 3: Git Log + Analysis\n```bash\n# Get recent commits and extract authors\ngit_log --json -n 100 | json_get '.[].author' | sort | uniq\n# Target: \u003c50ms\n# Baseline (bash + jq): ~200ms\n```\n\n### Scenario 4: HTTP + JSON Processing\n```bash\n# Fetch API data and extract field\nfetch --json https://api.github.com/repos/rust-lang/rust | json_get '.stargazers_count'\n# Target: Network-bound (no significant overhead)\n# Baseline (curl + jq): Same network time + ~5ms overhead\n```\n\n### Scenario 5: Complex Pipeline\n```bash\n# Realistic AI agent workflow\ngit_status --json | json_get '.unstaged[].path' | \\\n  while read file; do\n    grep --json \"TODO\" \"$file\"\n  done | json_query '.[] | {file, line: .line_number, text: .match}'\n# Target: \u003c100ms for 50 files\n# Baseline (bash): ~500ms\n```\n\n## Technical Implementation\n\n### 1. Benchmark Infrastructure\n```rust\n// benches/ai_agent_workloads.rs\nuse criterion::{black_box, criterion_group, criterion_main, Criterion};\n\nfn bench_git_status_loop(c: \u0026mut Criterion) {\n    c.bench_function(\"git_status_json_100x\", |b| {\n        b.iter(|| {\n            for _ in 0..100 {\n                // Call git_status --json\n                black_box(run_git_status());\n            }\n        });\n    });\n}\n\ncriterion_group!(benches, \n    bench_git_status_loop,\n    bench_find_filter_json,\n    bench_git_log_analysis,\n    // ...\n);\ncriterion_main!(benches);\n```\n\n### 2. Comparison Benchmarks\n```bash\n# benches/compare_bash.sh\n#!/usr/bin/env bash\nset -euo pipefail\n\necho \"Benchmarking Rush vs Bash...\"\n\n# Git status loop\necho \"Git status 100x:\"\ntime for i in {1..100}; do\n  ./target/release/rush -c \"git_status --json\" \u003e /dev/null\ndone\n\ntime for i in {1..100}; do\n  bash -c \"git status --porcelain | jq ...\" \u003e /dev/null\ndone\n\n# More comparisons...\n```\n\n### 3. Profiling Setup\n- Use flamegraph for CPU profiling\n- Use valgrind/heaptrack for memory profiling\n- Use perf for detailed analysis\n- Create profile targets in Cargo.toml\n\n### 4. Optimization Targets\n\n**Git Operations:**\n- Cache git2::Repository handle (don't reopen every call)\n- Lazy load git metadata\n- Parallel file status checking\n- Memoize branch/remote queries\n\n**JSON Operations:**\n- Streaming JSON parser for large files\n- JIT compilation of common queries (future)\n- Avoid unnecessary allocations\n- Use simd-json for parsing (evaluate)\n\n**File Operations:**\n- Parallel directory traversal\n- Memory-mapped file reading for large files\n- Optimize regex compilation (cache)\n\n**General:**\n- Reduce allocations in hot paths\n- Use `Cow\u003cstr\u003e` where appropriate\n- Profile-guided optimization (PGO)\n- Link-time optimization (LTO) already enabled?\n\n## Performance Monitoring\n\n### 1. CI Integration\n- Run benchmarks on every PR\n- Fail if performance regresses \u003e10%\n- Track performance over time\n- Use GitHub Actions + criterion\n\n### 2. Performance Dashboard\n- Generate HTML reports from criterion\n- Publish to GitHub Pages\n- Historical performance graphs\n- Compare across versions\n\n## Testing Strategy\n- Benchmark tests: ensure benchmarks run without errors\n- Regression tests: alert on slowdowns\n- Micro-benchmarks: for specific optimizations\n- Macro-benchmarks: for real-world workflows\n\n## Documentation\n- Create docs/PERFORMANCE.md:\n  - Benchmark results vs bash/zsh\n  - Performance characteristics of each builtin\n  - Optimization techniques used\n  - Tips for AI agents to maximize performance\n- Add to README:\n  - Key benchmark results\n  - \"10x faster\" claims with data\n- Inline comments explaining optimizations\n\n## Deliverables\n1. **Benchmark suite** (benches/ai_agent_workloads.rs)\n2. **Comparison scripts** (benches/compare_bash.sh)\n3. **Performance report** (PERFORMANCE.md)\n4. **Optimization implementations** (various files)\n5. **CI integration** (.github/workflows/bench.yml)\n6. **Performance dashboard** (GitHub Pages)\n\n## Dependencies\n- criterion = \"0.5\" (already in dev-dependencies?)\n- flamegraph (for profiling)\n- No additional runtime dependencies\n\n## Estimated Effort\n40-50k tokens:\n- Benchmark suite: 12k\n- Profiling \u0026 optimization: 15k\n- Comparison benchmarks: 8k\n- CI integration: 5k\n- Documentation: 10k","status":"closed","priority":3,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude","updated_at":"2026-01-24T14:12:17.26796-08:00","closed_at":"2026-01-24T14:12:17.26796-08:00","close_reason":"Closed","labels":["ai-agents","benchmarking","optimization","p2","performance"],"dependencies":[{"issue_id":"rush-ai.9","depends_on_id":"rush-ai","type":"parent-child","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"},{"issue_id":"rush-ai.9","depends_on_id":"rush-ai.1","type":"depends-on","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"},{"issue_id":"rush-ai.9","depends_on_id":"rush-ai.2","type":"depends-on","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"},{"issue_id":"rush-ai.9","depends_on_id":"rush-ai.3","type":"depends-on","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"},{"issue_id":"rush-ai.9","depends_on_id":"rush-ai.4","type":"depends-on","created_at":"2026-01-24T12:00:00-08:00","created_by":"Claude"}]}
{"id":"rush-amq","title":"Fix 60x performance regression with external command output","description":"## Problem\n\nExternal commands that produce significant output are catastrophically slow. `seq 1 100` takes 210ms in rush vs 3.5ms in bash - a 60x slowdown.\n\n## Benchmark Data\n\n| Command | Rush | Bash | Slowdown |\n|---------|------|------|----------|\n| seq 1 100 | 209.92ms | 3.51ms | 60x |\n| ls | 5.29ms | 3.74ms | 1.4x |\n\nNote: `ls` (small output) is only 1.4x slower, but `seq 1 100` (100 lines) is 60x slower. This strongly suggests the issue is in output handling, not command spawning.\n\n## Likely Causes\n\n1. **Inefficient stdout reading** - Reading byte-by-byte instead of buffered\n2. **Excessive allocations** - Reallocating for each line/chunk\n3. **Synchronous I/O** - Blocking on each read instead of buffering\n4. **Pipe handling** - Inefficient pipe buffer management\n\n## Investigation Areas\n\n- `src/executor/mod.rs` - How stdout is captured\n- `src/executor/pipeline.rs` - Pipeline output handling\n- Check for `read_to_string` vs buffered reading\n- Look for per-line allocations or copies\n\n## Reproduction\n\n```bash\ntime ./target/release/rush -c 'seq 1 100 \u003e /dev/null'\n# vs\ntime bash -c 'seq 1 100 \u003e /dev/null'\n```\n\n## Priority\n\nHIGH - This makes rush unusable for any command with significant output.","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-25T10:01:49.30148-08:00","created_by":"Asher","updated_at":"2026-01-25T10:55:17.516004-08:00","closed_at":"2026-01-25T10:55:17.516004-08:00","close_reason":"Fixed 60x performance regression. Removed 200ms blocking sleep before external commands. Now uses direct wait_with_output() for piped mode and non-blocking polling for interactive mode. Rush is now ~2x bash speed instead of 60x slower.","labels":["bug","perf"]}
{"id":"rush-bvw","title":"Rush Shell Stability - Login Shell Ready","description":"Make Rush stable enough to be used as a default login shell on macOS/Linux.\n\n## Success Criteria\n- ✅ All tests pass (including new stability tests)\n- ✅ Can source standard shell configs (~/.profile, ~/.rushrc equivalents)\n- ✅ Can run common system scripts without errors\n- ✅ Handles signals gracefully (no orphaned processes)\n- ✅ Works in both TTY and non-TTY modes\n- ✅ Exit codes propagate correctly\n- ✅ No crashes during normal operation\n- ✅ Can survive and recover from parse errors\n- ✅ Job control works (background jobs don't block)\n- ✅ Used successfully as login shell for 1 week without issues\n\n## Timeline\n3-4 weeks to production-ready:\n- Week 1: Critical blockers (non-TTY, signals, redirection, subshells, exit codes)\n- Week 2: Core features (variable expansion, wildcards, command substitution)\n- Week 3: Job control and polish\n- Week 4: Stability testing and integration tests\n\n## Reference\nSee docs/stability-roadmap.md for complete details.","status":"open","priority":2,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-20T05:01:33.112277-08:00","created_by":"Asher","updated_at":"2026-01-20T05:01:33.112277-08:00","labels":["epic","login-shell","rush","stability"]}
{"id":"rush-bvw.1","title":"STABILITY-001: Non-TTY Mode Support","description":"As a user running rush in non-interactive contexts, I need rush to work without a TTY so that login scripts, pipes, and command substitution work correctly.\n\n## Priority: P0 - BLOCKING\nThis is the single most critical blocker for login shell use.\n\n## Problem\n- Reedline requires TTY and crashes on non-interactive use\n- Breaks: login scripts, `echo \"pwd\" | rush`, `$(rush -c \"cmd\")`\n- Makes rush unusable for automation or as a login shell\n\n## Acceptance Criteria\n- [ ] Detects TTY vs non-TTY mode using atty crate\n- [ ] Interactive mode: Uses reedline for rich line editing\n- [ ] Non-interactive mode: Uses simple stdin reader\n- [ ] `echo \"pwd\" | rush` works\n- [ ] `rush -c \"echo test\"` works (already works)\n- [ ] `rush \u003c script.sh` works\n- [ ] `$(rush -c \"echo nested\")` works (command substitution)\n- [ ] Can be used in cron jobs\n- [ ] cargo test passes (all tests including non-TTY tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Technical Implementation\n```rust\n// In main.rs\nuse atty;\n\nfn run_interactive() -\u003e Result\u003c()\u003e {\n    if atty::is(atty::Stream::Stdin) {\n        run_interactive_with_reedline()\n    } else {\n        run_non_interactive()\n    }\n}\n\nfn run_non_interactive() -\u003e Result\u003c()\u003e {\n    let stdin = std::io::stdin();\n    for line in stdin.lock().lines() {\n        let line = line?;\n        execute_line(\u0026line, \u0026mut executor)?;\n    }\n    Ok(())\n}\n```\n\n## Files to Modify\n- src/main.rs:188 - Split run_interactive() into TTY/non-TTY paths\n- Cargo.toml - Add atty dependency\n\n## Testing\n- Unit tests for non-TTY execution\n- Integration test: echo commands through pipe\n- Integration test: command substitution\n- Integration test: script redirection\n\n## Estimated Effort: 1-2 days","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T05:01:33.322816-08:00","created_by":"Asher","updated_at":"2026-01-20T05:10:30.397009-08:00","closed_at":"2026-01-20T05:10:30.397011-08:00","labels":["critical","non-tty","p0","rush","stability"],"dependencies":[{"issue_id":"rush-bvw.1","depends_on_id":"rush-bvw","type":"parent-child","created_at":"2026-01-20T05:01:33.323876-08:00","created_by":"Asher"}]}
{"id":"rush-bvw.10","title":"STABILITY-010: Error Recovery","description":"As a user, I need rush to recover from errors gracefully so that it doesn't crash and I don't lose my session.\n\n## Priority: P1 - HIGH\nCritical for login shell stability.\n\n## Acceptance Criteria\n- [ ] Parse errors don't crash shell\n- [ ] Execution errors don't crash shell\n- [ ] Returns to prompt after error\n- [ ] Logs errors without exiting\n- [ ] Panic recovery handler (last resort)\n- [ ] State corruption recovery\n- [ ] History saved on crash\n- [ ] cargo test passes (all tests including recovery tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Technical Implementation\n```rust\nfn run_interactive() -\u003e Result\u003c()\u003e {\n    loop {\n        match std::panic::catch_unwind(|| {\n            // Execute line with panic protection\n        }) {\n            Ok(Ok(result)) =\u003e handle_success(result),\n            Ok(Err(e)) =\u003e handle_error(e),\n            Err(panic) =\u003e handle_panic(panic),\n        }\n    }\n}\n```\n\n## Files to Modify\n- src/main.rs - Add panic recovery\n- src/executor/mod.rs - Better error handling\n- src/parser/mod.rs - Graceful parse error handling\n\n## Testing\n- Test parse errors don't crash\n- Test execution errors don't crash\n- Test panic recovery (if possible)\n\n## Estimated Effort: 1 day","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T05:01:35.237979-08:00","created_by":"Asher","updated_at":"2026-01-20T09:18:06.400356-08:00","closed_at":"2026-01-20T09:18:06.40036-08:00","labels":["error-handling","p1","rush","stability"],"dependencies":[{"issue_id":"rush-bvw.10","depends_on_id":"rush-bvw","type":"parent-child","created_at":"2026-01-20T05:01:35.239392-08:00","created_by":"Asher"}]}
{"id":"rush-bvw.11","title":"STABILITY-011: Login Shell Initialization","description":"As a rush user, I need proper login shell initialization so that my environment is set up correctly on login.\n\n## Priority: P2 - MEDIUM\nImportant for login shell use.\n\n## Acceptance Criteria\n- [ ] Sources ~/.rush_profile on login shell\n- [ ] Sources ~/.rushrc on interactive shell\n- [ ] Sets $SHELL environment variable\n- [ ] Sets $TERM if not set\n- [ ] Sets $USER, $HOME correctly\n- [ ] --login flag forces login shell behavior\n- [ ] --no-rc skips config files\n- [ ] cargo test passes (all tests including init tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Technical Implementation\n```rust\nfn run_login_shell() -\u003e Result\u003c()\u003e {\n    // Set environment variables\n    env::set_var(\"SHELL\", env::current_exe()?);\n\n    // Source profile\n    if let Some(profile) = find_profile() {\n        source_file(\u0026profile)?;\n    }\n\n    // Run interactive\n    run_interactive()\n}\n```\n\n## Files to Modify\n- src/main.rs - Add login shell detection and init\n- src/executor/mod.rs - Add source_file function\n\n## Testing\n- Test profile sourcing\n- Test environment variable setup\n- Test --login and --no-rc flags\n\n## Estimated Effort: 1 day","status":"closed","priority":3,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T05:01:35.451248-08:00","created_by":"Asher","updated_at":"2026-01-20T09:44:54.961813-08:00","closed_at":"2026-01-20T09:44:54.961828-08:00","labels":["initialization","p2","rush","stability"],"dependencies":[{"issue_id":"rush-bvw.11","depends_on_id":"rush-bvw","type":"parent-child","created_at":"2026-01-20T05:01:35.455394-08:00","created_by":"Asher"}]}
{"id":"rush-bvw.12","title":"STABILITY-012: Shell Options (set command)","description":"As a shell scripter, I need shell options so that I can control error handling and debugging behavior.\n\n## Priority: P2 - MEDIUM\nImproves script reliability.\n\n## Acceptance Criteria\n- [ ] `set -e` - Exit on error\n- [ ] `set -u` - Error on undefined variables\n- [ ] `set -x` - Print commands before execution\n- [ ] `set -o pipefail` - Pipeline fails if any command fails\n- [ ] `set +e`, `set +u`, etc. to unset options\n- [ ] `set` with no args shows current options\n- [ ] Options affect current shell and subshells\n- [ ] cargo test passes (all tests including set tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Technical Implementation\n```rust\npub struct ShellOptions {\n    errexit: bool,     // -e\n    nounset: bool,     // -u\n    xtrace: bool,      // -x\n    pipefail: bool,    // -o pipefail\n}\n\nimpl Runtime {\n    pub fn set_option(\u0026mut self, option: \u0026str, value: bool) {\n        // Update options\n    }\n}\n```\n\n## Files to Modify\n- src/runtime/mod.rs - Add ShellOptions struct\n- src/builtins/mod.rs - Add set builtin\n- src/executor/mod.rs - Check options during execution\n\n## Testing\n- Test each option individually\n- Test option combinations\n- Test set/unset toggle\n\n## Estimated Effort: 2 days","status":"closed","priority":3,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T05:01:35.674092-08:00","created_by":"Asher","updated_at":"2026-01-20T09:21:21.752553-08:00","closed_at":"2026-01-20T09:21:21.75256-08:00","labels":["p2","rush","shell-options","stability"],"dependencies":[{"issue_id":"rush-bvw.12","depends_on_id":"rush-bvw","type":"parent-child","created_at":"2026-01-20T05:01:35.675123-08:00","created_by":"Asher"}]}
{"id":"rush-bvw.13","title":"STABILITY-013: Integration Tests for Login Shell","description":"As a rush developer, I need comprehensive integration tests so that I can verify rush works correctly as a login shell.\n\n## Priority: P1 - HIGH\nEssential for verification.\n\n## Acceptance Criteria\n- [ ] Non-interactive mode tests (echo | rush)\n- [ ] Script execution tests\n- [ ] Command substitution tests\n- [ ] Signal handling tests\n- [ ] Redirection tests\n- [ ] Pipeline tests\n- [ ] Exit code tests\n- [ ] Job control tests (if implemented)\n- [ ] All integration tests pass\n- [ ] Tests run in CI\n\n## Test Suite\n```bash\n# tests/integration/login_shell_test.sh\n#!/bin/bash\n\n# Test 1: Non-interactive mode\necho \"pwd\" | ./target/release/rush\n\n# Test 2: Script execution\n./target/release/rush tests/fixtures/test_script.sh\n\n# Test 3: Command substitution\n./target/release/rush -c \"echo $(./target/release/rush -c 'echo nested')\"\n\n# Test 4: Signal handling\n./target/release/rush -c \"sleep 100\" \u0026\nkill $!\n\n# Test 5: Exit codes\n./target/release/rush -c \"false\" ; echo $?  # Should be 1\n\n# Test 6: Redirection\n./target/release/rush -c \"echo test \u003e /tmp/rush_test.txt\"\ncat /tmp/rush_test.txt\n```\n\n## Files to Create\n- tests/integration/login_shell_test.sh\n- tests/integration/non_tty_test.sh\n- tests/integration/signal_test.sh\n- tests/fixtures/*.sh (test scripts)\n\n## Testing\n- Run full integration test suite\n- Verify all tests pass\n- Add to CI pipeline\n\n## Estimated Effort: 2 days","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T05:01:35.871429-08:00","created_by":"Asher","updated_at":"2026-01-20T09:45:59.096809-08:00","closed_at":"2026-01-20T09:45:59.096813-08:00","labels":["integration","p1","rush","stability","testing"],"dependencies":[{"issue_id":"rush-bvw.13","depends_on_id":"rush-bvw","type":"parent-child","created_at":"2026-01-20T05:01:35.872491-08:00","created_by":"Asher"}]}
{"id":"rush-bvw.14","title":"STABILITY-014: Real-World Stability Testing (1 Week Trial)","description":"As the rush developer, I need to use rush as my login shell for 1 week so that I can identify and fix real-world issues.\n\n## Priority: P1 - HIGH\nFinal verification step.\n\n## Acceptance Criteria\n- [ ] Set rush as login shell on development machine\n- [ ] Use for all daily work for 1 week\n- [ ] Document all issues encountered\n- [ ] Fix critical issues immediately\n- [ ] Create beads for nice-to-have improvements\n- [ ] No crashes during 1 week trial\n- [ ] No data loss during 1 week trial\n- [ ] Performance acceptable for daily use\n\n## Testing Checklist\n- [ ] Day 1: Basic usage (cd, ls, cat, git)\n- [ ] Day 2: Complex pipelines and scripts\n- [ ] Day 3: Background jobs and job control\n- [ ] Day 4: Heavy I/O operations\n- [ ] Day 5: Integration with other tools (git, cargo, npm)\n- [ ] Day 6: Stress testing (many commands, long sessions)\n- [ ] Day 7: Final verification and documentation\n\n## Rollback Plan\nKeep backup shell configured:\n```bash\necho $SHELL \u003e ~/.backup_shell\n# Emergency: chsh -s /bin/zsh\n```\n\n## Issues to Watch For\n- Crashes or panics\n- Orphaned processes\n- Memory leaks\n- Slow performance\n- Terminal corruption\n- Signal handling issues\n- History corruption\n\n## Estimated Effort: 5 days (1 week of use + fixes)","status":"open","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T05:01:36.076264-08:00","created_by":"Asher","updated_at":"2026-01-20T05:01:36.076264-08:00","labels":["p1","real-world","rush","stability","testing"],"dependencies":[{"issue_id":"rush-bvw.14","depends_on_id":"rush-bvw","type":"parent-child","created_at":"2026-01-20T05:01:36.077179-08:00","created_by":"Asher"}]}
{"id":"rush-bvw.2","title":"STABILITY-002: Signal Handling","description":"As a user, I need rush to handle signals properly so that there are no orphaned processes or corrupted state when I press Ctrl-C.\n\n## Priority: P0 - BLOCKING\nCritical for preventing orphaned processes and data corruption.\n\n## Problem\n- No SIGINT, SIGTERM, SIGHUP handlers\n- Ctrl-C leaves orphaned child processes\n- State corruption possible on unexpected termination\n\n## Acceptance Criteria\n- [ ] SIGINT (Ctrl-C) handler implemented\n- [ ] SIGTERM handler implemented\n- [ ] SIGHUP handler implemented\n- [ ] Child processes cleaned up on signal\n- [ ] Exit with correct signal exit code (130 for SIGINT)\n- [ ] State is saved/cleaned before exit\n- [ ] No orphaned processes after signal\n- [ ] cargo test passes (all tests including signal tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Technical Implementation\n```rust\nuse signal_hook::{consts::{SIGINT, SIGTERM, SIGHUP}, iterator::Signals};\n\nfn setup_signal_handlers() -\u003e Result\u003c()\u003e {\n    let mut signals = Signals::new(\u0026[SIGINT, SIGTERM, SIGHUP])?;\n\n    thread::spawn(move || {\n        for sig in signals.forever() {\n            match sig {\n                SIGINT =\u003e handle_sigint(),\n                SIGTERM =\u003e handle_sigterm(),\n                SIGHUP =\u003e handle_sighup(),\n                _ =\u003e {}\n            }\n        }\n    });\n\n    Ok(())\n}\n```\n\n## Files to Modify\n- src/main.rs - Register signal handlers on startup\n- src/executor/mod.rs - Add signal handling to executor\n- Cargo.toml - Add signal_hook dependency\n\n## Testing\n- Test Ctrl-C during long-running command\n- Test killing rush process during pipeline\n- Test no orphaned processes after signal\n- Test state cleanup on signal\n\n## Estimated Effort: 1 day","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T05:01:33.520776-08:00","created_by":"Asher","updated_at":"2026-01-20T05:20:16.115944-08:00","closed_at":"2026-01-20T05:20:16.115946-08:00","labels":["critical","p0","rush","signals","stability"],"dependencies":[{"issue_id":"rush-bvw.2","depends_on_id":"rush-bvw","type":"parent-child","created_at":"2026-01-20T05:01:33.52309-08:00","created_by":"Asher"}]}
{"id":"rush-bvw.3","title":"STABILITY-003: File Redirection Support","description":"As a shell user, I need standard Unix redirections so that I can redirect output to files and chain commands properly.\n\n## Priority: P0 - BLOCKING\nEssential for basic shell scripting.\n\n## Problem\n- No `\u003e`, `\u003e\u003e`, `\u003c`, `2\u003e`, `2\u003e\u00261`, `\u0026\u003e` support\n- Cannot save command output to files\n- Cannot redirect error streams\n\n## Acceptance Criteria\n- [ ] `\u003e` stdout redirect: `echo \"test\" \u003e file.txt`\n- [ ] `\u003e\u003e` append redirect: `echo \"more\" \u003e\u003e file.txt`\n- [ ] `\u003c` stdin redirect: `command \u003c input.txt`\n- [ ] `2\u003e` stderr redirect: `command 2\u003e errors.log`\n- [ ] `2\u003e\u00261` stderr to stdout: `command 2\u003e\u00261 | grep error`\n- [ ] `\u0026\u003e` both to file: `command \u0026\u003e output.log`\n- [ ] Works with pipes: `cmd | grep foo \u003e results.txt`\n- [ ] File permissions handled correctly\n- [ ] Handles missing parent directories gracefully\n- [ ] cargo test passes (all tests including redirection tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Technical Implementation\n```rust\n// In parser/ast.rs\npub enum Redirect {\n    Stdout(PathBuf),       // \u003e\n    StdoutAppend(PathBuf), // \u003e\u003e\n    Stdin(PathBuf),        // \u003c\n    Stderr(PathBuf),       // 2\u003e\n    StderrToStdout,        // 2\u003e\u00261\n    Both(PathBuf),         // \u0026\u003e\n}\n\npub struct Command {\n    // ... existing fields\n    pub redirects: Vec\u003cRedirect\u003e,\n}\n```\n\n## Files to Modify\n- src/parser/ast.rs - Add Redirect enum to AST\n- src/lexer/mod.rs - Tokenize redirect operators\n- src/parser/mod.rs - Parse redirections\n- src/executor/mod.rs - Set up file descriptors before exec\n\n## Testing\n- Test all redirect operators individually\n- Test redirect with pipes\n- Test redirect with builtins\n- Test redirect file permissions\n- Test redirect error handling (read-only filesystem, etc.)\n\n## Estimated Effort: 2 days","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T05:01:33.733795-08:00","created_by":"Asher","updated_at":"2026-01-20T05:25:20.553727-08:00","closed_at":"2026-01-20T05:25:20.553731-08:00","labels":["critical","p0","redirection","rush","stability"],"dependencies":[{"issue_id":"rush-bvw.3","depends_on_id":"rush-bvw","type":"parent-child","created_at":"2026-01-20T05:01:33.736126-08:00","created_by":"Asher"}]}
{"id":"rush-bvw.4","title":"STABILITY-004: Subshell Support","description":"As a shell scripter, I need subshells `( )` so that I can isolate environment changes and run commands in isolated contexts.\n\n## Priority: P0 - BLOCKING\nMany scripts rely on subshells for environment isolation.\n\n## Problem\n- No support for `( )` subshells\n- Cannot isolate environment changes\n- Scripts using subshells fail\n\n## Acceptance Criteria\n- [ ] Parse `( )` syntax correctly\n- [ ] Subshell gets isolated runtime/environment\n- [ ] Variables set in subshell don't affect parent\n- [ ] `cd` in subshell doesn't affect parent\n- [ ] Subshell exit code propagates correctly\n- [ ] Works with pipes: `(cd /tmp \u0026\u0026 ls) | grep foo`\n- [ ] Nested subshells work: `((echo nested))`\n- [ ] cargo test passes (all tests including subshell tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Technical Implementation\n```rust\n// In parser/ast.rs\npub enum Statement {\n    // ... existing variants\n    Subshell(Vec\u003cStatement\u003e),\n}\n\n// In executor/mod.rs\nStatement::Subshell(statements) =\u003e {\n    let mut child_runtime = self.runtime.clone();\n    let mut child_executor = Executor::with_runtime(child_runtime);\n    child_executor.execute(statements)\n}\n```\n\n## Files to Modify\n- src/parser/ast.rs - Add Subshell variant\n- src/lexer/mod.rs - Tokenize `(` and `)`\n- src/parser/mod.rs - Parse subshell blocks\n- src/executor/mod.rs - Execute with cloned runtime\n- src/runtime/mod.rs - Ensure runtime is Clone\n\n## Testing\n- Test variable isolation\n- Test directory isolation (cd)\n- Test exit code propagation\n- Test nested subshells\n- Test subshells in pipes\n\n## Estimated Effort: 1-2 days","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T05:01:33.945208-08:00","created_by":"Asher","updated_at":"2026-01-20T05:21:32.64762-08:00","closed_at":"2026-01-20T05:21:32.647709-08:00","labels":["critical","p0","rush","stability","subshells"],"dependencies":[{"issue_id":"rush-bvw.4","depends_on_id":"rush-bvw","type":"parent-child","created_at":"2026-01-20T05:01:33.947387-08:00","created_by":"Asher"}]}
{"id":"rush-bvw.5","title":"STABILITY-005: Exit Code Propagation","description":"As a shell scripter, I need proper exit code handling so that error detection and conditional execution work correctly.\n\n## Priority: P0 - BLOCKING\nEssential for error handling in scripts.\n\n## Problem\n- Exit codes not properly propagated through pipelines\n- No $? variable support\n- Scripts using `set -e` or `||` fail\n\n## Acceptance Criteria\n- [ ] $? variable contains last exit code\n- [ ] Pipeline exit code is last command (default)\n- [ ] Pipeline exit code is first failure (with set -o pipefail)\n- [ ] `command \u0026\u0026 next` only runs if success\n- [ ] `command || fallback` only runs if failure\n- [ ] Exit codes work with builtins\n- [ ] Exit codes work with external commands\n- [ ] cargo test passes (all tests including exit code tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Technical Implementation\n```rust\n// In runtime/mod.rs\npub fn set_last_exit_code(\u0026mut self, code: i32) {\n    self.set_variable(\"?\".to_string(), code.to_string());\n}\n\npub fn get_last_exit_code(\u0026self) -\u003e i32 {\n    self.get_variable(\"?\")\n        .and_then(|s| s.parse().ok())\n        .unwrap_or(0)\n}\n```\n\n## Files to Modify\n- src/runtime/mod.rs - Add $? special variable\n- src/executor/pipeline.rs - Track exit codes through pipeline\n- src/executor/mod.rs - Update last exit code after each command\n- src/parser/mod.rs - Parse \u0026\u0026 and || operators\n\n## Testing\n- Test $? variable after success and failure\n- Test pipeline exit codes\n- Test \u0026\u0026 conditional execution\n- Test || conditional execution\n- Test mixed conditions\n\n## Estimated Effort: 1 day","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T05:01:34.168774-08:00","created_by":"Asher","updated_at":"2026-01-20T05:21:40.592702-08:00","closed_at":"2026-01-20T05:21:40.592708-08:00","labels":["critical","exit-codes","p0","rush","stability"],"dependencies":[{"issue_id":"rush-bvw.5","depends_on_id":"rush-bvw","type":"parent-child","created_at":"2026-01-20T05:01:34.170752-08:00","created_by":"Asher"}]}
{"id":"rush-bvw.6","title":"STABILITY-006: Proper Variable Expansion","description":"As a shell scripter, I need POSIX variable expansion so that my scripts can handle defaults, errors, and string manipulation.\n\n## Priority: P1 - HIGH\nCritical for POSIX compatibility.\n\n## Acceptance Criteria\n- [ ] ${VAR} - Braced variables\n- [ ] ${VAR:-default} - Use default if unset\n- [ ] ${VAR:=default} - Assign default if unset\n- [ ] ${VAR:?error} - Error if unset\n- [ ] ${VAR#pattern} - Remove shortest prefix match\n- [ ] ${VAR##pattern} - Remove longest prefix match\n- [ ] ${VAR%pattern} - Remove shortest suffix match\n- [ ] ${VAR%%pattern} - Remove longest suffix match\n- [ ] Works with arrays/lists (future)\n- [ ] cargo test passes (all tests including expansion tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Technical Implementation\n```rust\npub fn expand_variable(\u0026self, expr: \u0026str) -\u003e Result\u003cString\u003e {\n    // Parse ${VAR:-default} syntax\n    // Apply transformation based on operator\n    // Return expanded value\n}\n```\n\n## Files to Modify\n- src/runtime/mod.rs - Implement variable expansion\n- src/lexer/mod.rs - Tokenize braced variables\n- src/parser/mod.rs - Parse variable expansions\n\n## Testing\n- Test all expansion operators\n- Test nested expansions\n- Test edge cases (empty, unset, special chars)\n\n## Estimated Effort: 2 days","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T05:01:34.399799-08:00","created_by":"Asher","updated_at":"2026-01-20T09:52:55.352827-08:00","closed_at":"2026-01-20T09:52:55.352829-08:00","labels":["p1","posix","rush","stability","variables"],"dependencies":[{"issue_id":"rush-bvw.6","depends_on_id":"rush-bvw","type":"parent-child","created_at":"2026-01-20T05:01:34.401841-08:00","created_by":"Asher"}]}
{"id":"rush-bvw.7","title":"STABILITY-007: Wildcard Expansion (Globbing)","description":"As a shell user, I need glob patterns to work so that I can match multiple files with wildcards.\n\n## Priority: P1 - HIGH\nBasic shell functionality.\n\n## Acceptance Criteria\n- [ ] `*` matches any characters\n- [ ] `?` matches single character\n- [ ] `[...]` character classes work\n- [ ] `**` recursive glob (bonus)\n- [ ] Dotfiles not matched by default\n- [ ] Empty glob returns error (not literal)\n- [ ] Works with multiple patterns\n- [ ] cargo test passes (all tests including glob tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Technical Implementation\n```rust\nuse glob::glob;\n\nfn expand_globs(pattern: \u0026str) -\u003e Result\u003cVec\u003cPathBuf\u003e\u003e {\n    let matches = glob(pattern)?\n        .filter_map(Result::ok)\n        .collect();\n    Ok(matches)\n}\n```\n\n## Files to Modify\n- src/executor/mod.rs - Expand globs before execution\n- Cargo.toml - Add glob crate\n\n## Testing\n- Test * expansion\n- Test ? expansion\n- Test [...] expansion\n- Test dotfile handling\n- Test no matches error\n\n## Estimated Effort: 1 day","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T05:01:34.612126-08:00","created_by":"Asher","updated_at":"2026-01-20T08:54:19.47628-08:00","closed_at":"2026-01-20T08:54:19.476285-08:00","labels":["globbing","p1","rush","stability"],"dependencies":[{"issue_id":"rush-bvw.7","depends_on_id":"rush-bvw","type":"parent-child","created_at":"2026-01-20T05:01:34.614382-08:00","created_by":"Asher"}]}
{"id":"rush-bvw.8","title":"STABILITY-008: Command Substitution","description":"As a shell scripter, I need command substitution so that I can use command output in other commands.\n\n## Priority: P1 - HIGH\nEssential for shell scripting.\n\n## Acceptance Criteria\n- [ ] $(command) syntax works\n- [ ] \\`command\\` backticks work (bonus)\n- [ ] Nested substitution works: $(echo $(pwd))\n- [ ] Substitution in strings: \"path: $(pwd)\"\n- [ ] Exit code of substituted command available\n- [ ] Whitespace handling correct (trimming)\n- [ ] Works in pipes and redirects\n- [ ] cargo test passes (all tests including substitution tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Technical Implementation\n```rust\npub fn execute_command_substitution(\u0026mut self, command: \u0026str) -\u003e Result\u003cString\u003e {\n    let result = self.execute_line(command)?;\n    Ok(result.stdout.trim_end().to_string())\n}\n```\n\n## Files to Modify\n- src/parser/mod.rs - Parse $() syntax\n- src/executor/mod.rs - Execute and capture output\n- src/runtime/mod.rs - Substitute into parent command\n\n## Testing\n- Test simple substitution\n- Test nested substitution\n- Test substitution in strings\n- Test whitespace handling\n\n## Estimated Effort: 1 day","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T05:01:34.810327-08:00","created_by":"Asher","updated_at":"2026-01-20T05:53:39.428782-08:00","closed_at":"2026-01-20T05:53:39.428785-08:00","labels":["p1","rush","stability","substitution"],"dependencies":[{"issue_id":"rush-bvw.8","depends_on_id":"rush-bvw","type":"parent-child","created_at":"2026-01-20T05:01:34.811586-08:00","created_by":"Asher"}]}
{"id":"rush-bvw.9","title":"STABILITY-009: Job Control (Background Jobs)","description":"As a power user, I need job control so that I can run long tasks in the background and manage multiple jobs.\n\n## Priority: P2 - MEDIUM\nImportant for UX, not critical for basic shell use.\n\n## Acceptance Criteria\n- [ ] `command \u0026` runs in background\n- [ ] `jobs` builtin lists background jobs\n- [ ] `fg [job]` brings job to foreground\n- [ ] `bg [job]` continues stopped job in background\n- [ ] `kill %job` kills job by number\n- [ ] SIGCHLD handler for job status updates\n- [ ] Job status shown in prompt (optional)\n- [ ] cargo test passes (all tests including job tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Technical Implementation\n```rust\npub struct JobManager {\n    jobs: Vec\u003cJob\u003e,\n}\n\npub struct Job {\n    id: usize,\n    pid: u32,\n    command: String,\n    status: JobStatus,\n}\n\nenum JobStatus {\n    Running,\n    Stopped,\n    Done,\n}\n```\n\n## Files to Modify\n- src/executor/mod.rs - Handle \u0026 operator\n- src/runtime/mod.rs - Add JobManager\n- src/builtins/mod.rs - Add jobs, fg, bg builtins\n- src/main.rs - Handle SIGCHLD\n\n## Testing\n- Test background execution\n- Test jobs listing\n- Test fg/bg commands\n- Test job completion detection\n\n## Estimated Effort: 3 days","status":"closed","priority":3,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T05:01:35.011933-08:00","created_by":"Asher","updated_at":"2026-01-20T09:52:55.418415-08:00","closed_at":"2026-01-20T09:52:55.418417-08:00","labels":["job-control","p2","rush","stability"],"dependencies":[{"issue_id":"rush-bvw.9","depends_on_id":"rush-bvw","type":"parent-child","created_at":"2026-01-20T05:01:35.013218-08:00","created_by":"Asher"}]}
{"id":"rush-cqr","title":"Add configuration file support","description":"Rush needs a configuration file system (.rushrc or similar) to: 1) Set default options, 2) Define aliases, 3) Configure history settings, 4) Set environment variables, 5) Define custom functions, 6) Configure prompt","status":"open","priority":2,"issue_type":"feature","owner":"a@kf.cafe","created_at":"2026-01-20T03:03:07.961014-08:00","created_by":"Asher","updated_at":"2026-01-20T03:03:07.961014-08:00","labels":["enhancement","phase4"]}
{"id":"rush-d2t","title":"Fix tokenizer splitting paths on forward slash","description":"## Problem\n\nRush's tokenizer incorrectly treats `/` as a token separator in unquoted arguments. This causes paths like `benches/rush_benchmark.py` to be split into two separate tokens: `benches` and `/rush_benchmark.py`.\n\n## Reproduction\n\n```bash\n./target/release/rush -c 'echo benches/rush_benchmark.py'\n# Output: benches /rush_benchmark.py  (incorrectly split)\n\n./target/release/rush -c 'cat benches/rush_benchmark.py'\n# Error: cat: benches: Is a directory\n# Error: cat: /rush_benchmark.py: No such file or directory\n```\n\n## Expected Behavior\n\nPaths should be treated as single tokens:\n```bash\n./target/release/rush -c 'echo benches/rush_benchmark.py'\n# Expected: benches/rush_benchmark.py\n```\n\n## Workaround\n\nQuoting the path works:\n```bash\n./target/release/rush -c 'python3 \"benches/rush_benchmark.py\"'\n```\n\n## Impact\n\nThis breaks basic shell usage - running commands with relative or absolute paths requires quoting, which is non-standard behavior.\n\n## Location\n\nThe bug is likely in `src/lexer/mod.rs` or `src/parser/mod.rs` where tokens are split.","status":"open","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-25T09:59:57.377921-08:00","created_by":"Asher","updated_at":"2026-01-25T09:59:57.377921-08:00","labels":["bug","parser"]}
{"id":"rush-daemon-perf","title":"Daemon Performance Optimization - Achieve \u003c1ms Startup","description":"Optimize Rush daemon to achieve sub-millisecond startup overhead.\n\n## Current Status\n- Direct execution: 4.5ms ± 0.8ms\n- Daemon execution: 9.3ms ± 1.6ms\n- **Current overhead: 4.8ms** (vs target of 0.4ms)\n\n## Goal\nReduce daemon overhead from 4.8ms to \u003c1ms through architectural improvements.\n\n## Success Criteria\n- Daemon execution \u003c 5.5ms (better than direct execution)\n- Ideally \u003c 2ms total (80%+ improvement)\n- All tests passing\n- No regression in functionality\n- Stdout/stderr capture still working\n\n## Strategy\nThree-phase optimization approach:\n1. **Binary serialization** (80 LOC, quick win) - 0.3ms saved\n2. **Persistent workers** (250 LOC, core fix) - 2-3ms saved  \n3. **Reusable executors** (120 LOC, polish) - 1-2ms saved\n\n## Philosophy\nProfile-driven optimization:\n- Measure before/after each change\n- Focus on biggest bottlenecks first\n- Don't over-engineer\n- Keep code maintainable","status":"open","priority":1,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-20T20:00:00-08:00","created_by":"Asher","updated_at":"2026-01-20T20:00:00-08:00","labels":["daemon","epic","optimization","performance"]}
{"id":"rush-daemon-perf.1","title":"Binary Serialization for IPC Protocol","description":"Replace JSON serialization with binary format (bincode/MessagePack) for faster encoding/decoding.\n\n## Priority: P2 - Quick Win\nLow effort, immediate improvement. Good warmup task.\n\n## Current Implementation\n- Using serde_json for human-readable debugging\n- JSON encoding/decoding adds ~0.3-0.5ms overhead\n- Protocol is length-prefixed binary with JSON payload\n\n## Proposed Solution\nReplace serde_json with bincode (or rmp for MessagePack):\n- Same serde traits, just different serializer\n- Binary format is more compact\n- Faster encoding/decoding\n- Still type-safe\n\n## Acceptance Criteria\n- [ ] Replace serde_json with bincode in src/daemon/protocol.rs\n- [ ] Update encode_message() and decode_message()\n- [ ] All protocol tests pass\n- [ ] Benchmark shows 0.2-0.4ms improvement\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n\n## Implementation Steps\n1. Add bincode dependency to Cargo.toml\n2. Replace serde_json::to_vec with bincode::serialize\n3. Replace serde_json::from_slice with bincode::deserialize\n4. Update tests\n5. Benchmark before/after\n\n## Files Modified\n- Cargo.toml (add bincode)\n- src/daemon/protocol.rs (~50 LOC changes)\n\n## Testing\n- All existing protocol tests should pass unchanged\n- Add benchmark comparison test\n\n## Estimated Effort\n~30 minutes\n\n## Expected Speedup\n0.2-0.4ms reduction in daemon overhead","status":"open","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T20:00:00-08:00","created_by":"Asher","updated_at":"2026-01-20T20:00:00-08:00","labels":["daemon","easy","performance","quick-win"],"dependencies":[{"issue_id":"rush-daemon-perf.1","depends_on_id":"rush-daemon-perf","type":"parent-child","created_at":"2026-01-20T20:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-daemon-perf.2","title":"Persistent Worker Process Pool","description":"Replace fork-per-request with persistent worker pool to eliminate process creation overhead.\n\n## Priority: P0 - CRITICAL\nBiggest performance win. Core architectural fix.\n\n## Current Implementation\n- Each client request triggers fork() in accept_connection()\n- Worker process created, executes command, exits\n- Wasteful: full process creation + teardown per command\n- Overhead: ~2-3ms per request\n\n## Proposed Solution\nMaintain a pool of long-lived worker processes:\n- Pre-spawn N workers at daemon startup (N=4-8)\n- Workers listen on internal channels for requests\n- Dispatch requests to available workers\n- Workers reset state between requests (chdir, env vars)\n- Monitor worker health, respawn if needed\n\n## Architecture\n```rust\nstruct WorkerPool {\n    workers: Vec\u003cWorker\u003e,\n    request_queue: mpsc::Sender\u003cSessionRequest\u003e,\n    available: Arc\u003cAtomicUsize\u003e,\n}\n\nstruct Worker {\n    pid: Pid,\n    channel: UnixStream,\n    state: WorkerState,\n}\n```\n\n## Acceptance Criteria\n- [ ] WorkerPool struct created in src/daemon/worker_pool.rs\n- [ ] Pre-spawn 4-8 workers at daemon startup\n- [ ] Request dispatching to available workers\n- [ ] Worker state reset between requests (cwd, env, executor)\n- [ ] Worker health monitoring and auto-respawn\n- [ ] Graceful worker shutdown on daemon exit\n- [ ] All existing tests pass\n- [ ] New worker pool tests added\n- [ ] Benchmark shows 2-3ms improvement\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n\n## Implementation Steps\n1. Create src/daemon/worker_pool.rs\n2. Design Worker struct with persistent state\n3. Implement worker spawn/manage/retire logic\n4. Add request queue/dispatch mechanism\n5. Implement state reset between requests\n6. Add health monitoring\n7. Update server.rs to use worker pool\n8. Update tests\n9. Benchmark\n\n## Files Created\n- src/daemon/worker_pool.rs (~200 LOC)\n\n## Files Modified  \n- src/daemon/server.rs (~100 LOC changes)\n- src/daemon/mod.rs (exports)\n\n## Challenges\n- State isolation between requests\n- Detecting worker hangs/crashes\n- Balancing pool size vs memory\n- Handling worker backpressure\n\n## Testing\n- Worker spawn/shutdown\n- Request dispatching\n- State reset verification\n- Worker failure recovery\n- Concurrent request handling\n- Load testing\n\n## Estimated Effort\n4-6 hours\n\n## Expected Speedup\n2-3ms reduction in daemon overhead (biggest win)","status":"open","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T20:00:00-08:00","created_by":"Asher","updated_at":"2026-01-20T20:00:00-08:00","labels":["architecture","critical","daemon","performance"],"dependencies":[{"issue_id":"rush-daemon-perf.2","depends_on_id":"rush-daemon-perf","type":"parent-child","created_at":"2026-01-20T20:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-daemon-perf.3","title":"Reusable Executor Instances","description":"Reset executor state between commands instead of creating new instances.\n\n## Priority: P1 - Important\nGood follow-up to persistent workers. Eliminates initialization overhead.\n\n## Current Implementation\n- Each command creates new Executor::new_embedded()\n- Executor contains Runtime, Builtins, Corrector\n- All state allocated fresh per command\n- Overhead: ~1-2ms per request\n\n## Proposed Solution\nAdd reset() methods to reuse executor instances:\n- Executor::reset() - resets all subsystems\n- Runtime::reset() - clears variables, resets state\n- Keep executors in worker processes\n- Reset between commands instead of recreate\n\n## Architecture\n```rust\nimpl Executor {\n    pub fn reset(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.runtime.reset()?;\n        // Builtins and Corrector are stateless\n        Ok(())\n    }\n}\n\nimpl Runtime {\n    pub fn reset(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.variables.clear();\n        self.set_last_exit_code(0);\n        self.scopes.clear();\n        self.call_stack.clear();\n        self.positional_params.clear();\n        self.positional_stack.clear();\n        self.function_depth = 0;\n        // Keep history, undo_manager, job_manager\n        Ok(())\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] Executor::reset() method implemented\n- [ ] Runtime::reset() method implemented\n- [ ] Workers reuse executor instances\n- [ ] All state properly cleared between commands\n- [ ] No state leakage between requests\n- [ ] All existing tests pass\n- [ ] New reset tests added\n- [ ] Benchmark shows 1-2ms improvement\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n\n## Implementation Steps\n1. Add Executor::reset() in src/executor/mod.rs\n2. Add Runtime::reset() in src/runtime/mod.rs\n3. Update worker code to reuse executors\n4. Add comprehensive state reset tests\n5. Verify no state leakage\n6. Benchmark\n\n## Files Modified\n- src/executor/mod.rs (~50 LOC)\n- src/runtime/mod.rs (~70 LOC)\n- src/daemon/worker_pool.rs (~20 LOC)\n\n## Challenges\n- Identifying all state to clear\n- Deciding what to keep (history, jobs?)\n- Testing for state leakage\n- Edge cases (partial execution, errors)\n\n## Testing\n- Reset clears all relevant state\n- No leakage between commands\n- Variables don't persist\n- Exit codes reset properly\n- Error conditions\n\n## Estimated Effort\n2-3 hours\n\n## Expected Speedup\n1-2ms reduction in daemon overhead\n\n## Dependencies\nShould be implemented after rush-daemon-perf.2 (persistent workers)","status":"open","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T20:00:00-08:00","created_by":"Asher","updated_at":"2026-01-20T20:00:00-08:00","labels":["daemon","optimization","performance"],"dependencies":[{"issue_id":"rush-daemon-perf.3","depends_on_id":"rush-daemon-perf","type":"parent-child","created_at":"2026-01-20T20:00:00-08:00","created_by":"Asher"},{"issue_id":"rush-daemon-perf.3","depends_on_id":"rush-daemon-perf.2","type":"blocks","created_at":"2026-01-20T20:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-daemon-perf.4","title":"Performance Benchmarking and Verification","description":"Comprehensive benchmarking suite to measure and verify all performance improvements.\n\n## Priority: P1 - Important\nEssential for validating optimizations and preventing regressions.\n\n## Objectives\n- Establish baseline performance metrics\n- Measure impact of each optimization\n- Create automated benchmark suite\n- Prevent performance regressions\n\n## Acceptance Criteria\n- [ ] Benchmark suite using hyperfine or criterion\n- [ ] Measure daemon startup overhead\n- [ ] Measure command execution latency\n- [ ] Measure throughput (commands/sec)\n- [ ] Compare before/after for each optimization\n- [ ] Document results in benchmarks/RESULTS.md\n- [ ] CI integration to detect regressions\n- [ ] Target achieved: \u003c5.5ms total, \u003c1ms overhead\n\n## Benchmarks to Track\n1. **Cold Start**: First command after daemon start\n2. **Warm Execution**: Subsequent commands\n3. **Concurrent Load**: Multiple clients\n4. **Large Output**: Commands with MB+ output\n5. **Error Cases**: Failed commands, timeouts\n\n## Metrics\n- Latency: p50, p95, p99\n- Throughput: commands/second\n- Memory: daemon RSS, worker RSS\n- CPU: daemon CPU%, worker CPU%\n\n## Implementation\n- Create benches/ directory\n- Add benchmark scripts\n- Use hyperfine for end-to-end\n- Use criterion for microbenchmarks\n- Document methodology\n\n## Files Created\n- benches/daemon_latency.rs\n- benches/throughput.sh\n- benchmarks/RESULTS.md\n\n## Expected Results\n| Metric | Baseline | After Binary | After Workers | After Reuse | Target |\n|--------|----------|--------------|---------------|-------------|--------|\n| Latency | 9.3ms | 8.9ms | 6.0ms | 4.5ms | \u003c5.5ms |\n| Overhead | 4.8ms | 4.4ms | 1.5ms | 0.0ms | \u003c1.0ms |\n\n## Estimated Effort\n2-3 hours\n\n## Dependencies\nRun after each optimization to measure impact","status":"open","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T20:00:00-08:00","created_by":"Asher","updated_at":"2026-01-20T20:00:00-08:00","labels":["benchmarking","daemon","performance","testing"],"dependencies":[{"issue_id":"rush-daemon-perf.4","depends_on_id":"rush-daemon-perf","type":"parent-child","created_at":"2026-01-20T20:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-dgr","title":"POSIX Compliance - Full Unix Shell Support","description":"Implement POSIX shell compliance to make Rush a legitimate Unix shell that can run standard shell scripts.\n\n## Motivation\nRush aims to be an AI-native Unix shell. To call it \"Unix\", we need POSIX compliance:\n- Run standard shell scripts without modification\n- Support ~/.bashrc and ~/.profile scripts\n- Enable git hooks, build scripts, and automation\n- Provide a familiar environment for Unix users\n- Maintain Rush's performance advantages while adding compatibility\n\n## Current Status\n~60% POSIX compliant:\n✅ Core execution model (pipes, redirects, subshells, jobs)\n✅ 26 builtins implemented\n❌ Missing 12+ required POSIX builtins\n❌ Incomplete I/O redirection (no arbitrary FDs, no here-docs)\n❌ Missing control flow (while, until, case)\n❌ Incomplete positional parameters\n\n## Success Criteria\n- All required POSIX builtins implemented\n- Positional parameters fully wired ($1-$9, $@, $*, $#, ${10}+)\n- Special variables implemented ($$, $!, $-, $_)\n- Here-documents working (\u003c\u003cEOF, \u003c\u003c-EOF)\n- Control flow complete (while, until, case)\n- Break and continue implemented\n- Process groups and terminal control\n- Arbitrary FD redirection (3\u003e\u00261, etc.)\n- IFS-based field splitting\n- Proper quoting behavior verified\n- POSIX test suite passing (target: 90%+)\n\n## Philosophy\n**AI-Native Unix Shell** - Core POSIX + AI-native extensions:\n- Implement POSIX where it makes sense (muscle memory, compatibility)\n- Add modern conveniences (better errors, safety features)\n- Skip legacy cruft that doesn't serve users\n- Build AI-native tools that compose with Unix principles\n\n## Scope\nThis epic covers Priority 1 and Priority 2 from the POSIX audit:\n- Priority 1: Core POSIX Compliance (Critical)\n- Priority 2: Job Control \u0026 Signals (Important)\n\nPriority 3 (Advanced I/O) and Priority 4 (Testing) will be follow-up epics.\n\nSee docs/POSIX_COMPLIANCE_AUDIT.md for detailed analysis.","status":"open","priority":1,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-24T10:37:25.076889-08:00","created_by":"Asher","updated_at":"2026-01-24T10:37:25.076889-08:00","labels":["compliance","epic","posix","shell","unix"]}
{"id":"rush-dgr.1","title":"POSIX-001: Re-enable and test read builtin","description":"Re-enable the commented-out `read` builtin and ensure it works correctly with full POSIX semantics.\n\n## Context\nThe `read` builtin exists at `src/builtins/read.rs` but is commented out in `src/builtins/mod.rs`. It needs to be uncommented, tested, and verified.\n\n## Acceptance Criteria\n- Uncomment `read` module in src/builtins/mod.rs\n- Uncomment read builtin registration\n- Test basic read functionality: `read VAR`\n- Test reading multiple variables: `read VAR1 VAR2 VAR3`\n- Test reading from stdin in pipelines: `echo \"hello\" | read VAR`\n- Test IFS-based word splitting (if IFS is available, else note limitation)\n- Test -r flag (disable backslash escapes)\n- Test -p flag (prompt)\n- Add integration tests\n- Update help text\n\n## POSIX Requirements\n- Read one line from stdin\n- Split into words based on IFS\n- Assign words to variables (first word → first var, etc.)\n- Last variable gets all remaining words\n- Exit code 0 on success, non-zero on EOF\n\n## Files to Modify\n- src/builtins/mod.rs (uncomment)\n- src/builtins/read.rs (verify/fix implementation)\n- tests/builtin_tests.rs or similar (add tests)\n\n## Estimated Effort\n30-40k tokens (re-enable, fix issues, add tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:38:27.017895-08:00","created_by":"Asher","updated_at":"2026-01-24T11:02:47.660091-08:00","closed_at":"2026-01-24T11:02:47.660091-08:00","close_reason":"Completed by agent","labels":["builtin","critical","posix"],"dependencies":[{"issue_id":"rush-dgr.1","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:38:27.020003-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.10","title":"POSIX-010: Implement continue builtin","description":"Implement the `continue` builtin for skipping to next loop iteration.\n\n## Context\nCurrently missing. Essential for loop control flow.\n\n## Acceptance Criteria\n- Create src/builtins/continue.rs\n- Implement continue builtin\n- Register in src/builtins/mod.rs\n- Test basic continue: skips to next iteration of innermost loop\n- Test continue N: skips N levels of nested loops\n- Test continue outside loop (should error)\n- Test continue with invalid N (should error)\n- Define ContinueSignal similar to ReturnSignal/BreakSignal\n- Ensure executor catches ContinueSignal\n- Add integration tests\n- Update help text\n\n## POSIX Requirements\n- Skip to next iteration of for, while, or until loop\n- `continue [n]` affects n enclosing loops (default 1)\n- Error if n \u003e number of enclosing loops\n- Error if called outside loop\n- Exit code 0 on success, \u003e0 on error\n\n## Files to Create/Modify\n- src/builtins/continue.rs (new file)\n- src/builtins/mod.rs (register builtin, export ContinueSignal if needed)\n- src/executor/mod.rs (handle ContinueSignal in loops)\n- tests/loop_control_tests.rs (add tests)\n\n## Estimated Effort\n40-50k tokens (implement from scratch, add signal handling, add tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:51:31.759913-08:00","created_by":"Asher","updated_at":"2026-01-24T12:24:59.123387-08:00","closed_at":"2026-01-24T12:24:59.123387-08:00","close_reason":"Completed by agent","labels":["builtin","control-flow","critical","loops","posix"],"dependencies":[{"issue_id":"rush-dgr.10","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:51:31.76087-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.11","title":"POSIX-011: Implement colon (:) no-op builtin","description":"Implement the `:` (colon) builtin that does nothing and always returns success.\n\n## Context\nThe colon builtin is a POSIX requirement, often used in conditionals and as a no-op placeholder.\n\n## Acceptance Criteria\n- Create src/builtins/colon.rs OR add to mod.rs as simple function\n- Implement colon builtin that returns exit code 0\n- Register as \":\" in src/builtins/mod.rs\n- Test basic usage: `:` returns 0\n- Test with arguments (should ignore them): `: foo bar baz` returns 0\n- Test in conditionals: `if :; then echo yes; fi` → yes\n- Test with redirections: `: \u003e file.txt` creates empty file\n- Test with variable assignments: `VAR=value :` sets VAR\n- Add integration tests\n- Update help text\n\n## POSIX Requirements\n- Always return exit code 0\n- Ignore all arguments\n- Can be used with redirections (useful for creating files)\n- Can be used with variable assignments\n- No output\n\n## Files to Create/Modify\n- src/builtins/colon.rs (new file) OR builtin_colon in mod.rs\n- src/builtins/mod.rs (register \":\" → builtin_colon)\n- tests/builtin_tests.rs (add tests)\n\n## Estimated Effort\n20-30k tokens (simple implementation, comprehensive tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:51:33.401996-08:00","created_by":"Asher","updated_at":"2026-01-24T12:30:41.652718-08:00","closed_at":"2026-01-24T12:30:41.652718-08:00","close_reason":"Completed by agent","labels":["builtin","critical","posix"],"dependencies":[{"issue_id":"rush-dgr.11","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:51:33.40288-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.12","title":"POSIX-012: Implement command builtin","description":"Implement the `command` builtin for bypassing shell functions and aliases.\n\n## Context\nThe `command` builtin runs commands, bypassing function and alias lookup. Similar to `builtin` but also works for external commands.\n\n## Acceptance Criteria\n- Create src/builtins/command.rs\n- Implement command builtin\n- Register in src/builtins/mod.rs\n- Test `command cmd`: bypasses functions/aliases, runs builtin or external\n- Test `command -p cmd`: use default PATH\n- Test `command -v cmd`: print command type (like `type`)\n- Test `command -V cmd`: verbose command type\n- Test with function shadowing builtin\n- Test with alias shadowing command\n- Add integration tests\n- Update help text\n\n## POSIX Requirements\n- Execute command bypassing function lookup\n- `-p` uses default PATH instead of current PATH\n- `-v` prints description of command (similar to type)\n- `-V` prints verbose description\n- Exit code: command's exit code, or error code if not found\n\n## Files to Create/Modify\n- src/builtins/command.rs (new file)\n- src/builtins/mod.rs (register builtin)\n- src/executor/mod.rs (may need to expose command resolution logic)\n- tests/command_tests.rs (add tests)\n\n## Estimated Effort\n45-55k tokens (implement resolution logic, add all flags, add tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:51:35.428245-08:00","created_by":"Asher","updated_at":"2026-01-24T12:59:51.714368-08:00","closed_at":"2026-01-24T12:59:51.714368-08:00","close_reason":"Completed by agent","labels":["builtin","critical","execution","posix"],"dependencies":[{"issue_id":"rush-dgr.12","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:51:35.429219-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.13","title":"POSIX-013: Implement readonly builtin","description":"Implement the `readonly` builtin for making variables immutable.\n\n## Context\nThe `readonly` builtin marks variables as read-only, preventing modification or unsetting.\n\n## Acceptance Criteria\n- Create src/builtins/readonly.rs\n- Implement readonly builtin\n- Register in src/builtins/mod.rs\n- Add readonly flag/tracking to Runtime variable storage\n- Test `readonly VAR=value`: creates readonly variable\n- Test `readonly VAR`: marks existing variable readonly\n- Test modifying readonly variable (should error)\n- Test unsetting readonly variable (should error)\n- Test `readonly -p`: print all readonly variables\n- Test readonly variables persist across function calls\n- Add integration tests\n- Update help text\n\n## POSIX Requirements\n- Mark variables as read-only\n- Can set value and mark readonly in one command\n- Can mark existing variable readonly\n- Attempting to modify or unset readonly variable is an error\n- `-p` option prints readonly variables\n- Exit code 0 on success, \u003e0 on error\n\n## Files to Create/Modify\n- src/builtins/readonly.rs (new file)\n- src/builtins/mod.rs (register builtin)\n- src/runtime/mod.rs (add readonly flag to variables)\n- src/builtins/unset.rs (check readonly before unsetting)\n- tests/readonly_tests.rs (add tests)\n\n## Estimated Effort\n45-55k tokens (implement readonly tracking, modify runtime, add tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:52:08.763182-08:00","created_by":"Asher","updated_at":"2026-01-24T13:45:07.44554-08:00","closed_at":"2026-01-24T13:45:07.44554-08:00","close_reason":"Completed by agent","labels":["builtin","critical","posix","variables"],"dependencies":[{"issue_id":"rush-dgr.13","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:52:08.764086-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.14","title":"POSIX-014: Implement full positional parameters","description":"Fully implement positional parameters ($0, $1-$9, ${10}+, $#, $@, $*).\n\n## Context\nRuntime has `positional_params` field but it's not fully wired up. Need complete implementation.\n\n## Acceptance Criteria\n- Wire up $0 (script/shell name)\n- Wire up $1-$9 (first 9 arguments)\n- Wire up ${10}, ${11}, etc. (arguments 10+)\n- Wire up $# (argument count)\n- Wire up $@ (all arguments, individually quoted)\n- Wire up $* (all arguments, merged with IFS)\n- Test in scripts: `./script.sh arg1 arg2 arg3`\n- Test in functions: `fn foo() { echo $1 $2; }; foo a b`\n- Test shift interaction: shift decrements $# and shifts arguments\n- Test $@ vs $* behavior with IFS\n- Test quoted vs unquoted: \"$@\" vs $@, \"$*\" vs $*\n- Add integration tests\n- Document behavior\n\n## POSIX Requirements\n- $0: shell name or script name\n- $1-$9, ${10}+: positional parameters\n- $#: number of positional parameters (not counting $0)\n- $@: expands to separate words, preserves empty strings when quoted\n- $*: expands to single word (joined by first char of IFS)\n- Proper quoting behavior\n\n## Files to Modify\n- src/runtime/mod.rs (ensure positional_params is populated)\n- src/executor/mod.rs (pass args to functions, scripts)\n- src/executor/mod.rs variable expansion (expand $1-$9, ${10}+, $#, $@, $*)\n- src/main.rs (set $0 and script args)\n- tests/positional_param_tests.rs (add comprehensive tests)\n\n## Estimated Effort\n50-60k tokens (wire up all params, test edge cases, handle quoting)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:52:11.116382-08:00","created_by":"Asher","updated_at":"2026-01-24T14:26:52.549331-08:00","closed_at":"2026-01-24T14:26:52.549331-08:00","close_reason":"Completed by agent","labels":["critical","parameters","posix","variables"],"dependencies":[{"issue_id":"rush-dgr.14","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:52:11.128847-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.16","title":"POSIX-015: Implement special variables","description":"Implement POSIX special variables: $$, $!, $-, $_\n\n## Context\nCurrently only $? (exit code) is implemented. Need $$, $!, $-, $_.\n\n## Acceptance Criteria\n- Implement $$ (current shell PID)\n- Implement $! (PID of last background job)\n- Implement $- (current shell options as flags: e, u, x, etc.)\n- Implement $_ (last argument of previous command)\n- Test $$ returns consistent PID\n- Test $! after background job: `sleep 10 \u0026; echo $!`\n- Test $! is empty when no background jobs\n- Test $- reflects current set options: `set -e; echo $-` contains 'e'\n- Test $_ captures last arg: `echo foo bar; echo $_` → bar\n- Add integration tests\n- Document variables\n\n## POSIX Requirements\n- $$: Process ID of the shell\n- $!: Process ID of last background command\n- $-: Current option flags (as set by set command)\n- $_: Last argument of previous command (not strictly POSIX but common)\n\n## Files to Modify\n- src/runtime/mod.rs (add tracking for last_bg_pid, last_arg)\n- src/executor/mod.rs (update last_arg after commands)\n- src/executor/mod.rs variable expansion (expand $$, $!, $-, $_)\n- src/jobs/mod.rs (update last_bg_pid when starting background jobs)\n- tests/special_variables_tests.rs (add tests)\n\n## Estimated Effort\n40-50k tokens (implement tracking, wire up expansion, add tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:52:31.15413-08:00","created_by":"Asher","updated_at":"2026-01-24T14:47:42.847351-08:00","closed_at":"2026-01-24T14:47:42.847351-08:00","close_reason":"Completed by agent","labels":["critical","posix","variables"],"dependencies":[{"issue_id":"rush-dgr.16","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:52:31.155431-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.17","title":"POSIX-016: Implement here-documents","description":"Implement here-document syntax (\u003c\u003cEOF and \u003c\u003c-EOF).\n\n## Context\nHere-documents allow multi-line input to commands. Essential POSIX feature.\n\n## Acceptance Criteria\n- Add here-doc parsing to lexer/parser\n- Implement basic here-doc: `cat \u003c\u003cEOF\\nline1\\nline2\\nEOF`\n- Implement indented here-doc: `cat \u003c\u003c-EOF\\n\\tindented\\nEOF` (strips leading tabs)\n- Test variable expansion in here-docs\n- Test quoted delimiter (no expansion): `cat \u003c\u003c'EOF'\\n$var\\nEOF`\n- Test here-doc with commands: `grep foo \u003c\u003cEOF`\n- Test multiple here-docs in same command\n- Test here-doc in pipelines: `cat \u003c\u003cEOF | grep pattern`\n- Add integration tests\n- Document syntax\n\n## POSIX Requirements\n- `\u003c\u003cword`: Lines until 'word' are stdin to command\n- `\u003c\u003c-word`: Same but strips leading tabs from lines\n- Variable expansion happens unless delimiter is quoted\n- Delimiter must be on line by itself\n- Multiple here-docs can be in same command\n\n## Files to Create/Modify\n- src/lexer.rs (add here-doc token recognition)\n- src/parser.rs (parse here-doc syntax)\n- src/ast.rs (add HereDoc node to AST)\n- src/executor/mod.rs (handle here-doc execution)\n- tests/here_doc_tests.rs (add tests)\n\n## Estimated Effort\n55-60k tokens (complex parsing, variable expansion, add tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:52:32.937009-08:00","created_by":"Asher","updated_at":"2026-01-24T15:09:00.65318-08:00","closed_at":"2026-01-24T15:09:00.65318-08:00","close_reason":"Completed by agent","labels":["critical","io","parser","posix","redirection"],"dependencies":[{"issue_id":"rush-dgr.17","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:52:32.938333-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.18","title":"POSIX-017: Implement while loop","description":"Implement POSIX while loop syntax and execution.\n\n## Context\nRush has for loops but not while loops. Essential for POSIX compliance.\n\n## Acceptance Criteria\n- Add while parsing to parser\n- Add While node to AST\n- Implement while execution in executor\n- Test basic while: `i=0; while [ $i -lt 5 ]; do echo $i; i=$((i+1)); done`\n- Test while with break\n- Test while with continue\n- Test nested while loops\n- Test while with pipelines in condition\n- Test exit code propagation (last command in last iteration)\n- Add integration tests\n- Document syntax\n\n## POSIX Requirements\n- `while list1; do list2; done`\n- Executes list2 repeatedly as long as list1 exits with 0\n- Exit code is last command executed in list2, or 0 if never executed\n- break/continue affect while loops\n\n## Files to Create/Modify\n- src/parser.rs (add while parsing)\n- src/ast.rs (add While node)\n- src/executor/mod.rs (add while execution, handle BreakSignal/ContinueSignal)\n- tests/while_loop_tests.rs (add tests)\n\n## Estimated Effort\n45-55k tokens (implement parsing, execution, break/continue integration, add tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:52:57.445038-08:00","created_by":"Asher","updated_at":"2026-01-25T01:58:21.391754-08:00","closed_at":"2026-01-25T01:58:21.391754-08:00","close_reason":"Closed","labels":["control-flow","critical","loops","parser","posix"],"dependencies":[{"issue_id":"rush-dgr.18","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:52:57.445907-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.19","title":"POSIX-018: Implement until loop","description":"Implement POSIX until loop syntax and execution.\n\n## Context\nThe until loop is the inverse of while. Executes until condition is true.\n\n## Acceptance Criteria\n- Add until parsing to parser\n- Add Until node to AST\n- Implement until execution in executor\n- Test basic until: `i=0; until [ $i -ge 5 ]; do echo $i; i=$((i+1)); done`\n- Test until with break\n- Test until with continue\n- Test nested until loops\n- Test until mixed with while loops\n- Test exit code propagation\n- Add integration tests\n- Document syntax\n\n## POSIX Requirements\n- `until list1; do list2; done`\n- Executes list2 repeatedly as long as list1 exits with non-zero\n- Exit code is last command executed in list2, or 0 if never executed\n- break/continue affect until loops\n\n## Files to Create/Modify\n- src/parser.rs (add until parsing)\n- src/ast.rs (add Until node)\n- src/executor/mod.rs (add until execution, handle BreakSignal/ContinueSignal)\n- tests/until_loop_tests.rs (add tests)\n\n## Estimated Effort\n40-50k tokens (similar to while, implement parsing, execution, add tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:52:59.125377-08:00","created_by":"Asher","updated_at":"2026-01-25T01:58:21.396675-08:00","closed_at":"2026-01-25T01:58:21.396675-08:00","close_reason":"Closed","labels":["control-flow","critical","loops","parser","posix"],"dependencies":[{"issue_id":"rush-dgr.19","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:52:59.126339-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.2","title":"POSIX-002: Re-enable and test return builtin","description":"Re-enable the `return` builtin for returning from shell functions with an exit code.\n\n## Context\nThe `return` builtin exists at `src/builtins/return_builtin.rs` but is commented out. It's critical for function control flow.\n\n## Acceptance Criteria\n- Uncomment `return_builtin` module in src/builtins/mod.rs\n- Make module public so executor can access ReturnSignal\n- Uncomment return builtin registration\n- Test basic return: `fn foo() { return 42 }; foo; echo $?` → 42\n- Test return without argument (should use $? from last command)\n- Test return from sourced file (. script.sh)\n- Test that return fails when not in function/sourced file\n- Verify ReturnSignal is properly caught in executor\n- Add integration tests\n- Update help text\n\n## POSIX Requirements\n- Exit from shell function with specified exit code\n- Default exit code is $? if not specified\n- Error if called outside function or sourced script\n- Exit code 0-255\n\n## Files to Modify\n- src/builtins/mod.rs (uncomment, make public)\n- src/builtins/return_builtin.rs (verify implementation)\n- src/executor/mod.rs (verify ReturnSignal handling)\n- src/builtins/mod.rs builtin_source (uncomment return handling)\n- tests/function_tests.rs or similar (add tests)\n\n## Estimated Effort\n35-45k tokens (re-enable, fix integration, add tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:38:53.968206-08:00","created_by":"Asher","updated_at":"2026-01-24T11:36:11.723452-08:00","closed_at":"2026-01-24T11:36:11.723452-08:00","close_reason":"Completed by agent","labels":["builtin","critical","functions","posix"],"dependencies":[{"issue_id":"rush-dgr.2","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:38:53.969328-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.20","title":"POSIX-019: Implement case statement","description":"Implement POSIX case statement (or make existing match POSIX-compatible).\n\n## Context\nRush has a `match` expression. Need POSIX case statement syntax.\n\n## Acceptance Criteria\n- Decide: adapt existing match OR implement separate case\n- Add case parsing to parser (case/in/pattern/;;/esac)\n- Add Case node to AST (or adapt Match)\n- Implement case execution in executor\n- Test basic case: `case $x in pat1) echo 1;; pat2) echo 2;; esac`\n- Test multiple patterns: `pat1|pat2) echo matched;;`\n- Test wildcard pattern: `*) echo default;;`\n- Test pattern matching with globs: `*.txt) echo text file;;`\n- Test fall-through behavior (;; vs ;\u0026 vs ;;\u0026 if implementing bash extensions)\n- Add integration tests\n- Document syntax\n\n## POSIX Requirements\n- `case word in [pattern [| pattern]...) list ;;]... esac`\n- Matches word against patterns (glob-style)\n- Executes list for first matching pattern\n- Patterns can use *, ?, [...]\n- Multiple patterns separated by |\n- Exit code is last command in executed list, or 0 if no match\n\n## Files to Create/Modify\n- src/parser.rs (add case parsing)\n- src/ast.rs (add Case node or adapt Match)\n- src/executor/mod.rs (add case execution with pattern matching)\n- tests/case_statement_tests.rs (add tests)\n\n## Estimated Effort\n50-60k tokens (complex parsing, pattern matching, add tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:53:01.014259-08:00","created_by":"Asher","updated_at":"2026-01-25T01:58:21.400873-08:00","closed_at":"2026-01-25T01:58:21.400873-08:00","close_reason":"Closed","labels":["control-flow","critical","parser","posix"],"dependencies":[{"issue_id":"rush-dgr.20","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:53:01.015319-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.21","title":"POSIX-020: Implement IFS field splitting","description":"Implement IFS-based field splitting for word expansion.\n\n## Context\nPOSIX requires word splitting based on IFS (Internal Field Separator) variable. Currently not fully implemented.\n\n## Acceptance Criteria\n- Implement IFS variable (default: space, tab, newline)\n- Apply IFS splitting to unquoted variable expansions\n- Apply IFS splitting to command substitution\n- Test default IFS: `var=\"a b c\"; for x in $var; do echo $x; done`\n- Test custom IFS: `IFS=:; var=\"a:b:c\"; for x in $var; do echo $x; done`\n- Test IFS with multiple chars: `IFS=:,; var=\"a:b,c\"; for x in $var; do echo $x; done`\n- Test quoted expansions skip IFS: `for x in \"$var\"; do echo $x; done`\n- Test empty IFS (no splitting): `IFS=; var=\"a b c\"; echo $var`\n- Add integration tests\n- Document IFS behavior\n\n## POSIX Requirements\n- IFS contains characters used for field splitting\n- Default IFS is \u003cspace\u003e\u003ctab\u003e\u003cnewline\u003e\n- Unquoted expansions are split on IFS characters\n- Quoted expansions (\"$var\") are NOT split\n- Empty IFS means no splitting\n\n## Files to Modify\n- src/runtime/mod.rs (track IFS variable)\n- src/executor/mod.rs (apply IFS splitting in variable expansion)\n- src/executor/mod.rs (apply IFS splitting in command substitution)\n- tests/ifs_tests.rs (add comprehensive tests)\n\n## Estimated Effort\n50-60k tokens (complex splitting logic, many edge cases, add tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:53:27.612832-08:00","created_by":"Asher","updated_at":"2026-01-25T01:58:21.404867-08:00","closed_at":"2026-01-25T01:58:21.404867-08:00","close_reason":"Closed","labels":["critical","ifs","parser","posix","quoting"],"dependencies":[{"issue_id":"rush-dgr.21","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:53:27.61386-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.22","title":"POSIX-021: Implement process groups","description":"Implement proper process group management for job control.\n\n## Context\nPOSIX requires jobs to be in their own process groups for proper terminal control. Currently not fully implemented.\n\n## Acceptance Criteria\n- Call setpgid() for each job (background and foreground)\n- Put each job in its own process group\n- Put shell in its own process group at startup\n- Test process group isolation\n- Test signals sent to process group (not just process)\n- Test job continues when shell exits (for background jobs)\n- Verify with process inspection tools (ps, pgrep)\n- Add integration tests\n- Document process group behavior\n\n## POSIX Requirements\n- Each job runs in its own process group\n- Shell is in its own process group\n- Background jobs have PGID = leader PID\n- Foreground job receives terminal signals (SIGINT, SIGQUIT)\n- Background jobs don't receive terminal signals\n\n## Files to Modify\n- src/executor/mod.rs (call setpgid when spawning commands)\n- src/jobs/mod.rs (track process group IDs)\n- libc or nix crate for setpgid syscall\n- tests/process_group_tests.rs (add tests)\n\n## Estimated Effort\n45-55k tokens (implement syscalls, test isolation, add tests)","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:53:29.378925-08:00","created_by":"Asher","updated_at":"2026-01-25T01:58:21.408808-08:00","closed_at":"2026-01-25T01:58:21.408808-08:00","close_reason":"Closed","labels":["important","job-control","posix","processes","terminal"],"dependencies":[{"issue_id":"rush-dgr.22","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:53:29.379952-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.23","title":"POSIX-022: Implement terminal control","description":"Implement terminal foreground process group control.\n\n## Context\nPOSIX requires foreground jobs to control the terminal. Use tcsetpgrp() to manage terminal control.\n\n## Acceptance Criteria\n- Implement tcsetpgrp() to give terminal to foreground job\n- Return terminal control to shell when job finishes\n- Test foreground job receives SIGINT from Ctrl+C\n- Test background job doesn't receive SIGINT\n- Test fg command gives terminal to job\n- Test terminal state is restored after job exits\n- Handle SIGTTIN/SIGTTOU for background jobs accessing terminal\n- Add integration tests\n- Document terminal control\n\n## POSIX Requirements\n- Foreground job has control of terminal\n- tcsetpgrp() sets foreground process group\n- Background jobs that access terminal get SIGTTIN/SIGTTOU\n- Shell regains terminal control when foreground job finishes\n\n## Files to Modify\n- src/executor/mod.rs (call tcsetpgrp for foreground jobs)\n- src/jobs/mod.rs (restore terminal to shell after job)\n- src/builtins/jobs.rs (fg command gives terminal to job)\n- libc or nix crate for tcsetpgrp syscall\n- tests/terminal_control_tests.rs (add tests)\n\n## Estimated Effort\n50-60k tokens (implement terminal management, signal handling, add tests)","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:53:31.361464-08:00","created_by":"Asher","updated_at":"2026-01-24T23:58:48.937883-08:00","closed_at":"2026-01-24T23:58:48.937883-08:00","close_reason":"Closed","labels":["important","job-control","posix","terminal"],"dependencies":[{"issue_id":"rush-dgr.23","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:53:31.362599-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.24","title":"POSIX-023: Implement SIGCHLD handler","description":"Implement SIGCHLD signal handler for automatic zombie process reaping.\n\n## Context\nWhen background jobs exit, they become zombies until wait() is called. SIGCHLD handler allows async reaping.\n\n## Acceptance Criteria\n- Install SIGCHLD signal handler\n- Handler calls waitpid(-1, WNOHANG) to reap zombies\n- Update job status asynchronously (Running → Done/Terminated)\n- Test background job exit is detected automatically\n- Test zombie processes are reaped\n- Test job status updates without explicit wait\n- Ensure thread-safety of job status updates\n- Add integration tests\n- Document SIGCHLD handling\n\n## POSIX Requirements\n- SIGCHLD sent when child process exits or stops\n- Shell should reap zombie processes\n- Job status should update automatically\n- wait builtin can still be used to wait explicitly\n\n## Files to Modify\n- src/signal.rs (add SIGCHLD handler)\n- src/jobs/mod.rs (update job status from signal handler)\n- Ensure atomic/thread-safe job status updates\n- tests/sigchld_tests.rs (add tests)\n\n## Estimated Effort\n50-60k tokens (implement signal handler, thread-safe updates, add tests)","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:53:58.872998-08:00","created_by":"Asher","updated_at":"2026-01-25T01:58:21.412647-08:00","closed_at":"2026-01-25T01:58:21.412647-08:00","close_reason":"Closed","labels":["important","posix","processes","signals"],"dependencies":[{"issue_id":"rush-dgr.24","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:53:58.874039-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.25","title":"POSIX-024: Implement terminal signals","description":"Implement handling for terminal stop signals (SIGTSTP, SIGTTIN, SIGTTOU).\n\n## Context\nBackground jobs that try to read/write terminal should stop. Need proper handling of terminal signals.\n\n## Acceptance Criteria\n- Implement SIGTSTP handler (Ctrl+Z stops foreground job)\n- Implement SIGTTIN handling (background read from terminal)\n- Implement SIGTTOU handling (background write to terminal)\n- Test Ctrl+Z stops foreground job and returns to shell\n- Test fg resumes stopped job\n- Test bg resumes stopped job in background\n- Test background job stops on terminal access\n- Job status shows \"Stopped\" for stopped jobs\n- Add integration tests\n- Document signal handling\n\n## POSIX Requirements\n- SIGTSTP: stops foreground job (Ctrl+Z)\n- SIGTTIN: sent to background job reading from terminal\n- SIGTTOU: sent to background job writing to terminal (if tostop set)\n- Stopped jobs can be resumed with fg/bg\n- Job status reflects stopped state\n\n## Files to Modify\n- src/signal.rs (add SIGTSTP, SIGTTIN, SIGTTOU handlers)\n- src/jobs/mod.rs (mark jobs as stopped, resume them)\n- src/builtins/jobs.rs (show \"Stopped\" status)\n- tests/terminal_signal_tests.rs (add tests)\n\n## Estimated Effort\n45-55k tokens (implement signal handlers, job state management, add tests)","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:54:00.963607-08:00","created_by":"Asher","updated_at":"2026-01-25T01:58:21.416184-08:00","closed_at":"2026-01-25T01:58:21.416184-08:00","close_reason":"Closed","labels":["important","posix","signals","terminal"],"dependencies":[{"issue_id":"rush-dgr.25","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:54:00.964624-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.26","title":"POSIX-025: Implement full job specifications","description":"Implement full POSIX job specification parsing (%1, %+, %-, %?string, %%).\n\n## Context\nRuntime has basic job support but not full job spec parsing. Need complete implementation.\n\n## Acceptance Criteria\n- Parse %1, %2, etc. (job by number)\n- Parse %+ or %% (current job)\n- Parse %- (previous job)\n- Parse %?string (job containing 'string' in command)\n- Parse %string (job starting with 'string')\n- Test kill %1, fg %+, bg %-\n- Test ambiguous matches error gracefully\n- Test invalid job specs error with helpful message\n- Update fg, bg, kill, wait to accept job specs\n- Add integration tests\n- Document job specs\n\n## POSIX Requirements\n- %n: job number n\n- %+, %%: current job\n- %-: previous job\n- %?string: job containing string\n- %string: job starting with string\n- Error if job spec doesn't match or is ambiguous\n\n## Files to Modify\n- src/jobs/mod.rs (add parse_job_spec function)\n- src/builtins/jobs.rs (use job specs in fg, bg)\n- src/builtins/kill.rs (use job specs)\n- src/builtins/wait.rs (use job specs)\n- tests/job_spec_tests.rs (add tests)\n\n## Estimated Effort\n45-55k tokens (implement parsing, update builtins, add tests)","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:54:02.579354-08:00","created_by":"Asher","updated_at":"2026-01-25T01:58:21.419823-08:00","closed_at":"2026-01-25T01:58:21.419823-08:00","close_reason":"Closed","labels":["important","job-control","posix"],"dependencies":[{"issue_id":"rush-dgr.26","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:54:02.580227-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.27","title":"POSIX-026: Implement arbitrary FD redirection","description":"Implement arbitrary file descriptor redirection (N\u003e\u0026M, N\u003c\u0026M, N\u003e\u0026-, etc.).\n\n## Context\nCurrently only supports standard redirections (\u003e, \u003e\u003e, \u003c, 2\u003e). Need full FD manipulation.\n\n## Acceptance Criteria\n- Implement N\u003efile (redirect FD N to file)\n- Implement N\u003cfile (redirect FD N from file)\n- Implement N\u003e\u0026M (duplicate FD M to N)\n- Implement N\u003c\u0026M (duplicate FD M to N for reading)\n- Implement N\u003e\u0026- (close FD N)\n- Add FD table to Runtime to track open descriptors\n- Test exec 3\u003efile; echo hello \u003e\u00263; exec 3\u003e\u0026-\n- Test swapping stdout/stderr: 3\u003e\u00261 1\u003e\u00262 2\u003e\u00263\n- Test FD inheritance in subshells\n- Add integration tests\n- Document FD redirection\n\n## POSIX Requirements\n- N can be any digit (usually 0-9, but higher allowed)\n- N\u003e\u0026M duplicates file descriptor\n- N\u003e\u0026- closes file descriptor\n- exec with redirections makes them permanent\n- FDs inherit to child processes\n\n## Files to Modify\n- src/parser.rs (parse N\u003e\u0026M syntax)\n- src/ast.rs (add FD info to Redirect node)\n- src/runtime/mod.rs (add FD table)\n- src/executor/mod.rs (handle arbitrary FD redirections)\n- tests/fd_redirection_tests.rs (add tests)\n\n## Estimated Effort\n55-60k tokens (complex FD management, parsing, add tests)","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:54:33.991179-08:00","created_by":"Asher","updated_at":"2026-01-25T01:58:21.424046-08:00","closed_at":"2026-01-25T01:58:21.424046-08:00","close_reason":"Closed","labels":["fd","important","io","posix","redirection"],"dependencies":[{"issue_id":"rush-dgr.27","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:54:33.99493-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.28","title":"POSIX-027: Implement standard shell variables","description":"Implement standard shell variables (SHELL, PWD, OLDPWD, PPID, SHLVL).\n\n## Context\nPOSIX shells set certain standard variables. Rush should too.\n\n## Acceptance Criteria\n- Set SHELL to path of rush executable\n- Set PWD automatically when cd changes directory\n- Set OLDPWD to previous directory (for cd -)\n- Set PPID to parent process ID\n- Set SHLVL and increment when spawning subshells\n- Implement cd - (go to OLDPWD)\n- Test OLDPWD tracks previous directory\n- Test SHLVL increments in subshells\n- Test PWD stays in sync with actual directory\n- Add integration tests\n- Document variables\n\n## POSIX Requirements\n- SHELL: pathname of the shell\n- PWD: current working directory\n- OLDPWD: previous working directory\n- PPID: parent process ID (readonly)\n- SHLVL: shell nesting level (not POSIX but common)\n\n## Files to Modify\n- src/main.rs (set SHELL, PPID, SHLVL on startup)\n- src/builtins/mod.rs builtin_cd (update PWD, OLDPWD)\n- src/runtime/mod.rs (track these variables)\n- tests/shell_variables_tests.rs (add tests)\n\n## Estimated Effort\n35-45k tokens (implement variable tracking, cd - support, add tests)","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:54:35.905924-08:00","created_by":"Asher","updated_at":"2026-01-25T01:58:21.428123-08:00","closed_at":"2026-01-25T01:58:21.428123-08:00","close_reason":"Closed","labels":["important","posix","shell-vars","variables"],"dependencies":[{"issue_id":"rush-dgr.28","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:54:35.907066-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.29","title":"POSIX-028: Audit and test quoting behavior","description":"Comprehensive audit and testing of shell quoting and escaping behavior.\n\n## Context\nQuoting is complex and critical. Need thorough testing to ensure POSIX compliance.\n\n## Acceptance Criteria\n- Test single quotes (no expansion): 'literal $VAR' → literal $VAR\n- Test double quotes (expansion): \"expanded $VAR\" → value\n- Test escape in double quotes: \"preserve \\$VAR\" → preserve $VAR\n- Test backslash escapes: \\\\, \\\", \\$, \\`, \\\\n (depends on context)\n- Test quote nesting: \"outer 'inner' outer\", 'outer \"inner\" outer'\n- Test command substitution in quotes: \"$(cmd)\"\n- Test glob expansion blocked by quotes: \"*.txt\" doesn't expand\n- Test whitespace preservation: \"a  b\" keeps double space\n- Test empty strings: \"\", '', \"\"\n- Identify and fix any quoting bugs\n- Add comprehensive integration tests\n- Document quoting rules\n\n## POSIX Requirements\n- Single quotes: preserve literal value of each character\n- Double quotes: preserve literal value except $, `, \\, and newline\n- Backslash: escape next character (context-dependent)\n- No quote nesting of same type\n\n## Files to Audit/Modify\n- src/lexer.rs (verify quote handling)\n- src/parser.rs (verify quote parsing)\n- src/executor/mod.rs (verify expansion respects quotes)\n- tests/quoting_tests.rs (comprehensive tests)\n\n## Estimated Effort\n45-55k tokens (comprehensive testing, fix edge cases, document)","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:54:36.45036-08:00","created_by":"Asher","updated_at":"2026-01-24T23:58:48.939993-08:00","closed_at":"2026-01-24T23:58:48.939993-08:00","close_reason":"Closed","labels":["important","parser","posix","quoting","testing"],"dependencies":[{"issue_id":"rush-dgr.29","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:54:36.451247-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.3","title":"POSIX-003: Re-enable and test shift builtin","description":"Re-enable the `shift` builtin for shifting positional parameters.\n\n## Context\nThe `shift` builtin exists at `src/builtins/shift.rs` but is commented out. Essential for processing script arguments.\n\n## Acceptance Criteria\n- Uncomment `shift` module in src/builtins/mod.rs\n- Uncomment shift builtin registration\n- Test basic shift: shifts $2→$1, $3→$2, etc.\n- Test shift N (shift by N positions)\n- Test shift with no positional params (should error)\n- Test shift beyond available params (should error)\n- Test $# is decremented correctly\n- Test shift in functions vs global scope\n- Add integration tests\n- Update help text\n\n## POSIX Requirements\n- Shift positional parameters to the left by N (default 1)\n- $1 is deleted, $2 becomes $1, etc.\n- $# is decremented by N\n- Exit code 0 on success, \u003e0 if N \u003e $#\n\n## Files to Modify\n- src/builtins/mod.rs (uncomment)\n- src/builtins/shift.rs (verify implementation)\n- src/runtime/mod.rs (verify positional_params handling)\n- tests/positional_param_tests.rs or similar (add tests)\n\n## Estimated Effort\n30-40k tokens (re-enable, test, fix issues)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:39:27.029606-08:00","created_by":"Asher","updated_at":"2026-01-24T11:45:01.789709-08:00","closed_at":"2026-01-24T11:45:01.789709-08:00","close_reason":"Completed by agent","labels":["builtin","critical","parameters","posix"],"dependencies":[{"issue_id":"rush-dgr.3","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:39:27.030609-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.30","title":"POSIX-029: POSIX test suite integration","description":"Set up and run POSIX shell test suite to validate compliance.\n\n## Context\nAfter implementing all POSIX features, validate with official test suite or comprehensive script tests.\n\n## Acceptance Criteria\n- Research available POSIX shell test suites (bash test suite, dash tests, etc.)\n- Set up chosen test suite to run against rush\n- Run test suite and document results\n- Categorize failures (critical vs nice-to-have)\n- Fix critical failures\n- Document known limitations/non-POSIX extensions\n- Achieve 90%+ pass rate on core POSIX features\n- Add regression tests for fixed bugs\n- Create compliance report\n\n## Test Areas\n- Builtin commands (all required POSIX builtins)\n- Control flow (if, while, until, case, for)\n- Positional parameters and special variables\n- I/O redirection (all forms)\n- Pipelines and command lists\n- Quoting and escaping\n- Job control\n- Signal handling\n- Variable expansion\n- Here-documents\n- Functions\n\n## Deliverables\n- Test suite setup documentation\n- Test results report\n- Compliance percentage\n- Known issues list\n- Regression test additions\n\n## Estimated Effort\n55-60k tokens (setup tests, run, analyze, fix issues, document)","status":"closed","priority":3,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:54:53.698111-08:00","created_by":"Asher","updated_at":"2026-01-25T01:58:21.43192-08:00","closed_at":"2026-01-25T01:58:21.43192-08:00","close_reason":"Closed","labels":["compliance","posix","testing","validation"],"dependencies":[{"issue_id":"rush-dgr.30","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:54:53.699266-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.4","title":"POSIX-004: Re-enable and test local builtin","description":"Re-enable the `local` builtin for creating function-local variables.\n\n## Context\nThe `local` builtin exists at `src/builtins/local.rs` but is commented out. Essential for proper variable scoping in functions.\n\n## Acceptance Criteria\n- Uncomment `local` module in src/builtins/mod.rs\n- Uncomment local builtin registration\n- Test basic local var: `fn foo() { local x=5; echo $x }` → 5\n- Test local shadows global: `x=10; fn foo() { local x=5; echo $x }; foo` → 5, then `echo $x` → 10\n- Test local only works in functions (should error outside functions)\n- Test multiple variables: `local a=1 b=2 c=3`\n- Test local without assignment: `local x` (declares but doesn't assign)\n- Verify scope cleanup when function exits\n- Add integration tests\n- Update help text\n\n## POSIX Requirements (Note: `local` is not POSIX, but common in bash/zsh)\n- Create variables local to function scope\n- Shadow global variables without affecting them\n- Variables disappear when function exits\n- Error if called outside function\n\n## Files to Modify\n- src/builtins/mod.rs (uncomment)\n- src/builtins/local.rs (verify implementation)\n- src/runtime/mod.rs (verify scope stack handling)\n- tests/function_tests.rs (add tests)\n\n## Estimated Effort\n35-45k tokens (re-enable, verify scoping, add tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:50:33.370965-08:00","created_by":"Asher","updated_at":"2026-01-24T11:49:14.86456-08:00","closed_at":"2026-01-24T11:49:14.86456-08:00","close_reason":"Completed by agent","labels":["builtin","critical","functions","posix","scoping"],"dependencies":[{"issue_id":"rush-dgr.4","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:50:33.372269-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.5","title":"POSIX-005: Re-enable and test trap builtin","description":"Re-enable the `trap` builtin for catching signals and executing commands.\n\n## Context\nThe `trap` builtin exists at `src/builtins/trap.rs` but is commented out. Critical for signal handling and cleanup operations.\n\n## Acceptance Criteria\n- Uncomment `trap` module in src/builtins/mod.rs (make public)\n- Uncomment trap builtin registration\n- Test basic trap: `trap 'echo caught' INT`, then send SIGINT\n- Test trap EXIT (runs on shell exit)\n- Test trap - SIGNAL (reset to default)\n- Test trap '' SIGNAL (ignore signal)\n- Test trap with no args (list current traps)\n- Test trap with multiple signals: `trap 'echo bye' EXIT TERM HUP`\n- Verify TrapSignal integration with executor\n- Add integration tests for common signals (INT, TERM, HUP, EXIT)\n- Update help text\n\n## POSIX Requirements\n- Execute command when shell receives signal\n- Supports signal names (INT, TERM) and numbers (2, 15)\n- Special signal EXIT (runs on shell exit)\n- `trap - SIGNAL` resets to default\n- `trap '' SIGNAL` ignores signal\n- `trap` with no args lists traps\n\n## Files to Modify\n- src/builtins/mod.rs (uncomment, make public)\n- src/builtins/trap.rs (verify implementation)\n- src/runtime/mod.rs (verify trap handling)\n- src/executor/mod.rs (verify TrapSignal integration)\n- tests/signal_handling_tests.rs (add tests)\n\n## Estimated Effort\n45-55k tokens (re-enable, verify signal integration, add tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:50:35.040681-08:00","created_by":"Asher","updated_at":"2026-01-24T11:54:53.473149-08:00","closed_at":"2026-01-24T11:54:53.473149-08:00","close_reason":"Completed by agent","labels":["builtin","critical","posix","signals"],"dependencies":[{"issue_id":"rush-dgr.5","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:50:35.041602-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.6","title":"POSIX-006: Re-enable and test eval builtin","description":"Re-enable the `eval` builtin for evaluating strings as shell commands.\n\n## Context\nThe `eval` builtin exists at `src/builtins/eval.rs` but is commented out. Powerful for dynamic command construction.\n\n## Acceptance Criteria\n- Uncomment `eval` module in src/builtins/mod.rs\n- Uncomment eval builtin registration\n- Test basic eval: `eval \"echo hello\"` → hello\n- Test variable expansion: `cmd=\"echo hello\"; eval $cmd` → hello\n- Test command substitution: `eval \"x=\\$(echo 5); echo \\$x\"` → 5\n- Test multiple statements: `eval \"x=5; y=10; echo \\$((x + y))\"` → 15\n- Test proper exit code propagation\n- Test error handling for invalid commands\n- Add integration tests\n- Update help text\n\n## POSIX Requirements\n- Concatenate arguments into single string\n- Parse and execute the string as shell commands\n- Return exit code of last executed command\n- Variables expanded twice (once by shell, once by eval)\n\n## Files to Modify\n- src/builtins/mod.rs (uncomment)\n- src/builtins/eval.rs (verify implementation)\n- src/executor/mod.rs (verify eval integration with parser)\n- tests/eval_tests.rs or similar (add tests)\n\n## Estimated Effort\n40-50k tokens (re-enable, test edge cases, add tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:50:35.566835-08:00","created_by":"Asher","updated_at":"2026-01-24T12:01:38.086715-08:00","closed_at":"2026-01-24T12:01:38.086715-08:00","close_reason":"Completed by agent","labels":["builtin","critical","execution","posix"],"dependencies":[{"issue_id":"rush-dgr.6","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:50:35.567866-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.7","title":"POSIX-007: Re-enable and test exec builtin","description":"Re-enable the `exec` builtin for replacing the shell process with another command.\n\n## Context\nThe `exec` builtin exists at `src/builtins/exec.rs` but is commented out. Used for shell replacement and permanent redirections.\n\n## Acceptance Criteria\n- Uncomment `exec` module in src/builtins/mod.rs\n- Uncomment exec builtin registration\n- Test basic exec: `exec echo hello` (replaces shell, prints hello, shell exits)\n- Test exec with redirections: `exec 3\u003e file.txt` (permanent FD redirection)\n- Test exec closing FDs: `exec 3\u003e\u0026-` (close FD 3)\n- Test exec failure (command not found) doesn't exit shell\n- Test exec with environment: `exec env FOO=bar printenv FOO`\n- Verify process replacement works correctly\n- Add integration tests\n- Update help text\n\n## POSIX Requirements\n- Replace current shell with specified command\n- If command succeeds, shell doesn't continue\n- If command fails to execute, shell may exit (varies by shell)\n- With redirections but no command, perform permanent redirections\n- Exit code: command's exit code, or error code if exec fails\n\n## Files to Modify\n- src/builtins/mod.rs (uncomment)\n- src/builtins/exec.rs (verify implementation)\n- src/executor/mod.rs (verify exec integration)\n- tests/exec_tests.rs or similar (add tests)\n\n## Estimated Effort\n40-50k tokens (re-enable, test process replacement, add tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:51:02.955756-08:00","created_by":"Asher","updated_at":"2026-01-24T12:05:41.379666-08:00","closed_at":"2026-01-24T12:05:41.379666-08:00","close_reason":"Completed by agent","labels":["builtin","critical","execution","posix","processes"],"dependencies":[{"issue_id":"rush-dgr.7","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:51:02.956695-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.8","title":"POSIX-008: Re-enable and test kill builtin","description":"Re-enable the `kill` builtin for sending signals to processes.\n\n## Context\nThe `kill` builtin exists at `src/builtins/kill.rs` but is commented out. Essential for process management and job control.\n\n## Acceptance Criteria\n- Uncomment `kill` module in src/builtins/mod.rs\n- Uncomment kill builtin registration\n- Test basic kill: `kill PID` (sends SIGTERM)\n- Test specific signal: `kill -9 PID`, `kill -KILL PID`\n- Test signal names: `kill -INT PID`, `kill -TERM PID`\n- Test signal numbers: `kill -2 PID`, `kill -15 PID`\n- Test job specs: `kill %1`, `kill %+`, `kill %-`\n- Test kill -l (list available signals)\n- Test error handling (invalid PID, permission denied)\n- Add integration tests\n- Update help text\n\n## POSIX Requirements\n- Send signal to process(es)\n- Default signal is TERM (15)\n- Accept signal by name (-TERM) or number (-15)\n- Accept job specifications (%1, %+, etc.)\n- `kill -l` lists signal names\n- Exit code 0 on success, \u003e0 on error\n\n## Files to Modify\n- src/builtins/mod.rs (uncomment)\n- src/builtins/kill.rs (verify implementation)\n- src/jobs/mod.rs (verify job spec integration)\n- tests/signal_tests.rs or similar (add tests)\n\n## Estimated Effort\n35-45k tokens (re-enable, test signals, add tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:51:05.092437-08:00","created_by":"Asher","updated_at":"2026-01-24T12:08:58.278352-08:00","closed_at":"2026-01-24T12:08:58.278352-08:00","close_reason":"Completed by agent","labels":["builtin","critical","posix","processes","signals"],"dependencies":[{"issue_id":"rush-dgr.8","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:51:05.093337-08:00","created_by":"Asher"}]}
{"id":"rush-dgr.9","title":"POSIX-009: Implement break builtin","description":"Implement the `break` builtin for exiting from loops (for, while, until).\n\n## Context\nCurrently missing. Essential for loop control flow.\n\n## Acceptance Criteria\n- Create src/builtins/break.rs\n- Implement break builtin\n- Register in src/builtins/mod.rs\n- Test basic break: exits innermost loop\n- Test break N: exits N levels of nested loops\n- Test break outside loop (should error)\n- Test break with invalid N (should error)\n- Define BreakSignal similar to ReturnSignal\n- Ensure executor catches BreakSignal\n- Add integration tests\n- Update help text\n\n## POSIX Requirements\n- Exit from for, while, or until loop\n- `break [n]` exits n enclosing loops (default 1)\n- Error if n \u003e number of enclosing loops\n- Error if called outside loop\n- Exit code 0 on success, \u003e0 on error\n\n## Files to Create/Modify\n- src/builtins/break.rs (new file)\n- src/builtins/mod.rs (register builtin, export BreakSignal if needed)\n- src/executor/mod.rs (handle BreakSignal in loops)\n- tests/loop_control_tests.rs (add tests)\n\n## Estimated Effort\n40-50k tokens (implement from scratch, add signal handling, add tests)","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-24T10:51:06.891124-08:00","created_by":"Asher","updated_at":"2026-01-24T12:19:31.854453-08:00","closed_at":"2026-01-24T12:19:31.854453-08:00","close_reason":"Completed by agent","labels":["builtin","control-flow","critical","loops","posix"],"dependencies":[{"issue_id":"rush-dgr.9","depends_on_id":"rush-dgr","type":"parent-child","created_at":"2026-01-24T10:51:06.892158-08:00","created_by":"Asher"}]}
{"id":"rush-doc1","title":"User Guide - Common Tasks","description":"Create practical user guide for everyday Rush usage.\n\n## Purpose\nHelp users accomplish common tasks without reading source code.\n\n## Contents\n1. **Basic Navigation**\n   - cd, pwd, changing directories\n   - Working with paths and ~\n   - Directory history\n\n2. **File Operations**\n   - Viewing files (cat)\n   - Searching (grep, find)\n   - Listing (ls with common flags)\n   - File patterns and globs\n\n3. **Pipelines \u0026 Redirection**\n   - Connecting commands with |\n   - Redirecting output (\u003e, \u003e\u003e, 2\u003e, \u0026\u003e)\n   - Command substitution $()\n   - Here documents\n\n4. **Variables**\n   - Setting: export FOO=bar\n   - Using: $FOO, ${FOO}\n   - Expansion: ${VAR:-default}\n   - Special variables: $?, $HOME, etc.\n\n5. **Job Control**\n   - Background jobs (\u0026)\n   - Listing jobs\n   - Bringing to foreground (fg)\n   - Stopping jobs\n\n## Format\n- Clear examples for each task\n- Show both command and output\n- Include common pitfalls\n- Link to related topics\n\n## Deliverable\ndocs/USER_GUIDE.md","status":"open","priority":2,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-20T18:00:00-08:00","created_by":"Asher","updated_at":"2026-01-20T18:00:00-08:00","labels":["documentation","phase4","user-guide"]}
{"id":"rush-doc2","title":"Configuration Guide","description":"Document how to configure Rush for daily use.\n\n## Purpose\nShow users how to customize Rush to match their workflow.\n\n## Contents\n1. **Initialization Files**\n   - ~/.rush_profile (login shells)\n   - ~/.rushrc (interactive shells)\n   - When each is loaded\n   - Execution order\n\n2. **Common Configurations**\n   - Setting up aliases\n   - Customizing prompt\n   - Setting environment variables\n   - Defining functions\n   - History settings\n\n3. **Shell Options**\n   - set -e (exit on error)\n   - set -u (error on undefined)\n   - set -x (debug mode)\n   - set -o pipefail\n\n4. **Integrations**\n   - Git setup\n   - Cargo/Rust integration\n   - Node/npm setup\n   - Custom completions\n\n5. **Examples**\n   - Minimal .rushrc\n   - Power user .rushrc\n   - Team shared .rushrc\n   - Migration from .bashrc/.zshrc\n\n## Format\n- Working example configs\n- Explain each section\n- Show before/after\n- Include comments in examples\n\n## Deliverable\ndocs/CONFIGURATION.md\nExamples in examples/.rushrc.{minimal,power,team}","status":"open","priority":2,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-20T18:00:00-08:00","created_by":"Asher","updated_at":"2026-01-20T18:00:00-08:00","labels":["configuration","documentation","phase4"]}
{"id":"rush-doc3","title":"Builtin Command Reference","description":"Complete reference for all Rush builtins.\n\n## Purpose\nProvide quick lookup for builtin commands and flags.\n\n## Contents\nFor each builtin:\n- Name and purpose\n- Syntax\n- Flags and options\n- Examples (basic and advanced)\n- Exit codes\n- See also (related commands)\n\n## Builtins to Document\n- cd, pwd, echo, exit, export\n- cat, ls, grep, find\n- git-status\n- jobs, fg, bg\n- alias, unalias\n- history\n- set\n- undo\n- help\n- type\n- test/[\n- mkdir\n\n## Format\nMarkdown with:\n- Synopsis section\n- Description\n- Options table\n- Examples section\n- Notes/caveats\n- Performance notes (vs GNU)\n\n## Deliverable\ndocs/BUILTINS.md\n\n## Stretch\nGenerate from --help flags in code","status":"open","priority":3,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-20T18:00:00-08:00","created_by":"Asher","updated_at":"2026-01-20T18:00:00-08:00","labels":["documentation","phase4","reference"]}
{"id":"rush-doc4","title":"Troubleshooting Guide","description":"Help users debug common issues.\n\n## Purpose\nGet users unstuck when things go wrong.\n\n## Contents\n1. **Common Errors**\n   - Command not found\n   - Permission denied\n   - Syntax errors\n   - Broken pipe\n   - Exit code meanings\n\n2. **Performance Issues**\n   - Shell feels slow\n   - Commands hanging\n   - High memory usage\n   - How to identify bottleneck\n\n3. **Compatibility Issues**\n   - Bash script doesn't work\n   - External tool behaves differently\n   - Terminal formatting issues\n   - Missing features\n\n4. **Recovery**\n   - How to exit stuck shell\n   - Kill hung processes\n   - Reset corrupted history\n   - Restore from undo backups\n\n5. **Getting Help**\n   - Reading error messages\n   - Enabling debug mode\n   - Filing bug reports\n   - Where to ask questions\n\n## Format\n- Problem/Solution pairs\n- Clear diagnostic steps\n- Copy-pasteable commands\n- Links to related docs\n\n## Deliverable\ndocs/TROUBLESHOOTING.md","status":"open","priority":3,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-20T18:00:00-08:00","created_by":"Asher","updated_at":"2026-01-20T18:00:00-08:00","labels":["documentation","phase4","troubleshooting"]}
{"id":"rush-doc5","title":"Migration Guide from Bash/Zsh","description":"Help users transition from their current shell.\n\n## Purpose\nMake switching to Rush less scary and more successful.\n\n## Contents\n1. **What's Different**\n   - Syntax differences\n   - Missing features (and workarounds)\n   - New capabilities (undo, speed)\n   - Breaking changes from bash\n\n2. **Quick Start for Bash Users**\n   - 80% compatible commands\n   - What just works\n   - What needs adjustment\n   - Common gotchas\n\n3. **Quick Start for Zsh Users**\n   - Notable differences\n   - Plugin equivalents\n   - Oh-My-Zsh migration\n   - Theme alternatives\n\n4. **Porting Scripts**\n   - Testing compatibility\n   - Common rewrites needed\n   - When to stay with bash\n   - Dual-shell strategy\n\n5. **Porting Configs**\n   - .bashrc → .rushrc\n   - .zshrc → .rushrc\n   - Aliases\n   - Functions\n   - Environment variables\n\n## Format\n- Side-by-side examples\n- Before (bash) / After (rush)\n- Compatibility matrix\n- Migration checklist\n\n## Deliverable\ndocs/MIGRATION.md\nScript: scripts/migrate-bashrc.sh","status":"open","priority":2,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-20T18:00:00-08:00","created_by":"Asher","updated_at":"2026-01-20T18:00:00-08:00","labels":["documentation","migration","phase4"]}
{"id":"rush-ey2","title":"Add -c flag for non-interactive command execution","description":"Rush currently only supports interactive mode. Add support for 'rush -c \"command\"' to run single commands non-interactively, similar to bash -c. This is needed for scripting and benchmarking.","status":"closed","priority":2,"issue_type":"feature","owner":"a@kf.cafe","created_at":"2026-01-20T03:02:49.131579-08:00","created_by":"Asher","updated_at":"2026-01-20T03:14:54.280054-08:00","closed_at":"2026-01-20T03:14:54.280054-08:00","close_reason":"Implemented -c flag for non-interactive command execution. Works perfectly. Benchmarks show ~5ms startup overhead per invocation, which is expected. Pure builtin performance (via Criterion) shows 17-427x speedup.","labels":["enhancement","phase4"]}
{"id":"rush-h09","title":"Add AI-powered command suggestions","description":"Implement AI-powered features: 1) Command suggestions based on context, 2) Error explanation and fixes, 3) Command completion using LLM, 4) Natural language to command translation, 5) Privacy-preserving local models option","status":"open","priority":4,"issue_type":"feature","owner":"a@kf.cafe","created_at":"2026-01-20T03:03:26.644664-08:00","created_by":"Asher","updated_at":"2026-01-20T03:03:26.644664-08:00","labels":["ai","enhancement","phase5"]}
{"id":"rush-hn1","title":"Benchmark Reproducibility Suite","description":"Create a comprehensive benchmark suite that users can run locally to verify Rush's performance claims.\n\n## Problem\nThe #1 HN criticism will be \"I don't trust these 225x/427x speedup claims.\" Users need to reproduce benchmarks on their own hardware.\n\n## Success Criteria\n- User-friendly benchmark runner: `rush --benchmark`\n- Quick mode for smoke testing: `rush --benchmark quick`\n- Comparison mode: `rush --benchmark compare` (Rush vs bash/zsh)\n- Generates detailed HTML reports with charts\n- Includes all benchmarked operations (cat, ls, find, grep, startup)\n- Works on macOS and Linux\n- Documents methodology and fairness\n- Results saved to `benchmark_results.json`\n- Can export to markdown for sharing\n\n## User Stories\n1. As a skeptical developer, I want to run benchmarks locally so I can verify performance claims\n2. As a potential user, I want quick smoke tests so I can see if Rush is faster on my hardware\n3. As a contributor, I want reproducible benchmarks so I can track performance regressions\n\n## Technical Notes\n- Build on existing criterion benchmarks\n- Add hyperfine integration for real-world comparisons\n- Include warmup runs to eliminate cold start bias\n- Document test data generation (file sizes, counts)\n- Ensure fair comparison (same operations, same data)\n- Add CI integration to track performance over time\n\n## Deliverables\n- `scripts/user_benchmark.sh` - Main benchmark runner\n- `scripts/quick_benchmark.sh` - Fast smoke test\n- Markdown report generation\n- HTML visualization (using criterion's output)\n- Documentation in docs/BENCHMARKING.md","status":"open","priority":1,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-20T17:30:00-08:00","created_by":"Asher","updated_at":"2026-01-20T17:30:00-08:00","labels":["benchmarking","hn-feature","observability","phase4"]}
{"id":"rush-hn2","title":"Performance Profiling Built-in","description":"Add built-in performance profiling to show where time is spent during command execution.\n\n## Problem\nUsers criticize 4.0ms startup vs bash's 2.5ms. Turn this into a feature by showing that fast builtins compensate. Demonstrate transparency and observability.\n\n## Success Criteria\n- `rush --profile -c 'command'` shows timing breakdown\n- Profiling available as builtin: `profile { commands }`\n- Shows: startup time, parse time, execution time per command\n- Differentiates builtin vs external command performance\n- Pipeline stage timing breakdown\n- Optional: Memory usage tracking\n- Zero overhead when not profiling\n- Clean, readable output format\n\n## User Stories\n1. As a developer, I want to see where time is spent so I understand performance characteristics\n2. As a user, I want to profile my scripts so I can optimize bottlenecks\n3. As a Rush advocate, I want to show how fast builtins compensate for startup overhead\n\n## Example Output\n```\n$ rush --profile -c 'ls | grep foo'\nPerformance Profile:\n  Shell startup:    4.0ms\n  Parse:            0.2ms\n  Execute 'ls':     0.1ms (builtin, 17x faster than GNU)\n  Execute 'grep':   0.05ms (builtin, 212x faster than GNU)\n  Pipeline setup:   0.1ms\n  Total:            4.45ms\n  \nComparison: bash -c 'ls | grep foo' = 12.3ms (2.8x slower)\n```\n\n## Technical Notes\n- Use `std::time::Instant` for high-resolution timing\n- Add timing checkpoints in executor\n- Store metrics in executor state\n- Output formatter for human-readable display\n- Optional JSON output for tooling\n- Add `--profile-memory` for memory tracking (future)\n\n## Deliverables\n- `--profile` CLI flag\n- `profile` builtin command\n- Timing infrastructure in executor\n- Human-readable formatter\n- JSON output mode\n- Documentation and examples","status":"open","priority":1,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-20T17:30:00-08:00","created_by":"Asher","updated_at":"2026-01-20T17:30:00-08:00","labels":["feature","hn-feature","observability","performance","phase4"]}
{"id":"rush-hn3","title":"Rust-Quality Error Messages","description":"Implement Rust-quality error messages with context, suggestions, and visual indicators.\n\n## Problem\nShells have notoriously bad error messages. Rust sets the gold standard. Rush should match that quality to differentiate from bash/zsh.\n\n## Success Criteria\n- Error messages show context (line/column for scripts)\n- Visual indicators point to error location (^^^^^)\n- Suggestions for common mistakes (\"Did you mean...?\")\n- Help text for fixing errors\n- Color-coded severity (error, warning, info)\n- Multi-line errors with context\n- Stack traces for complex errors (pipelines, functions)\n- Friendly, educational tone\n\n## User Stories\n1. As a new user, I want clear error messages so I can fix mistakes quickly\n2. As a scripter, I want line numbers and context so I can debug scripts\n3. As a typo-prone user, I want suggestions so I don't have to look up syntax\n\n## Example Output\n```\nError: Unknown flag '--invalid-flag'\n  |\n3 | ls --invalid-flag /tmp\n  |    ^^^^^^^^^^^^^^\n  |\n  = help: Did you mean '--all' (-a)?\n  = help: Run 'ls --help' for available flags\n  \nError: Command not found: 'carg'\n  |\n  = help: Did you mean 'cargo'?\n  = note: Similar commands: cargo, cat, cd\n```\n\n## Technical Implementation\n- Create error types with context\n- Track source locations during parsing\n- Implement fuzzy matching for suggestions\n- Build error formatter with colors\n- Add help text database\n- Use `miette` or similar crate for beautiful errors\n\n## Deliverables\n- Error context tracking in parser\n- Rich error types\n- Error formatter with colors\n- Suggestion engine\n- Help text database\n- Examples in documentation","status":"open","priority":2,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-20T17:30:00-08:00","created_by":"Asher","updated_at":"2026-01-20T17:30:00-08:00","labels":["error-handling","feature","hn-feature","phase4","ux"]}
{"id":"rush-hn4","title":"Time Builtin with Breakdown","description":"Implement a `time` builtin that shows performance breakdown for commands and pipelines.\n\n## Problem\nUsers want to understand where time is spent. Standard `time` only shows total. Rush should show per-stage breakdown for pipelines.\n\n## Success Criteria\n- `time command` shows execution time\n- Pipeline breakdown: time per stage\n- Differentiates builtin vs external\n- Shows overhead (parsing, piping, etc.)\n- Optional memory usage stats\n- Comparison to bash/zsh (optional)\n- Works with complex pipelines\n- Clean, readable output\n\n## User Stories\n1. As a performance-conscious user, I want to time commands so I can optimize workflows\n2. As a Rush user, I want to see pipeline stage times so I can identify bottlenecks\n3. As a skeptic, I want proof that Rush builtins are faster\n\n## Example Output\n```\n$ time find . -name \"*.rs\" | grep pub | wc -l\n42\n\nTiming:\n  find:      0.9ms (builtin, parallel traversal)\n  grep:      0.4ms (builtin, ripgrep)\n  wc:        0.1ms (builtin)\n  pipeline:  0.2ms (overhead)\n  total:     1.6ms\n  \n  Comparison: bash time = 380ms (237x faster)\n```\n\n## Technical Implementation\n- Add `time` builtin\n- Reuse profiling infrastructure from rush-hn2\n- Track time per pipeline stage\n- Format output clearly\n- Optional: benchmark against bash/zsh inline\n\n## Deliverables\n- `time` builtin command\n- Pipeline timing breakdown\n- Output formatter\n- Integration with profiling system\n- Tests and documentation","status":"open","priority":2,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-20T17:30:00-08:00","created_by":"Asher","updated_at":"2026-01-20T17:30:00-08:00","labels":["builtin","feature","hn-feature","performance","phase4"]}
{"id":"rush-hn5","title":"Script Compatibility Checker","description":"Build a tool to check bash/zsh scripts for Rush compatibility and provide migration guidance.\n\n## Problem\nThe \"my bash scripts won't work\" concern. Need to make migration anxiety explicit with tooling that shows what's compatible and what isn't.\n\n## Success Criteria\n- `rush --check script.sh` analyzes bash scripts\n- Reports compatibility percentage\n- Lists incompatible syntax with line numbers\n- Suggests fixes or workarounds\n- Categorizes issues (supported, planned, not-supported)\n- Warns about POSIX vs bash-isms\n- Optional: Auto-migration suggestions\n- Works with .bashrc, .bash_profile, etc.\n\n## User Stories\n1. As a bash user, I want to know if my scripts will work so I can decide to adopt Rush\n2. As a migrator, I want to see what needs fixing so I can plan migration effort\n3. As a scripter, I want Rush to warn me about incompatibilities so I can adjust\n\n## Example Output\n```\n$ rush --check deploy.sh\n\nChecking: deploy.sh\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\nCompatibility: 87% (31/36 features)\n\n✓ Supported:\n  - Pipelines (lines 5, 12, 23)\n  - Redirections (lines 8, 15)\n  - Variables (lines 3, 7, 19)\n  - Functions (lines 10-14)\n  \n⚠ Warnings:\n  Line 12: Bash arrays not yet supported\n    | arr=(one two three)\n    Workaround: Use space-separated strings\n  \n✗ Not Supported:\n  Line 45: ${var:offset:length} substring syntax\n    | name=${filename:0:5}\n    Status: Planned for Phase 5\n    Workaround: Use external tool (cut/awk)\n\n💡 Suggestions:\n  - Consider using Rush-native syntax for new scripts\n  - Set POSIX mode for maximum compatibility\n  - See migration guide: rush.sh/migrate\n```\n\n## Technical Implementation\n- Parse bash syntax (use bash parser or tree-sitter)\n- Build compatibility database\n- Map bash features to Rush support status\n- Generate detailed reports\n- Track planned features for roadmap\n\n## Deliverables\n- `--check` CLI flag\n- Bash script parser/analyzer\n- Compatibility database\n- Report generator\n- Migration guide documentation\n- CI integration for script testing","status":"open","priority":2,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-20T17:30:00-08:00","created_by":"Asher","updated_at":"2026-01-20T17:30:00-08:00","labels":["feature","hn-feature","migration","phase4","tooling"]}
{"id":"rush-hn6","title":"Advanced Shell Completion System","description":"Implement a comprehensive tab completion system with context-awareness and extensibility.\n\n## Problem\nTab completion is table stakes for shell adoption. Rush needs best-in-class completion: commands, flags, files, git branches, custom completions.\n\n## Success Criteria\n- Command completion from PATH\n- Builtin flag completion (e.g., `ls --\u003cTAB\u003e`)\n- File/directory completion with filtering\n- Git-aware completion (branches, commits, remotes)\n- Custom completion functions\n- Completion scripts in `~/.rush/completions/`\n- Fuzzy matching for partial matches\n- Description hints for completions\n- Fast (\u003c100ms latency)\n- Backwards compatible with bash completions (stretch)\n\n## User Stories\n1. As a user, I want command completion so I can work efficiently\n2. As a git user, I want branch completion so I don't have to type full names\n3. As a tool author, I want to provide Rush completions so my users have a great experience\n4. As a bash migrator, I want my existing completions to work\n\n## Example Behavior\n```\n$ rush git che\u003cTAB\u003e\nchecklist  checkout\n\n$ rush git checkout \u003cTAB\u003e\nmaster       (local branch)\nmain         (local branch) \nfeature/foo  (local branch)\norigin/dev   (remote branch)\n\n$ rush ls --\u003cTAB\u003e\n--all        -a   Show hidden files\n--long       -l   Long format\n--human      -h   Human-readable sizes\n--color           Colorize output\n```\n\n## Technical Implementation\n- Already have `src/completion/` module\n- Implement `Completer` trait fully\n- Add context-aware completion logic\n- Git completion using git2 crate\n- File completion with filtering\n- Custom completion script loader\n- Cache frequently used completions\n- Integration with reedline's completion system\n\n## Deliverables\n- Complete `Completer` implementation\n- Context-aware completion engine\n- Git completion support\n- Flag/option completion for builtins\n- Custom completion script system\n- Documentation and examples\n- Completion installation for popular tools","status":"open","priority":3,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-20T17:30:00-08:00","created_by":"Asher","updated_at":"2026-01-20T17:30:00-08:00","labels":["completion","feature","hn-feature","phase4","ux"]}
{"id":"rush-hz3","title":"Implement job control (background jobs)","description":"Add support for background job execution and control: 1) Background operator (\u0026), 2) Job control commands (jobs, fg, bg), 3) Job status tracking, 4) Signal handling (Ctrl+Z), 5) Process group management","status":"open","priority":2,"issue_type":"feature","owner":"a@kf.cafe","created_at":"2026-01-20T03:02:58.644278-08:00","created_by":"Asher","updated_at":"2026-01-20T03:02:58.644278-08:00","labels":["enhancement","phase4"]}
{"id":"rush-j1d","title":"Add shell script execution support","description":"Rush needs to be able to execute .sh script files. Currently only supports interactive mode. This should include: 1) Shebang support (#!/usr/bin/env rush), 2) Script file argument (rush script.sh), 3) Script arguments (, , etc.), 4) Exit code handling","status":"open","priority":2,"issue_type":"feature","owner":"a@kf.cafe","created_at":"2026-01-20T03:02:54.035224-08:00","created_by":"Asher","updated_at":"2026-01-20T03:02:54.035224-08:00","labels":["enhancement","phase4"]}
{"id":"rush-j6k.3","title":"US-001: Script Execution","description":"As a developer, I want to execute Rush shell scripts from files so that I can automate tasks and run saved scripts.\n\n## Acceptance Criteria\n- [ ] Can execute .rush files: `rush script.rush`\n- [ ] Shebang support: `#!/usr/bin/env rush`\n- [ ] Script arguments accessible via $1, $2, etc.\n- [ ] Exit codes propagate correctly\n- [ ] Error messages show script name and line number\n- [ ] Scripts can source other scripts\n- [ ] cargo test passes (all tests including new script execution tests)\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n- [ ] Manual testing: run sample scripts with various features\n\n## Technical Notes\n- Modify src/executor/mod.rs to accept file input\n- Add script argument parsing\n- Implement file reading and execution loop\n- Add line number tracking for errors","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T03:18:02.84824-08:00","created_by":"Asher","updated_at":"2026-01-20T03:51:05.069135-08:00","closed_at":"2026-01-20T03:51:05.069135-08:00","close_reason":"Closed","labels":["1.0","backend","critical","rush"]}
{"id":"rush-knj","title":"Fix test flakiness in parallel undo tests","description":"The test_track_and_undo_modify test fails in parallel execution mode due to shared ~/.rush_undo directory causing race conditions. Fix by: 1) Using unique test directories per test, 2) Ensuring proper cleanup, 3) Using test isolation","status":"closed","priority":1,"issue_type":"bug","owner":"a@kf.cafe","created_at":"2026-01-20T03:03:18.170767-08:00","created_by":"Asher","updated_at":"2026-01-20T03:47:27.540649-08:00","closed_at":"2026-01-20T03:47:27.540649-08:00","close_reason":"Closed","labels":["bug","testing"]}
{"id":"rush-mv0","title":"Fix benchmark comparison script (compare.sh)","description":"The current compare.sh script doesn't actually benchmark Rush due to lack of non-interactive execution support. Solutions: 1) Use new compare-v2.sh with Criterion benchmarks, 2) Add -c flag support first (depends on rush-ey2), 3) Create proper comparison output, 4) Generate HTML reports for visualization","status":"closed","priority":1,"issue_type":"bug","owner":"a@kf.cafe","created_at":"2026-01-20T03:03:42.814323-08:00","created_by":"Asher","updated_at":"2026-01-20T04:15:41.608622-08:00","closed_at":"2026-01-20T04:15:41.608622-08:00","close_reason":"Fixed! compare-fair.sh and compare-fixed.sh now properly benchmark Rush using -c flag. Added comprehensive benchmarking.md documentation.","labels":["benchmarking","bug"],"dependencies":[{"issue_id":"rush-mv0","depends_on_id":"rush-ey2","type":"blocks","created_at":"2026-01-20T03:03:42.815935-08:00","created_by":"Asher"}]}
{"id":"rush-onx","title":"Shell Foundation - Make Rush Actually Work","description":"Fix fundamental lexer and parser issues preventing Rush from working as a real shell.\n\n## Problem\nRush smoke test shows 59% pass rate (71/120 tests). Core POSIX functionality is broken:\n- Variable assignment `FOO=bar` doesn't work\n- All control flow (if/while/for/case) fails with POSIX syntax\n- Globs `*.rs` produce \"Invalid token\" errors\n- Filenames with dots split incorrectly (`README.md` → `README` + `.` + `md`)\n- Arithmetic `$((1+2))` doesn't work\n- Functions don't work\n- Here-documents don't work\n\n## Root Cause\nThe lexer was designed for a Rust-like language, not POSIX shell:\n1. Dot (`.`) is a separate token, breaking filenames\n2. `*` is not recognized as glob character\n3. `~` is not recognized for home expansion\n4. Identifiers can't contain dots\n5. Parser expects `{...}` instead of `then...fi`\n6. `VAR=value` parses `VAR` as a command\n\n## Success Criteria\n- Smoke test passes **120/120 tests (100%)**\n- Can run: `FOO=bar; echo $FOO`\n- Can run: `for x in *.rs; do echo $x; done`\n- Can run: `if [ -f README.md ]; then cat README.md; fi`\n- Can run: `echo $((1+2))`\n- Can use rush as daily driver shell\n\n## Test Command\n```bash\n./tests/smoke_test.sh\n```","status":"open","priority":1,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-25T10:09:32.803671-08:00","created_by":"Asher","updated_at":"2026-01-25T10:18:45.750157-08:00","labels":["critical","foundation","lexer","parser"]}
{"id":"rush-onx.1","title":"FOUNDATION-001: Fix lexer dot-splitting in filenames","description":"Fix the lexer so filenames with dots are tokenized as single words.\n\n## Problem\n`README.md` is tokenized as three tokens: `README` (Identifier) + `.` (Dot) + `md` (Identifier)\n\nThis breaks every command with a dotted filename:\n```bash\ncat README.md      # FAILS: cat gets 3 arguments\nls Cargo.toml      # FAILS: ls gets 3 arguments\n./script.sh        # FAILS: splits on dot\n```\n\n## Root Cause\nIn `src/lexer/mod.rs`:\n```rust\n#[token(\".\")]\nDot,\n\n#[regex(r\"[a-zA-Z_][a-zA-Z0-9_-]*\")]\nIdentifier(String),\n```\n\nDot is a separate token, and identifiers can't contain dots.\n\n## Solution\nModify the `Identifier` regex to include dots when they're part of a filename:\n```rust\n// Option 1: Allow dots in identifiers (except leading)\n#[regex(r\"[a-zA-Z_][a-zA-Z0-9_.-]*\")]\nIdentifier(String),\n\n// Option 2: Create a Word token for unquoted words\n#[regex(r\"[^\\s|;\u0026()\u003c\u003e\\\"'`$\\\\]+\")]\nWord(String),\n```\n\nThe tricky part is that `.` alone should still be a valid token (current directory), but `foo.bar` should be one token.\n\n## Acceptance Criteria\n- [ ] `echo README.md` outputs `README.md` (one argument)\n- [ ] `cat Cargo.toml` works without quotes\n- [ ] `ls file.tar.gz` works (multiple dots)\n- [ ] `./script.sh` works (dot-slash prefix)\n- [ ] `.` alone still works as current directory\n- [ ] `..` works as parent directory\n- [ ] Smoke test: filename tests pass\n\n## Files to Modify\n- `src/lexer/mod.rs` - Token definitions\n\n## Test Cases\n```bash\n./tests/smoke_test.sh | grep -A2 \"FILENAME HANDLING\"\n```","status":"open","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-25T10:10:18.721453-08:00","created_by":"Asher","updated_at":"2026-01-25T10:10:18.721453-08:00","labels":["critical","foundation","lexer"],"dependencies":[{"issue_id":"rush-onx.1","depends_on_id":"rush-onx","type":"parent-child","created_at":"2026-01-25T10:10:18.722977-08:00","created_by":"Asher"}]}
{"id":"rush-onx.10","title":"FOUNDATION-010: Job control and background jobs","description":"## Problem\nBackground jobs and job control may not work reliably.\n\n## Current Behavior\nNeed to verify:\n- `sleep 1 \u0026` - background job\n- `jobs` - list jobs\n- `fg %1` - bring to foreground\n- `bg %1` - continue in background\n- `wait` - wait for background jobs\n\n## Expected Behavior\n```bash\nsleep 10 \u0026           # Start in background, prints [1] PID\njobs                 # Shows: [1]+ Running sleep 10 \u0026\nfg %1                # Brings job 1 to foreground\n# Ctrl+Z             # Suspends job\nbg %1                # Continues suspended job in background\nwait                 # Waits for all background jobs\nwait %1              # Waits for specific job\n```\n\n## Implementation\n1. Track background jobs with job IDs\n2. Implement job table with status tracking\n3. Handle SIGCHLD to update job status\n4. Job specs: %1, %+, %-, %string\n5. Handle terminal control (SIGTSTP, SIGCONT)\n\n## Test Cases\n```bash\ntest_succeeds \"background job\" 'sleep 0.1 \u0026'\ntest_succeeds \"jobs builtin\" 'sleep 0.1 \u0026 jobs'\ntest_succeeds \"wait builtin\" 'sleep 0.1 \u0026 wait'\n```","status":"open","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-25T10:12:21.481628-08:00","created_by":"Asher","updated_at":"2026-01-25T10:15:57.15984-08:00","dependencies":[{"issue_id":"rush-onx.10","depends_on_id":"rush-onx","type":"parent-child","created_at":"2026-01-25T10:12:21.483536-08:00","created_by":"Asher"}]}
{"id":"rush-onx.11","title":"FOUNDATION-011: Subshell execution","description":"## Problem\nSubshell execution with `( )` may not properly isolate environment.\n\n## Current Behavior\nNeed to verify:\n- `(cd /tmp; pwd)` - subshell commands\n- Variable changes in subshell don't affect parent\n- Exit status from subshell is captured\n\n## Expected Behavior\n```bash\nx=outer; (x=inner; echo $x); echo $x\n# Output:\n# inner\n# outer\n\n(exit 5); echo $?\n# Output: 5\n\n(cd /tmp; pwd)\n# Output: /tmp\n# (parent directory unchanged)\n```\n\n## Implementation\n1. Fork a child process for subshell\n2. Execute commands in child\n3. Child inherits but doesn't affect parent's:\n   - Variables\n   - Current directory\n   - File descriptors (unless redirected)\n4. Parent waits for child, captures exit status\n5. Subshells can be used in pipelines: `echo test | (cat)`\n\n## Test Cases\n```bash\ntest_case \"subshell isolation\" 'x=outer; (x=inner; echo $x); echo $x' $'inner\\nouter'\ntest_case \"subshell exit\" '(exit 5); echo $?' '5'\ntest_succeeds \"subshell pipeline\" 'echo test | (cat)'\n```","status":"open","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-25T10:12:22.102898-08:00","created_by":"Asher","updated_at":"2026-01-25T10:16:24.670714-08:00","dependencies":[{"issue_id":"rush-onx.11","depends_on_id":"rush-onx","type":"parent-child","created_at":"2026-01-25T10:12:22.103903-08:00","created_by":"Asher"}]}
{"id":"rush-onx.2","title":"FOUNDATION-002: Implement glob expansion","description":"Implement glob pattern expansion for wildcards.\n\n## Problem\nGlob patterns produce lexer errors:\n```bash\nls *.rs           # Error: Invalid token at position 3: '*'\necho src/*.txt    # Error: Invalid token\nrm -f *.bak       # Error: Invalid token\n```\n\n## Root Cause\nThe lexer has no token definition for `*` in filename context. It's only recognized as part of `$*` (special variable).\n\n## Solution\n1. **Lexer**: Recognize glob patterns as valid tokens\n2. **Parser**: Parse glob patterns as arguments\n3. **Executor**: Expand globs before command execution\n\n```rust\n// In lexer - recognize glob characters in word context\n#[regex(r\"[^\\s|;\u0026()\u003c\u003e\\\"'`$\\\\]*[*?]+[^\\s|;\u0026()\u003c\u003e\\\"'`$\\\\]*\")]\nGlobPattern(String),\n\n// Or integrate into Word token\n#[regex(r\"[^\\s|;\u0026()\u003c\u003e\\\"'`$\\\\]+\")]\nWord(String),  // Then check for glob chars during expansion\n```\n\nIn executor, before running command:\n```rust\nfn expand_globs(args: Vec\u003cString\u003e) -\u003e Vec\u003cString\u003e {\n    args.into_iter()\n        .flat_map(|arg| {\n            if contains_glob_chars(\u0026arg) {\n                glob::glob(\u0026arg).map(|paths| paths.collect()).unwrap_or(vec![arg])\n            } else {\n                vec![arg]\n            }\n        })\n        .collect()\n}\n```\n\n## Acceptance Criteria\n- [ ] `ls *.rs` lists all .rs files\n- [ ] `echo *.txt` expands to matching files\n- [ ] `ls src/**/*.rs` works (recursive glob)\n- [ ] `ls file?.txt` works (single char wildcard)\n- [ ] `ls [abc].txt` works (character class)\n- [ ] Non-matching glob returns literal (or error based on nullglob)\n- [ ] Quoted globs are not expanded: `echo \"*.rs\"` prints `*.rs`\n- [ ] Smoke test: glob tests pass\n\n## Files to Modify\n- `src/lexer/mod.rs` - Token definitions\n- `src/executor/mod.rs` - Glob expansion before execution\n- May use `glob` crate (already in Cargo.toml)\n\n## Test Cases\n```bash\n./tests/smoke_test.sh | grep -A2 \"GLOB EXPANSION\"\n```","status":"open","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-25T10:11:04.867985-08:00","created_by":"Asher","updated_at":"2026-01-25T10:11:04.867985-08:00","labels":["critical","foundation","lexer","parser"],"dependencies":[{"issue_id":"rush-onx.2","depends_on_id":"rush-onx","type":"parent-child","created_at":"2026-01-25T10:11:04.871885-08:00","created_by":"Asher"}]}
{"id":"rush-onx.3","title":"FOUNDATION-003: Implement tilde expansion","description":"## Problem\n`cd ~` and `echo ~/foo` don't expand tilde to home directory.\n\n## Current Behavior\n- `cd ~` tries to find literal directory named `~`\n- `~/path` not recognized as home directory path\n\n## Expected Behavior\n- `~` expands to $HOME\n- `~user` expands to user's home directory\n- Works in any word position: `ls ~/Documents`\n\n## Implementation\n1. In lexer/parser: recognize `~` at word start as expansion trigger\n2. In executor: expand `~` to env HOME before command execution\n3. Handle `~user` by looking up passwd entry\n\n## Test Cases\n```bash\ntest_case \"cd with tilde\" 'cd ~; pwd' \"$HOME\"\ntest_case \"echo tilde\" 'echo ~' \"$HOME\"\ntest_case \"tilde in path\" 'ls ~/. \u003e/dev/null \u0026\u0026 echo ok' 'ok'\n```","status":"open","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-25T10:12:10.599279-08:00","created_by":"Asher","updated_at":"2026-01-25T10:16:38.684965-08:00","dependencies":[{"issue_id":"rush-onx.3","depends_on_id":"rush-onx","type":"parent-child","created_at":"2026-01-25T10:12:10.600254-08:00","created_by":"Asher"}]}
{"id":"rush-onx.4","title":"FOUNDATION-004: Fix variable assignment syntax","description":"## Problem\n`FOO=bar` is parsed as command `FOO` with argument `=bar` instead of variable assignment.\n\n## Current Behavior\n```bash\nFOO=bar      # Error: command not found: FOO\nFOO=bar echo # Same error\n```\n\n## Expected Behavior\n```bash\nFOO=bar           # Sets FOO in current shell\nFOO=bar cmd       # Sets FOO for just that command\nexport FOO=bar    # Sets and exports FOO\n```\n\n## Implementation\n1. Parser must recognize `NAME=VALUE` pattern at statement start\n2. Handle multiple assignments: `A=1 B=2 cmd`\n3. Handle quoted values: `FOO=\"hello world\"`\n4. Distinguish from commands that contain `=`\n\n## Test Cases\n```bash\ntest_case \"VAR=value assignment\" 'FOO=bar; echo $FOO' 'bar'\ntest_case \"export VAR=value\" 'export FOO=bar; echo $FOO' 'bar'\ntest_case \"VAR=value command\" 'FOO=test printenv FOO' 'test'\n```","status":"open","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-25T10:12:11.22737-08:00","created_by":"Asher","updated_at":"2026-01-25T10:16:38.798227-08:00","dependencies":[{"issue_id":"rush-onx.4","depends_on_id":"rush-onx","type":"parent-child","created_at":"2026-01-25T10:12:11.228296-08:00","created_by":"Asher"}]}
{"id":"rush-onx.5","title":"FOUNDATION-005: POSIX control flow syntax","description":"## Problem\nPOSIX control flow syntax fails - parser expects Rust-style braces instead of shell keywords.\n\n## Current Behavior\n```bash\nif true; then echo yes; fi    # Error: unexpected token\nwhile [ $i -lt 3 ]; do ...   # Error: unexpected token\nfor x in a b c; do echo $x; done  # Error: unexpected token\ncase $x in ...) ;; esac      # Error: unexpected token\nuntil [ $i -ge 3 ]; do ...   # Error: unexpected token\n```\n\n## Expected Behavior\nAll POSIX control flow syntax works:\n- `if COND; then BODY; elif COND; then BODY; else BODY; fi`\n- `while COND; do BODY; done`\n- `until COND; do BODY; done`\n- `for VAR in WORDS; do BODY; done`\n- `case WORD in PATTERN) BODY;; esac`\n\n## Implementation\n1. Parser needs to recognize `then/fi`, `do/done`, `esac` as keywords\n2. These are context-sensitive (only keywords after if/while/for/case)\n3. Handle compound conditions with `\u0026\u0026`, `||`\n4. Handle nested control flow\n\n## Test Cases\n```bash\ntest_case \"if then fi\" 'if true; then echo yes; fi' 'yes'\ntest_case \"if else\" 'if false; then echo yes; else echo no; fi' 'no'\ntest_case \"while loop\" 'i=0; while [ $i -lt 3 ]; do echo $i; i=$((i+1)); done' $'0\\n1\\n2'\ntest_case \"for loop\" 'for x in a b c; do echo $x; done' $'a\\nb\\nc'\ntest_case \"case statement\" 'x=foo; case $x in foo) echo matched;; esac' 'matched'\n```","status":"open","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-25T10:12:11.827592-08:00","created_by":"Asher","updated_at":"2026-01-25T10:16:38.912531-08:00","dependencies":[{"issue_id":"rush-onx.5","depends_on_id":"rush-onx","type":"parent-child","created_at":"2026-01-25T10:12:11.82847-08:00","created_by":"Asher"}]}
{"id":"rush-onx.6","title":"FOUNDATION-006: Arithmetic expansion","description":"## Problem\nArithmetic expansion `$(( ))` doesn't work.\n\n## Current Behavior\n```bash\necho $((1+2))      # Error or wrong output\nx=5; echo $((x+3)) # Error or wrong output\n```\n\n## Expected Behavior\n```bash\necho $((1+2))      # Output: 3\necho $((3*4))      # Output: 12\nx=5; echo $((x+3)) # Output: 8\necho $((5\u003e3))      # Output: 1\necho $((5\u003c3))      # Output: 0\n```\n\n## Implementation\n1. Lexer/parser must recognize `$(( ... ))` as arithmetic expansion\n2. Implement arithmetic evaluator supporting:\n   - Basic ops: + - * / %\n   - Comparisons: \u003c \u003e \u003c= \u003e= == !=\n   - Bitwise: \u0026 | ^ ~ \u003c\u003c \u003e\u003e\n   - Logical: \u0026\u0026 || !\n   - Assignment: = += -= *= /=\n   - Variable references (no $ needed inside)\n   - Parentheses for grouping\n3. Variables inside expand to their numeric value (0 if unset/non-numeric)\n\n## Test Cases\n```bash\ntest_case \"arithmetic expansion\" 'echo $((1+2))' '3'\ntest_case \"arithmetic multiply\" 'echo $((3*4))' '12'\ntest_case \"arithmetic with var\" 'x=5; echo $((x+3))' '8'\ntest_case \"arithmetic compare\" 'echo $((5\u003e3))' '1'\n```","status":"open","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-25T10:12:12.41953-08:00","created_by":"Asher","updated_at":"2026-01-25T10:16:39.02643-08:00","dependencies":[{"issue_id":"rush-onx.6","depends_on_id":"rush-onx","type":"parent-child","created_at":"2026-01-25T10:12:12.420481-08:00","created_by":"Asher"}]}
{"id":"rush-onx.7","title":"FOUNDATION-007: Function definitions","description":"## Problem\nShell function definitions don't work.\n\n## Current Behavior\n```bash\nfoo() { echo hello; }   # Error: unexpected token\nfunction foo { ... }    # Error: unexpected token\n```\n\n## Expected Behavior\n```bash\nfoo() { echo hello; }; foo        # Output: hello\ngreet() { echo \"hi $1\"; }; greet world  # Output: hi world\nret5() { return 5; }; ret5; echo $?      # Output: 5\nf() { local x=inner; echo $x; }; f       # Output: inner\n```\n\n## Implementation\n1. Parser must recognize `NAME() { BODY }` and `function NAME { BODY }`\n2. Store function definitions in runtime environment\n3. When function is called:\n   - Create new scope for positional parameters\n   - Execute function body\n   - Handle `return` to exit function with status\n4. Support `local` variables inside functions\n5. Functions can call other functions (recursion)\n\n## Test Cases\n```bash\ntest_case \"function definition\" 'foo() { echo hello; }; foo' 'hello'\ntest_case \"function with args\" 'greet() { echo \"hi $1\"; }; greet world' 'hi world'\ntest_case \"function return\" 'ret5() { return 5; }; ret5; echo $?' '5'\ntest_case \"local variables\" 'f() { local x=inner; echo $x; }; x=outer; f; echo $x' $'inner\\nouter'\n```","status":"open","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-25T10:12:19.6504-08:00","created_by":"Asher","updated_at":"2026-01-25T10:14:45.715283-08:00","dependencies":[{"issue_id":"rush-onx.7","depends_on_id":"rush-onx","type":"parent-child","created_at":"2026-01-25T10:12:19.651587-08:00","created_by":"Asher"}]}
{"id":"rush-onx.8","title":"FOUNDATION-008: Here-documents","description":"## Problem\nHere-documents (`\u003c\u003cEOF`) don't work.\n\n## Current Behavior\n```bash\ncat \u003c\u003cEOF\nhello\nEOF\n# Error: unexpected token or hangs\n```\n\n## Expected Behavior\n```bash\ncat \u003c\u003cEOF      # Feed multi-line input to command\nhello\nworld\nEOF\n\ncat \u003c\u003c'EOF'    # No variable expansion (quoted delimiter)\n$HOME\nEOF\n\ncat \u003c\u003c-EOF     # Strip leading tabs\n\tindented\nEOF\n```\n\n## Implementation\n1. Lexer must recognize `\u003c\u003cWORD` as here-doc start\n2. Read lines until delimiter WORD appears alone on a line\n3. Handle quoting:\n   - Unquoted delimiter: expand variables in body\n   - Quoted delimiter ('EOF' or \"EOF\"): literal body\n4. Handle `\u003c\u003c-` variant (strip leading tabs)\n5. Multiple here-docs can appear on same line\n\n## Test Cases\n```bash\ntest_case \"here-doc basic\" $'cat \u003c\u003cEOF\\nhello\\nEOF' 'hello'\ntest_case \"here-doc multiline\" $'cat \u003c\u003cEOF\\nline1\\nline2\\nEOF' $'line1\\nline2'\ntest_case \"here-doc with var\" $'x=world; cat \u003c\u003cEOF\\nhello $x\\nEOF' 'hello world'\n```","status":"open","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-25T10:12:20.251844-08:00","created_by":"Asher","updated_at":"2026-01-25T10:15:14.493421-08:00","dependencies":[{"issue_id":"rush-onx.8","depends_on_id":"rush-onx","type":"parent-child","created_at":"2026-01-25T10:12:20.252753-08:00","created_by":"Asher"}]}
{"id":"rush-onx.9","title":"FOUNDATION-009: Command substitution in strings","description":"## Problem\nCommand substitution inside double-quoted strings doesn't expand.\n\n## Current Behavior\n```bash\necho \"dir: $(pwd)\"    # Output: dir: $(pwd)  (literal)\nx=\"$(echo foo)\"       # x contains literal $(echo foo)\n```\n\n## Expected Behavior\n```bash\necho \"dir: $(pwd)\"    # Output: dir: /current/path\nx=\"$(echo foo)\"; echo $x  # Output: foo\necho \"nested: $(echo $(echo deep))\"  # Output: nested: deep\n```\n\n## Implementation\n1. When parsing double-quoted strings, recognize `$(...)` sequences\n2. Execute the command inside substitution\n3. Capture stdout and insert into string\n4. Handle nested substitutions\n5. Also support backtick syntax: `\\`cmd\\``\n\n## Test Cases\n```bash\ntest_case \"simple subst\" 'echo $(echo hello)' 'hello'\ntest_case \"subst in string\" 'echo \"dir: $(pwd)\"' \"dir: $(pwd)\"\ntest_case \"nested subst\" 'echo $(echo $(echo deep))' 'deep'\ntest_case \"subst in var\" 'x=$(echo foo); echo $x' 'foo'\n```","status":"open","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-25T10:12:20.859867-08:00","created_by":"Asher","updated_at":"2026-01-25T10:15:56.476136-08:00","dependencies":[{"issue_id":"rush-onx.9","depends_on_id":"rush-onx","type":"parent-child","created_at":"2026-01-25T10:12:20.861379-08:00","created_by":"Asher"}]}
{"id":"rush-q40","title":"Reduce baseline command execution overhead","description":"## Problem\n\nRush has a consistent ~2.5ms overhead compared to bash for basic command execution. This affects all operations uniformly.\n\n## Benchmark Data\n\n| Operation | Rush | Bash | Overhead |\n|-----------|------|------|----------|\n| exit | 4.67ms | 1.97ms | +2.7ms |\n| echo test | 4.65ms | 1.97ms | +2.7ms |\n| pwd | 4.67ms | 1.99ms | +2.7ms |\n| cd \u0026\u0026 pwd | 4.66ms | 1.99ms | +2.7ms |\n\n## Analysis\n\nThe consistent ~2.7ms overhead suggests startup/initialization cost rather than per-command overhead. Likely causes:\n- Runtime initialization\n- Parser/lexer setup\n- Environment copying\n- Memory allocation patterns\n\n## Target\n\nReduce baseline to \u003c3ms to be competitive with zsh (3.5ms) and closer to bash (2ms).\n\n## Investigation Areas\n\n- `src/runtime/mod.rs` - Runtime initialization\n- `src/main.rs` - Startup sequence  \n- `src/executor/mod.rs` - Command execution path\n- Profile with `cargo flamegraph` to identify hotspots","status":"open","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-25T10:01:43.532099-08:00","created_by":"Asher","updated_at":"2026-01-25T10:01:43.532099-08:00","labels":["perf"]}
{"id":"rush-scr","title":"Rush Scripting Support - Essential Builtins","description":"Implement essential scripting builtins to make Rush a full-featured shell for scripts, not just interactive use.\n\n## Motivation\nRush needs scripting support to enable:\n- Configuration files (~/.rushrc)\n- Git hooks\n- Build scripts\n- Editor integrations (Helix)\n- Automation and cron jobs\n\n## Success Criteria\n- All Tier 1 builtins implemented (read, true/false, return, local, shift)\n- All Tier 2 builtins implemented (trap, printf, eval, exec, unset)\n- All Tier 3 builtins implemented (command, builtin, kill, wait, pushd/popd/dirs)\n- Can run basic shell scripts\n- Can execute ~/.rushrc configuration\n- Integration tests for scripting scenarios\n- Documentation for all new builtins\n\n## Philosophy\nPOSIX-inspired, not POSIX-compliant:\n- Common patterns work (muscle memory)\n- Modern conveniences (better errors, safety)\n- Skip legacy cruft\n- Make scripting better than bash","status":"closed","priority":1,"issue_type":"epic","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-24T15:02:58.383195-08:00","closed_at":"2026-01-24T15:02:58.383195-08:00","close_reason":"Closed","labels":["builtins","epic","phase4","scripting"]}
{"id":"rush-scr.1","title":"SCRIPT-001: read builtin","description":"As a shell scripter, I need the read builtin so I can get user input and process files line-by-line.\n\n## Priority: P0 - CRITICAL\nAbsolutely essential for any scripting. Can't write interactive scripts or process files without it.\n\n## Acceptance Criteria\n- [ ] Basic usage: `read varname`\n- [ ] Multiple variables: `read first second rest`\n- [ ] Prompt with -p: `read -p \"Enter name: \" name`\n- [ ] Silent input with -s: `read -s password` (for passwords)\n- [ ] Timeout with -t: `read -t 5 answer` (5 second timeout)\n- [ ] Read from stdin in loops: `while read line; do echo $line; done \u003c file.txt`\n- [ ] Handle IFS for field splitting\n- [ ] Exit code 0 on success, 1 on EOF\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# Interactive input\nread -p \"Enter your name: \" username\necho \"Hello, $username\"\n\n# Password input (hidden)\nread -s -p \"Password: \" password\n\n# Process file line by line\nwhile read line; do\n  echo \"Line: $line\"\ndone \u003c data.txt\n\n# Multiple variables\nread first last \u003c\u003c\u003c \"John Doe\"\necho \"First: $first, Last: $last\"\n```\n\n## Technical Implementation\n- Add to src/builtins/read.rs\n- Handle stdin vs TTY input\n- Support IFS environment variable for field splitting\n- Timeout using select() or similar\n- Silent mode using terminal raw mode\n\n## Testing\n- Interactive input tests\n- File processing tests\n- Timeout behavior\n- EOF handling\n- Multiple variable assignment\n\n## Estimated Effort: 2 days","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-24T14:53:09.711953-08:00","closed_at":"2026-01-24T14:53:09.711953-08:00","close_reason":"Closed","labels":["builtin","critical","p0","scripting"],"dependencies":[{"issue_id":"rush-scr.1","depends_on_id":"rush-scr","type":"parent-child","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-scr.10","title":"SCRIPT-010: unset builtin","description":"As a script writer, I need the unset builtin to remove variables and functions.\n\n## Priority: P1 - HIGH\nNeeded for cleanup and variable management.\n\n## Acceptance Criteria\n- [ ] `unset var` removes variable\n- [ ] `unset -v var` removes variable (explicit)\n- [ ] `unset -f func` removes function\n- [ ] Multiple arguments: `unset a b c`\n- [ ] No error if variable doesn't exist\n- [ ] Cannot unset readonly variables\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# Remove variable\nexport TEMP_VAR=value\necho $TEMP_VAR  # value\nunset TEMP_VAR\necho $TEMP_VAR  # empty\n\n# Remove multiple\na=1 b=2 c=3\nunset a b c\n\n# Remove function\nmyfunc() { echo hello; }\nunset -f myfunc\nmyfunc  # command not found\n\n# Cleanup pattern\ntrap 'unset TEMP_DIR TEMP_FILE' EXIT\n```\n\n## Technical Implementation\n- Add to src/builtins/mod.rs\n- Runtime.remove_variable(name)\n- Runtime.remove_function(name) (when functions exist)\n- Check readonly status before removing\n\n## Testing\n- Unset variable\n- Unset multiple variables\n- Unset function\n- Unset nonexistent (no error)\n- Readonly protection\n\n## Estimated Effort: 1 day","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-24T14:53:10.141033-08:00","closed_at":"2026-01-24T14:53:10.141033-08:00","close_reason":"Closed","labels":["builtin","p1","scripting"],"dependencies":[{"issue_id":"rush-scr.10","depends_on_id":"rush-scr","type":"parent-child","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-scr.11","title":"SCRIPT-011: command builtin","description":"As a script writer, I need the command builtin to bypass aliases and functions.\n\n## Priority: P2 - MEDIUM\nUseful for avoiding alias/function conflicts.\n\n## Acceptance Criteria\n- [ ] `command cmd` runs external command, bypassing aliases/functions\n- [ ] `command -v cmd` shows path to command\n- [ ] `command -V cmd` verbose description\n- [ ] Works with builtins (runs builtin)\n- [ ] Exit code from executed command\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# Bypass alias\nalias ls='ls --color'\ncommand ls  # Runs /bin/ls without --color\n\n# Check if command exists\nif command -v git \u003e /dev/null; then\n  echo \"Git is installed\"\nfi\n\n# Get command path\ncommand -v python3  # /usr/bin/python3\n\n# Verbose info\ncommand -V cd\n# cd is a shell builtin\n```\n\n## Technical Implementation\n- Add to src/builtins/command.rs\n- Skip alias/function lookup in executor\n- -v flag: search PATH, return path\n- -V flag: return detailed description\n\n## Testing\n- Bypass alias\n- Bypass function\n- -v flag\n- -V flag\n- With builtins\n\n## Estimated Effort: 1 day","status":"closed","priority":3,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-24T14:53:10.208395-08:00","closed_at":"2026-01-24T14:53:10.208395-08:00","close_reason":"Closed","labels":["builtin","p2","scripting"],"dependencies":[{"issue_id":"rush-scr.11","depends_on_id":"rush-scr","type":"parent-child","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-scr.12","title":"SCRIPT-012: builtin builtin","description":"As a script writer, I need the builtin builtin to force execution of builtins even when shadowed.\n\n## Priority: P2 - MEDIUM\nUseful for avoiding function conflicts with builtins.\n\n## Acceptance Criteria\n- [ ] `builtin cmd` runs builtin, bypassing functions\n- [ ] Error if command is not a builtin\n- [ ] Exit code from builtin\n- [ ] Works with all builtins\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# Function shadows builtin\ncd() {\n  echo \"Changing to $1\"\n  builtin cd \"$1\"  # Call actual cd builtin\n}\n\n# Force builtin\nbuiltin echo \"This is the builtin echo\"\n\n# Error on non-builtin\nbuiltin git status  # Error: git is not a builtin\n```\n\n## Technical Implementation\n- Add to src/builtins/mod.rs\n- Check if command is builtin\n- Execute builtin directly\n- Error if not builtin\n\n## Testing\n- Run builtins\n- Error on non-builtin\n- Shadow function test\n\n## Estimated Effort: 4 hours","status":"closed","priority":3,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-24T14:53:10.275378-08:00","closed_at":"2026-01-24T14:53:10.275378-08:00","close_reason":"Closed","labels":["builtin","p2","scripting"],"dependencies":[{"issue_id":"rush-scr.12","depends_on_id":"rush-scr","type":"parent-child","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-scr.13","title":"SCRIPT-013: kill builtin","description":"As a script writer, I need the kill builtin to send signals to processes.\n\n## Priority: P2 - MEDIUM\nUseful for process management in scripts.\n\n## Acceptance Criteria\n- [ ] `kill pid` sends SIGTERM\n- [ ] `kill -SIGNAL pid` sends specific signal\n- [ ] `kill -9 pid` sends SIGKILL\n- [ ] `kill -l` lists signal names\n- [ ] Multiple PIDs: `kill -9 1234 5678`\n- [ ] Job specs: `kill %1`\n- [ ] Error on invalid PID\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# Terminate process\nkill 12345\n\n# Force kill\nkill -9 12345\nkill -KILL 12345\n\n# Graceful shutdown\nkill -TERM 12345\n\n# List signals\nkill -l\n\n# Kill job\nkill %1\n```\n\n## Technical Implementation\n- Add to src/builtins/kill.rs\n- Use libc::kill() or nix::sys::signal\n- Parse signal names and numbers\n- Integrate with job control\n\n## Testing\n- Send signals\n- Signal name parsing\n- Multiple PIDs\n- Job specs\n- Error handling\n\n## Estimated Effort: 1 day","status":"closed","priority":3,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-24T14:53:10.345428-08:00","closed_at":"2026-01-24T14:53:10.345428-08:00","close_reason":"Closed","labels":["builtin","p2","process-management","scripting"],"dependencies":[{"issue_id":"rush-scr.13","depends_on_id":"rush-scr","type":"parent-child","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-scr.14","title":"SCRIPT-014: wait builtin","description":"As a script writer, I need the wait builtin to wait for background jobs to complete.\n\n## Priority: P2 - MEDIUM\nCompletes job control functionality.\n\n## Acceptance Criteria\n- [ ] `wait` waits for all background jobs\n- [ ] `wait pid` waits for specific process\n- [ ] `wait %job` waits for specific job\n- [ ] Returns exit code of waited process\n- [ ] Error if PID doesn't exist\n- [ ] Works with multiple PIDs\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# Wait for background job\nsleep 5 \u0026\njob=$!\necho \"Waiting...\"\nwait $job\necho \"Done\"\n\n# Wait for all jobs\nsleep 3 \u0026\nsleep 5 \u0026\nwait  # Waits for both\n\n# Get exit code\nfalse \u0026\njob=$!\nwait $job\necho $?  # 1\n```\n\n## Technical Implementation\n- Add to src/builtins/wait.rs\n- Use libc::waitpid() or std::process::Child::wait()\n- Integrate with job manager\n- Track job PIDs\n\n## Testing\n- Wait for single job\n- Wait for all jobs\n- Exit code propagation\n- Error on invalid PID\n\n## Estimated Effort: 1 day","status":"closed","priority":3,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-24T14:53:10.417569-08:00","closed_at":"2026-01-24T14:53:10.417569-08:00","close_reason":"Closed","labels":["builtin","job-control","p2","scripting"],"dependencies":[{"issue_id":"rush-scr.14","depends_on_id":"rush-scr","type":"parent-child","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-scr.15","title":"SCRIPT-015: pushd/popd/dirs builtins","description":"As a power user, I need directory stack commands for easy navigation.\n\n## Priority: P3 - NICE TO HAVE\nQuality of life feature for directory navigation.\n\n## Acceptance Criteria\n- [ ] `pushd dir` pushes current dir and changes to new dir\n- [ ] `popd` pops directory stack and changes to it\n- [ ] `dirs` shows directory stack\n- [ ] `dirs -c` clears stack\n- [ ] `pushd` with no args swaps top two dirs\n- [ ] Stack persists in session\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# Navigate with stack\ncd /usr/local\npushd /tmp        # Now in /tmp, stack: /usr/local\npushd /home       # Now in /home, stack: /usr/local /tmp\ndirs              # /home /tmp /usr/local\npopd              # Back to /tmp\npopd              # Back to /usr/local\n\n# Quick swap\npushd /var/log\npushd /etc\npushd             # Swap /etc and /var/log\n```\n\n## Technical Implementation\n- Add to src/builtins/dirs.rs\n- Runtime stores Vec\u003cPathBuf\u003e directory stack\n- pushd: push current, cd to new\n- popd: pop and cd\n- dirs: display stack\n\n## Testing\n- Push directories\n- Pop directories\n- Display stack\n- Clear stack\n- Swap behavior\n\n## Estimated Effort: 1 day","status":"closed","priority":4,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-24T14:56:19.642218-08:00","closed_at":"2026-01-24T14:56:19.642218-08:00","close_reason":"Closed","labels":["builtin","navigation","p3","scripting"],"dependencies":[{"issue_id":"rush-scr.15","depends_on_id":"rush-scr","type":"parent-child","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-scr.2","title":"SCRIPT-002: true/false builtins","description":"As a shell scripter, I need true and false builtins so I can write conditionals and infinite loops.\n\n## Priority: P0 - CRITICAL\nEssential for any conditional logic or loops.\n\n## Acceptance Criteria\n- [ ] `true` always exits with code 0\n- [ ] `false` always exits with code 1\n- [ ] Work in conditionals: `if true; then echo yes; fi`\n- [ ] Work in loops: `while true; do echo loop; sleep 1; done`\n- [ ] Work with \u0026\u0026 and ||: `true \u0026\u0026 echo yes`, `false || echo no`\n- [ ] Ignore all arguments (POSIX behavior)\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# Infinite loop\nwhile true; do\n  echo \"Running...\"\n  sleep 1\ndone\n\n# Conditionals\nif true; then\n  echo \"This always runs\"\nfi\n\n# Logic\ntrue \u0026\u0026 echo \"Success\" || echo \"Failure\"\nfalse \u0026\u0026 echo \"Won't print\" || echo \"Will print\"\n```\n\n## Technical Implementation\n- Add to src/builtins/mod.rs as simple functions\n- `builtin_true` returns ExecutionResult with exit_code 0\n- `builtin_false` returns ExecutionResult with exit_code 1\n- No stdout/stderr output\n\n## Testing\n- Exit codes\n- Use in conditionals\n- Use in loops\n- With \u0026\u0026 and ||\n\n## Estimated Effort: 1 hour","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-24T14:56:19.671189-08:00","closed_at":"2026-01-24T14:56:19.671189-08:00","close_reason":"Closed","labels":["builtin","critical","p0","scripting"],"dependencies":[{"issue_id":"rush-scr.2","depends_on_id":"rush-scr","type":"parent-child","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-scr.3","title":"SCRIPT-003: return builtin","description":"As a shell function writer, I need the return builtin so I can exit functions with specific exit codes.\n\n## Priority: P0 - CRITICAL\nCan't write useful functions without return.\n\n## Acceptance Criteria\n- [ ] `return` exits current function with code 0\n- [ ] `return N` exits with code N\n- [ ] Only works inside functions (error otherwise)\n- [ ] Also works in sourced scripts\n- [ ] Exit code available in $?\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\ncheck_file() {\n  if [ -f \"$1\" ]; then\n    return 0  # success\n  else\n    return 1  # failure\n  fi\n}\n\nif check_file \"data.txt\"; then\n  echo \"File exists\"\nfi\n\n# Early return\nprocess() {\n  [ -z \"$1\" ] \u0026\u0026 return 1\n  echo \"Processing $1\"\n  return 0\n}\n```\n\n## Technical Implementation\n- Add to src/builtins/mod.rs\n- Needs function call stack tracking\n- Throw special error/signal to unwind to function boundary\n- Set exit code in runtime\n\n## Dependencies\n- Requires function call stack in Runtime\n- May need special ExecutionResult variant for Return\n\n## Testing\n- Return from function\n- Return with exit code\n- Error when not in function\n- Use in sourced scripts\n\n## Estimated Effort: 1 day","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-24T14:53:09.783657-08:00","closed_at":"2026-01-24T14:53:09.783657-08:00","close_reason":"Closed","labels":["builtin","critical","functions","p0","scripting"],"dependencies":[{"issue_id":"rush-scr.3","depends_on_id":"rush-scr","type":"parent-child","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-scr.4","title":"SCRIPT-004: local builtin","description":"As a function writer, I need the local builtin so I can create function-scoped variables that don't leak.\n\n## Priority: P0 - CRITICAL\nEssential for writing clean, non-leaking functions.\n\n## Acceptance Criteria\n- [ ] `local var=value` creates function-scoped variable\n- [ ] `local var` declares without assignment\n- [ ] Multiple declarations: `local a=1 b=2 c=3`\n- [ ] Only works inside functions (error otherwise)\n- [ ] Variables don't leak outside function\n- [ ] Shadows global variables\n- [ ] Restored on function exit\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\nprocess() {\n  local temp=\"processing\"\n  local count=0\n  \n  echo \"$temp\"\n  count=$((count + 1))\n  echo \"Count: $count\"\n}\n\nprocess\necho \"$temp\"   # Empty - not leaked\necho \"$count\"  # Empty - not leaked\n\n# Shadowing\nname=\"global\"\ntest_shadow() {\n  local name=\"local\"\n  echo \"Inside: $name\"  # local\n}\ntest_shadow\necho \"Outside: $name\"  # global\n```\n\n## Technical Implementation\n- Add to src/builtins/mod.rs\n- Runtime needs function variable scopes (stack)\n- Push scope on function entry\n- Pop scope on function exit\n- Variable lookup checks scopes in order (local → global)\n\n## Dependencies\n- Requires function call stack in Runtime\n- May need scope tracking in Runtime\n\n## Testing\n- Local variable isolation\n- Shadowing behavior\n- Scope cleanup on exit\n- Error when not in function\n- Multiple locals\n\n## Estimated Effort: 2 days","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-24T14:53:09.864107-08:00","closed_at":"2026-01-24T14:53:09.864107-08:00","close_reason":"Closed","labels":["builtin","critical","functions","p0","scripting"],"dependencies":[{"issue_id":"rush-scr.4","depends_on_id":"rush-scr","type":"parent-child","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-scr.5","title":"SCRIPT-005: shift builtin","description":"As a script writer, I need the shift builtin so I can process positional parameters in loops.\n\n## Priority: P0 - CRITICAL\nEssential for processing command-line arguments.\n\n## Acceptance Criteria\n- [ ] `shift` removes $1, shifts all params left\n- [ ] `shift N` shifts N parameters\n- [ ] Updates $#, $@, $*\n- [ ] Error if shift count \u003e param count\n- [ ] Works in functions and scripts\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# Process all arguments\nwhile [ $# -gt 0 ]; do\n  echo \"Arg: $1\"\n  shift\ndone\n\n# Shift multiple\nshift 2  # Skip first two args\necho \"Remaining: $@\"\n\n# In functions\nprocess_args() {\n  local cmd=$1\n  shift\n  echo \"Command: $cmd\"\n  echo \"Args: $@\"\n}\n\nprocess_args build --release --verbose\n# Command: build\n# Args: --release --verbose\n```\n\n## Technical Implementation\n- Add to src/builtins/mod.rs\n- Runtime needs to track positional parameters\n- Modify parameter array in place\n- Update $# special variable\n\n## Dependencies\n- Requires positional parameter tracking in Runtime\n- Needs $# special variable support\n\n## Testing\n- Shift one parameter\n- Shift multiple parameters\n- Shift in loops\n- Error on over-shift\n- Use in functions\n\n## Estimated Effort: 1 day","status":"closed","priority":1,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-24T14:53:09.931999-08:00","closed_at":"2026-01-24T14:53:09.931999-08:00","close_reason":"Closed","labels":["builtin","critical","p0","scripting"],"dependencies":[{"issue_id":"rush-scr.5","depends_on_id":"rush-scr","type":"parent-child","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-scr.6","title":"SCRIPT-006: trap builtin","description":"As a script writer, I need the trap builtin so I can handle signals and run cleanup code on exit.\n\n## Priority: P1 - HIGH\nEssential for robust scripts with cleanup.\n\n## Acceptance Criteria\n- [ ] `trap 'command' SIGNAL` sets signal handler\n- [ ] `trap 'command' EXIT` runs on shell exit\n- [ ] Support common signals: INT, TERM, HUP, EXIT, ERR\n- [ ] `trap - SIGNAL` removes trap\n- [ ] `trap` with no args lists all traps\n- [ ] Traps inherited by subshells\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# Cleanup on exit\ntrap 'rm -f /tmp/$$-*' EXIT\n\n# Handle interrupts\ntrap 'echo \"Interrupted!\"; exit 1' INT\n\n# Cleanup function\ncleanup() {\n  echo \"Cleaning up...\"\n  rm -f temp_files\n}\ntrap cleanup EXIT\n\n# Error handler\ntrap 'echo \"Error on line $LINENO\"' ERR\n```\n\n## Technical Implementation\n- Add to src/builtins/trap.rs\n- Runtime stores trap handlers (HashMap\u003cSignal, String\u003e)\n- Signal handler integration (already exists)\n- Execute trap command when signal received\n- Special EXIT trap on shell exit\n\n## Testing\n- Trap signals\n- EXIT trap\n- Remove traps\n- List traps\n- Nested traps\n\n## Estimated Effort: 2 days","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-24T15:02:52.094794-08:00","closed_at":"2026-01-24T15:02:52.094794-08:00","close_reason":"Closed","labels":["builtin","p1","scripting","signals"],"dependencies":[{"issue_id":"rush-scr.6","depends_on_id":"rush-scr","type":"parent-child","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-scr.7","title":"SCRIPT-007: printf builtin","description":"As a script writer, I need the printf builtin for formatted output beyond what echo provides.\n\n## Priority: P1 - HIGH\nEcho is limited; printf is essential for proper formatting.\n\n## Acceptance Criteria\n- [ ] Format strings: `printf \"%s %d\\n\" \"count\" 42`\n- [ ] Format specifiers: %s, %d, %f, %x, %o\n- [ ] Width and precision: %10s, %.2f\n- [ ] Escape sequences: \\n, \\t, \\\\, \\'\n- [ ] Multiple arguments reuse format\n- [ ] No automatic newline (unlike echo)\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# Formatted output\nprintf \"Name: %s, Age: %d\\n\" \"Alice\" 30\n\n# Aligned columns\nprintf \"%-20s %10s\\n\" \"Item\" \"Price\"\nprintf \"%-20s %10.2f\\n\" \"Apple\" 1.99\nprintf \"%-20s %10.2f\\n\" \"Banana\" 0.59\n\n# Hex and octal\nprintf \"Hex: %x, Octal: %o\\n\" 255 255\n\n# Reuse format\nprintf \"%s\\n\" one two three\n# one\n# two  \n# three\n```\n\n## Technical Implementation\n- Add to src/builtins/printf.rs\n- Parse format string\n- Handle format specifiers\n- Type conversion (string to int/float)\n- Escape sequence handling\n\n## Testing\n- All format specifiers\n- Width and precision\n- Escape sequences\n- Multiple arguments\n- Error handling\n\n## Estimated Effort: 2 days","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-24T14:53:10.003531-08:00","closed_at":"2026-01-24T14:53:10.003531-08:00","close_reason":"Closed","labels":["builtin","formatting","p1","scripting"],"dependencies":[{"issue_id":"rush-scr.7","depends_on_id":"rush-scr","type":"parent-child","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-scr.8","title":"SCRIPT-008: eval builtin","description":"As a script writer, I need the eval builtin to execute dynamically constructed commands.\n\n## Priority: P1 - HIGH\nSometimes necessary evil for advanced scripting.\n\n## Acceptance Criteria\n- [ ] `eval command` executes string as command\n- [ ] Variable expansion before execution\n- [ ] Command substitution works\n- [ ] Exit code from evaluated command\n- [ ] Works with complex commands (pipes, redirects)\n- [ ] Security warning in help text\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# Dynamic command\ncmd=\"ls -la\"\neval $cmd\n\n# Variable indirection\nvar=\"HOME\"\neval echo \\$$var  # Prints $HOME value\n\n# Dynamic pipes\nop=\"| grep foo\"\neval \"cat file.txt $op\"\n\n# Build command from parts\nflags=\"-a -l\"\neval ls $flags /tmp\n```\n\n## Technical Implementation\n- Add to src/builtins/mod.rs\n- Concatenate arguments into string\n- Parse and execute as new command\n- Return execution result\n\n## Security Notes\n- Document eval dangers\n- Warn about injection risks\n- Recommend alternatives when possible\n\n## Testing\n- Simple eval\n- Variable expansion\n- Command substitution\n- Complex commands\n- Edge cases\n\n## Estimated Effort: 1 day","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-24T14:53:10.07136-08:00","closed_at":"2026-01-24T14:53:10.07136-08:00","close_reason":"Closed","labels":["builtin","p1","scripting"],"dependencies":[{"issue_id":"rush-scr.8","depends_on_id":"rush-scr","type":"parent-child","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-scr.9","title":"SCRIPT-009: exec builtin","description":"As a script writer, I need the exec builtin to replace the shell process or redirect file descriptors permanently.\n\n## Priority: P1 - HIGH\nNeeded for advanced scripting and performance optimization.\n\n## Acceptance Criteria\n- [ ] `exec command` replaces shell with command\n- [ ] No return from exec (process replaced)\n- [ ] `exec \u003e file` redirects stdout permanently\n- [ ] `exec 2\u003e\u00261` redirects stderr to stdout permanently\n- [ ] `exec \u003c file` redirects stdin permanently\n- [ ] Works in scripts and functions\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# Replace shell with command\nexec ./myprogram args  # Shell exits, myprogram runs\n\n# Permanent redirection\nexec \u003e output.log 2\u003e\u00261\necho \"This goes to log\"  # All subsequent output to log\n\n# Redirect stdin\nexec \u003c input.txt\nwhile read line; do\n  echo \"$line\"\ndone\n\n# Init script pattern\nif [ -f ./server ]; then\n  exec ./server  # Replace init with server\nfi\n```\n\n## Technical Implementation\n- Add to src/builtins/mod.rs\n- For command: use std::process::Command::exec() (Unix)\n- For redirects: dup2() file descriptors\n- Store redirect state in Runtime\n\n## Platform Notes\n- exec command replacement is Unix-only\n- File descriptor redirection works cross-platform\n\n## Testing\n- Exec command (process replacement)\n- Stdout redirection\n- Stderr redirection\n- Stdin redirection\n- Combined redirects\n\n## Estimated Effort: 2 days","status":"closed","priority":2,"issue_type":"task","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-24T14:55:58.913034-08:00","closed_at":"2026-01-24T14:55:58.913034-08:00","close_reason":"Closed","labels":["builtin","p1","scripting"],"dependencies":[{"issue_id":"rush-scr.9","depends_on_id":"rush-scr","type":"parent-child","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher"}]}
{"id":"rush-tlg","title":"Add sed and awk alternative builtins","description":"Implement fast Rust-based alternatives to sed and awk for text processing: 1) Basic sed functionality (substitution, deletion), 2) Common awk patterns (field splitting, pattern matching), 3) Maintain compatibility with common use cases, 4) Leverage Rust performance","status":"open","priority":2,"issue_type":"feature","owner":"a@kf.cafe","created_at":"2026-01-20T03:03:12.817641-08:00","created_by":"Asher","updated_at":"2026-01-20T03:03:12.817641-08:00","labels":["enhancement","phase4"]}
{"id":"rush-uniq.1","title":"UNIQUE-001: bench builtin","description":"As a performance-conscious developer, I want a built-in benchmarking tool so I can quickly measure command performance.\n\n## Priority: P3 - NICE TO HAVE\nUnique to Rush - differentiation feature.\n\n## Acceptance Criteria\n- [ ] `bench command` runs command N times and shows stats\n- [ ] Shows: mean, min, max, stddev\n- [ ] Warmup runs (exclude from stats)\n- [ ] Configurable iterations: `bench -n 100 command`\n- [ ] Optional comparison: `bench cmd1 vs cmd2`\n- [ ] Clean, readable output\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# Quick benchmark\nbench find . -name \"*.rs\"\n# Iterations: 10\n# Mean:   45.2ms\n# Min:    42.1ms\n# Max:    51.3ms\n# Stddev:  2.8ms\n\n# Compare commands\nbench \"rush -c 'cat file | grep foo'\" vs \"bash -c 'cat file | grep foo'\"\n# rush:  4.5ms (baseline)\n# bash: 12.3ms (2.7x slower)\n\n# Custom iterations\nbench -n 100 echo hello\n```\n\n## Technical Implementation\n- Add to src/builtins/bench.rs\n- Use std::time::Instant for timing\n- Calculate statistics (mean, stddev)\n- Format output nicely\n- Optional: integration with criterion\n\n## Differentiation\n- Built-in hyperfine equivalent\n- Faster than external tools\n- Rush-specific optimizations\n- Great for demos and HN posts\n\n## Testing\n- Benchmark accuracy\n- Statistics calculation\n- Comparison mode\n- Edge cases\n\n## Estimated Effort: 2 days","status":"open","priority":4,"issue_type":"feature","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-20T19:00:00-08:00","labels":["benchmarking","builtin","differentiation","p3","unique"]}
{"id":"rush-uniq.2","title":"UNIQUE-002: watch builtin","description":"As a developer, I want a built-in watch command so I can monitor command output over time.\n\n## Priority: P3 - NICE TO HAVE\nUnique to Rush - quality of life feature.\n\n## Acceptance Criteria\n- [ ] `watch command` runs command every 2 seconds\n- [ ] `watch -n N command` custom interval\n- [ ] Clear screen between runs\n- [ ] Show timestamp and iteration count\n- [ ] Ctrl-C to exit\n- [ ] Highlight changes (optional)\n- [ ] Exit on error (optional: -e flag)\n- [ ] cargo test passes\n- [ ] cargo build --release succeeds\n- [ ] cargo clippy -- -D warnings passes\n\n## Use Cases\n```bash\n# Watch test results\nwatch cargo test\n\n# Monitor git status\nwatch -n 1 git status\n\n# Watch file changes\nwatch \"ls -l | grep myfile\"\n\n# Exit on error\nwatch -e \"cargo build \u0026\u0026 cargo test\"\n```\n\n## Technical Implementation\n- Add to src/builtins/watch.rs\n- Loop with sleep interval\n- Clear terminal between runs\n- Execute command and capture output\n- Optional: diff highlighting\n\n## Differentiation\n- Built-in GNU watch equivalent\n- Faster startup than external watch\n- Integrated with Rush builtins\n- Better error messages\n\n## Testing\n- Basic watching\n- Custom intervals\n- Exit on error\n- Ctrl-C handling\n\n## Estimated Effort: 1 day","status":"open","priority":4,"issue_type":"feature","owner":"a@kf.cafe","created_at":"2026-01-20T19:00:00-08:00","created_by":"Asher","updated_at":"2026-01-20T19:00:00-08:00","labels":["builtin","differentiation","monitoring","p3","unique"]}
{"id":"rush-vlf","title":"Implement cross-session history sync","description":"Add history synchronization across multiple Rush sessions: 1) Real-time or periodic sync, 2) Conflict resolution for concurrent edits, 3) Optional cloud sync support, 4) Privacy controls, 5) Session-specific vs global history","status":"open","priority":3,"issue_type":"feature","owner":"a@kf.cafe","created_at":"2026-01-20T03:03:31.817197-08:00","created_by":"Asher","updated_at":"2026-01-20T03:03:31.817197-08:00","labels":["enhancement","phase5"]}
