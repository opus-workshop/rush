id: '55'
title: 'STABILITY-008: Command Substitution'
status: open
priority: 2
created_at: 2026-01-30T18:49:24.539466Z
updated_at: 2026-01-30T18:49:24.539466Z
description: |-
  As a shell scripter, I need command substitution so that I can use command output in other commands.

  ## Priority: P1 - HIGH
  Essential for shell scripting.

  ## Acceptance Criteria
  - [ ] $(command) syntax works
  - [ ] \`command\` backticks work (bonus)
  - [ ] Nested substitution works: $(echo $(pwd))
  - [ ] Substitution in strings: "path: $(pwd)"
  - [ ] Exit code of substituted command available
  - [ ] Whitespace handling correct (trimming)
  - [ ] Works in pipes and redirects
  - [ ] cargo test passes (all tests including substitution tests)
  - [ ] cargo build --release succeeds
  - [ ] cargo clippy -- -D warnings passes

  ## Technical Implementation
  ```rust
  pub fn execute_command_substitution(&mut self, command: &str) -> Result<String> {
      let result = self.execute_line(command)?;
      Ok(result.stdout.trim_end().to_string())
  }
  ```

  ## Files to Modify
  - src/parser/mod.rs - Parse $() syntax
  - src/executor/mod.rs - Execute and capture output
  - src/runtime/mod.rs - Substitute into parent command

  ## Testing
  - Test simple substitution
  - Test nested substitution
  - Test substitution in strings
  - Test whitespace handling

  ## Estimated Effort: 1 day
labels:
- p1
- rush
- stability
- substitution
verify: 'cargo build --release && cargo test && echo "echo test" | ./target/release/rush'
