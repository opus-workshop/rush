id: '193.1'
title: getopts builtin - POSIX option parsing
slug: getopts-builtin-posix-option-parsing
status: closed
priority: 0
created_at: 2026-02-02T01:07:48.430168Z
updated_at: 2026-02-02T21:56:08.904593Z
description: "Implement the getopts builtin for POSIX-compliant option parsing in scripts.\n\n## POSIX Specification\ngetopts optstring name [arg...]\n\n- Parse positional parameters or args for options\n- Set OPTIND to next argument index  \n- Set OPTARG to option argument (for options with :)\n- Set name to option character\n- Return 0 while options remain, 1 when done\n- Return ? for unknown options\n\n## Usage Pattern\n```sh\nwhile getopts \"ab:c\" opt; do\n  case $opt in\n    a) echo \"Option a\";;\n    b) echo \"Option b with arg: $OPTARG\";;\n    c) echo \"Option c\";;\n    \\?) echo \"Invalid option\";;\n  esac\ndone\nshift $((OPTIND - 1))\n```\n\n## Implementation\n- File: src/builtins/getopts.rs\n- Track OPTIND in runtime state\n- Handle : for required arguments\n- Handle :: for optional arguments (extension)\n- Support + prefix for turning off options (extension)\n- Proper error handling for missing args\n\n## Files to Modify\n- src/builtins/mod.rs - register builtin\n- src/builtins/getopts.rs - new file\n- src/runtime/mod.rs - OPTIND, OPTARG variables"
acceptance: getopts builtin parses options per POSIX spec; OPTIND and OPTARG set correctly; works with while loops
labels:
- posix
- builtin
- critical
closed_at: 2026-02-02T21:56:08.904593Z
verify: cargo test --test getopts_tests
attempts: 1
claimed_at: 2026-02-02T21:46:38.586194Z
is_archived: true
