id: '2.6'
title: 'Tool: 8b_infer_deps - Auto-detect produces/requires'
slug: tool-8binferdeps-auto-detect-producesrequires
status: closed
priority: 2
created_at: 2026-02-03T08:51:25.397499Z
updated_at: 2026-02-03T09:06:53.213693Z
description: "## What to implement\nRegister `8b_infer_deps` tool that analyzes beans and code to infer produces/requires relationships.\n\n## Files\n- ~/.pi/agent/extensions/8b-tools/tools/infer-deps.ts\n\n## Interface\n```typescript\npi.registerTool({\n  name: \"8b_infer_deps\",\n  description: \"Analyze sibling beans to infer produces/requires dependencies automatically.\",\n  parameters: Type.Object({\n    parentId: Type.String({ description: \"Parent bean ID whose children to analyze\" })\n  }),\n  async execute(toolCallId, params, signal, onUpdate, ctx) {\n    // 1. List children of parent\n    // 2. For each child, read description\n    // 3. Use 8B to extract:\n    //    - What artifacts this bean creates (types, functions, files)\n    //    - What artifacts this bean needs that it doesn't create\n    // 4. Match requires → produces across siblings\n    // 5. Suggest dependency edges\n  }\n});\n```\n\n## Example\n```\nParent: 14 \"Implement auth\"\nChildren:\n  14.1 \"Define auth types\" \n  14.2 \"Implement JWT provider\"\n  14.3 \"Add auth middleware\"\n\nOutput:\n  14.1 produces: [AuthConfig, AuthProvider, AuthError]\n  14.2 requires: [AuthProvider] → depends on 14.1\n       produces: [JwtProvider]\n  14.3 requires: [JwtProvider] → depends on 14.2\n       produces: [AuthMiddleware]\n  \n  Suggested: bn dep add 14.2 14.1 && bn dep add 14.3 14.2\n```\n\n## Acceptance\n- Lists and parses all child beans\n- 8B extracts artifacts from descriptions\n- Matches requires to sibling produces\n- Outputs bn commands to set dependencies"
closed_at: 2026-02-03T09:06:53.213693Z
close_reason: |-
  Implemented 8b_infer_deps tool with:
  - Created tools/infer-deps.ts with inferDeps() function
  - Parses child beans from .beans/ directory by parent ID
  - Uses 8B model to extract produces/requires artifacts from bean descriptions
  - Matches requires to produces across siblings to detect dependencies
  - Outputs formatted analysis with suggested `bn dep add` commands
  - Registered tool in index.ts with proper parameters and output formatting
parent: '2'
verify: grep -q "8b_infer_deps" ~/.pi/agent/extensions/8b-tools/index.ts
claimed_at: 2026-02-03T09:04:46.894877Z
is_archived: true
produces:
- 8b_infer_deps_tool
requires:
- CerebrasClient
