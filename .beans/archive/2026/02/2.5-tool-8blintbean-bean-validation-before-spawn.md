id: '2.5'
title: 'Tool: 8b_lint_bean - Bean validation before spawn'
slug: tool-8blintbean-bean-validation-before-spawn
status: closed
priority: 2
created_at: 2026-02-03T08:51:25.382350Z
updated_at: 2026-02-03T09:07:02.481992Z
description: "## What to implement\nRegister `8b_lint_bean` tool that validates beans are well-formed before spawning agents.\n\n## Files\n- ~/.pi/agent/extensions/8b-tools/tools/lint-bean.ts\n\n## Interface\n```typescript\npi.registerTool({\n  name: \"8b_lint_bean\",\n  description: \"Validate a bean is well-formed and ready for implementation. Checks: has verify, files exist, scope is reasonable, no ambiguity.\",\n  parameters: Type.Object({\n    beanId: Type.String({ description: \"Bean ID to lint (e.g., '14.1')\" })\n  }),\n  async execute(toolCallId, params, signal, onUpdate, ctx) {\n    // 1. Read bean file from .beans/\n    // 2. Parse YAML frontmatter\n    // 3. Check:\n    //    - Has verify command\n    //    - Referenced files exist\n    //    - Estimate scope (functions to write)\n    //    - Description is concrete not vague\n    // 4. Use 8B to assess ambiguity/completeness\n    return {\n      content: [{ type: \"text\", text: lintReport }],\n      details: { \n        valid: boolean,\n        issues: string[],\n        suggestions: string[]\n      }\n    };\n  }\n});\n```\n\n## Checks\n- ✓ Has verify command\n- ✓ Files referenced exist (or marked as \"create\")\n- ✓ Estimated scope <= 5 functions\n- ✓ Has concrete acceptance criteria\n- ✗ Vague language (\"improve\", \"refactor\" without specifics)\n- ✗ Missing context (no code snippets embedded)\n\n## Acceptance\n- Reads bean from .beans/ directory\n- Performs structural checks (YAML valid, has verify)\n- Uses 8B to assess clarity/ambiguity\n- Returns actionable issues list"
closed_at: 2026-02-03T09:07:02.481992Z
close_reason: |-
  Implemented 8b_lint_bean tool with:
  - lint-bean.ts: Core linting logic with YAML parsing, file existence checks, scope estimation
  - Structural checks: verify command, title, description completeness
  - File validation: extracts and validates referenced file paths
  - Scope estimation: counts functions to detect oversized beans
  - 8B clarity assessment: detects vague language and missing context
  - Registered in index.ts with formatted output showing errors/warnings/suggestions
parent: '2'
verify: grep -q "8b_lint_bean" ~/.pi/agent/extensions/8b-tools/index.ts
claimed_at: 2026-02-03T09:04:46.856635Z
is_archived: true
produces:
- 8b_lint_bean_tool
requires:
- CerebrasClient
