id: '200.1'
title: 'Parameter expansion: string length ${#var}'
slug: parameter-expansion-string-length-var
status: closed
priority: 2
created_at: 2026-02-02T17:20:40.968098Z
updated_at: 2026-02-02T17:35:35.751669Z
description: |-
  ## What to implement
  Add support for `${#var}` syntax to return the string length of a variable.

  ## Current State
  `${#x}` returns empty string instead of the length.

  ## Implementation
  Modify `expand_braced_variable()` in executor to detect `#` prefix:

  ```rust
  // In expand_braced_variable(), add at the start:
  if expr.starts_with('#') {
      let var_name = &expr[1..];
      return self.runtime
          .get_variable(var_name)
          .map(|v| v.len().to_string())
          .unwrap_or_else(|| "0".to_string());
  }
  ```

  ## Files
  - src/executor/mod.rs (expand_braced_variable function, ~line 1154)

  ## Acceptance
  - [ ] `${#x}` returns length of x
  - [ ] `${#undefined}` returns 0
  - [ ] Works in double-quoted strings: `"len=${#x}"`
closed_at: 2026-02-02T17:35:35.751669Z
parent: '200'
verify: rush -c "x=hello; echo \${#x}" | grep -q 5
attempts: 1
claimed_at: 2026-02-02T17:28:49.708362Z
is_archived: true
