id: '193.8'
title: cd -e option for PWD error detection
slug: cd-e-option-for-pwd-error-detection
status: closed
priority: 2
created_at: 2026-02-02T01:08:56.469593Z
updated_at: 2026-02-02T09:39:30.542939Z
description: |-
  Add -e option to cd builtin (refined in POSIX.1-2024).

  ## POSIX.1-2024 Specification
  cd -e
  - Causes error if the new PWD cannot be determined
  - Normally cd succeeds even if getcwd() fails
  - With -e, cd returns non-zero if PWD is indeterminate

  ## Use Case
  ```sh
  # Detect if we're in a valid directory
  if cd -e /some/path 2>/dev/null; then
    echo "In valid directory: $PWD"
  else
    echo "Directory access problem"
  fi
  ```

  ## Implementation
  - Add -e flag handling to cd builtin
  - After chdir(), check if getcwd() succeeds
  - Return error if pwd cannot be determined

  ## Files to Modify
  - src/builtins/cd.rs - add -e option handling
acceptance: cd -e fails if PWD cannot be determined after change; useful for detecting broken symlinks
labels:
- posix
- posix-2024
- builtin
closed_at: 2026-02-02T09:39:30.542939Z
parent: '193'
verify: cargo test cd_e_option
claimed_at: 2026-02-02T09:39:30.530622Z
is_archived: true
