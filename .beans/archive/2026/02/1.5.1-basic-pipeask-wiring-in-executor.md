id: 1.5.1
title: Basic PipeAsk wiring in executor
slug: basic-pipeask-wiring-in-executor
status: closed
priority: 1
created_at: 2026-02-03T09:06:45.585664Z
updated_at: 2026-02-03T09:10:21.768081Z
description: "## What to implement\n\nWire the `PipeAsk` AST node into the executor's statement dispatch.\n\n### Functions to write\n\n1. **Add match arm in `execute_statement()`** - Handle `Statement::PipeAsk`\n2. **`execute_pipe_ask(&mut self, pipe_ask: &PipeAsk) -> Result<ExecutionResult>`** - Basic implementation that:\n   - Executes the inner command (`pipe_ask.command`) \n   - Captures its output\n   - Returns the output for now (Pi integration in next bean)\n\n## Files\n\n- `src/executor/mod.rs` (modify)\n\n## Context\n\n### PipeAsk AST node (from src/parser/ast.rs)\n```rust\n/// A command that pipes its output to AI for processing\n#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]\npub struct PipeAsk {\n    /// The command whose output to send to AI\n    pub command: Box<Statement>,\n    /// The prompt for the AI (empty string if omitted)\n    pub prompt: String,\n}\n```\n\n### Statement enum (add PipeAsk case)\n```rust\npub enum Statement {\n    Command(Command),\n    Pipeline(Pipeline),\n    // ... other variants ...\n    PipeAsk(PipeAsk),  // Already defined\n}\n```\n\n### execute_statement pattern (around line 184)\n```rust\npub fn execute_statement(&mut self, statement: Statement) -> Result<ExecutionResult> {\n    match statement {\n        Statement::Command(cmd) => self.execute_command(cmd),\n        Statement::Pipeline(pipeline) => self.execute_pipeline(pipeline),\n        // ... add PipeAsk here ...\n    }\n}\n```\n\n### ExecutionResult type\n```rust\npub struct ExecutionResult {\n    pub output: Output,\n    pub stderr: String, \n    pub exit_code: i32,\n    pub error: Option<String>,\n}\n```\n\n## Acceptance\n\n- [ ] `Statement::PipeAsk` case added to `execute_statement()` match\n- [ ] `execute_pipe_ask()` function exists\n- [ ] Inner command is executed and output captured\n- [ ] `cargo check` passes with no errors\n\n## Produces\n- executor_pipe_ask_wiring\n\n\n## Requires\n- parser_pipe_ask\n"
closed_at: 2026-02-03T09:10:21.768081Z
close_reason: 'Implemented basic PipeAsk wiring: execute_pipe_ask now executes the inner command and captures its output, returning the result. The prompt is available for future Pi integration.'
parent: '1.5'
verify: grep -q "Statement::PipeAsk" src/executor/mod.rs && grep -q "fn execute_pipe_ask" src/executor/mod.rs && cargo check 2>&1 | grep -v "^warning"
claimed_at: 2026-02-03T09:09:39.935920Z
is_archived: true
