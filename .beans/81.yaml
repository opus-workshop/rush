id: '81'
title: 'POSIX-019: Implement case statement'
status: open
priority: 1
created_at: 2026-01-30T18:49:24.695648Z
updated_at: 2026-01-30T18:49:24.695648Z
description: |-
  Implement POSIX case statement (or make existing match POSIX-compatible).

  ## Context
  Rush has a `match` expression. Need POSIX case statement syntax.

  ## Acceptance Criteria
  - Decide: adapt existing match OR implement separate case
  - Add case parsing to parser (case/in/pattern/;;/esac)
  - Add Case node to AST (or adapt Match)
  - Implement case execution in executor
  - Test basic case: `case $x in pat1) echo 1;; pat2) echo 2;; esac`
  - Test multiple patterns: `pat1|pat2) echo matched;;`
  - Test wildcard pattern: `*) echo default;;`
  - Test pattern matching with globs: `*.txt) echo text file;;`
  - Test fall-through behavior (;; vs ;& vs ;;& if implementing bash extensions)
  - Add integration tests
  - Document syntax

  ## POSIX Requirements
  - `case word in [pattern [| pattern]...) list ;;]... esac`
  - Matches word against patterns (glob-style)
  - Executes list for first matching pattern
  - Patterns can use *, ?, [...]
  - Multiple patterns separated by |
  - Exit code is last command in executed list, or 0 if no match

  ## Files to Create/Modify
  - src/parser.rs (add case parsing)
  - src/ast.rs (add Case node or adapt Match)
  - src/executor/mod.rs (add case execution with pattern matching)
  - tests/case_statement_tests.rs (add tests)

  ## Estimated Effort
  50-60k tokens (complex parsing, pattern matching, add tests)
verify: cargo build --release && cargo test && cargo clippy -- -D warnings
labels:
- control-flow
- critical
- parser
- posix
