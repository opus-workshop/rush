id: '95'
title: 'POSIX-006: Re-enable and test eval builtin'
status: open
priority: 1
created_at: 2026-01-30T18:49:24.785628Z
updated_at: 2026-01-30T18:49:24.785628Z
description: |-
  Re-enable the `eval` builtin for evaluating strings as shell commands.

  ## Context
  The `eval` builtin exists at `src/builtins/eval.rs` but is commented out. Powerful for dynamic command construction.

  ## Acceptance Criteria
  - Uncomment `eval` module in src/builtins/mod.rs
  - Uncomment eval builtin registration
  - Test basic eval: `eval "echo hello"` → hello
  - Test variable expansion: `cmd="echo hello"; eval $cmd` → hello
  - Test command substitution: `eval "x=\$(echo 5); echo \$x"` → 5
  - Test multiple statements: `eval "x=5; y=10; echo \$((x + y))"` → 15
  - Test proper exit code propagation
  - Test error handling for invalid commands
  - Add integration tests
  - Update help text

  ## POSIX Requirements
  - Concatenate arguments into single string
  - Parse and execute the string as shell commands
  - Return exit code of last executed command
  - Variables expanded twice (once by shell, once by eval)

  ## Files to Modify
  - src/builtins/mod.rs (uncomment)
  - src/builtins/eval.rs (verify implementation)
  - src/executor/mod.rs (verify eval integration with parser)
  - tests/eval_tests.rs or similar (add tests)

  ## Estimated Effort
  40-50k tokens (re-enable, test edge cases, add tests)
labels:
- builtin
- critical
- execution
- posix
verify: 'cargo build --release && cargo test && cargo clippy -- -D warnings'
