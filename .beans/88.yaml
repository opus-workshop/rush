id: '88'
title: 'POSIX-026: Implement arbitrary FD redirection'
status: open
priority: 2
created_at: 2026-01-30T18:49:24.740219Z
updated_at: 2026-01-30T18:49:24.740219Z
description: |-
  Implement arbitrary file descriptor redirection (N>&M, N<&M, N>&-, etc.).

  ## Context
  Currently only supports standard redirections (>, >>, <, 2>). Need full FD manipulation.

  ## Acceptance Criteria
  - Implement N>file (redirect FD N to file)
  - Implement N<file (redirect FD N from file)
  - Implement N>&M (duplicate FD M to N)
  - Implement N<&M (duplicate FD M to N for reading)
  - Implement N>&- (close FD N)
  - Add FD table to Runtime to track open descriptors
  - Test exec 3>file; echo hello >&3; exec 3>&-
  - Test swapping stdout/stderr: 3>&1 1>&2 2>&3
  - Test FD inheritance in subshells
  - Add integration tests
  - Document FD redirection

  ## POSIX Requirements
  - N can be any digit (usually 0-9, but higher allowed)
  - N>&M duplicates file descriptor
  - N>&- closes file descriptor
  - exec with redirections makes them permanent
  - FDs inherit to child processes

  ## Files to Modify
  - src/parser.rs (parse N>&M syntax)
  - src/ast.rs (add FD info to Redirect node)
  - src/runtime/mod.rs (add FD table)
  - src/executor/mod.rs (handle arbitrary FD redirections)
  - tests/fd_redirection_tests.rs (add tests)

  ## Estimated Effort
  55-60k tokens (complex FD management, parsing, add tests)
labels:
- fd
- important
- io
- posix
- redirection
