id: '184'
title: 'UNIQUE-001: bench builtin'
status: open
priority: 4
created_at: 2026-01-30T18:49:25.528748Z
updated_at: 2026-01-30T18:49:25.528748Z
description: |-
  As a performance-conscious developer, I want a built-in benchmarking tool so I can quickly measure command performance.

  ## Priority: P3 - NICE TO HAVE
  Unique to Rush - differentiation feature.

  ## Acceptance Criteria
  - [ ] `bench command` runs command N times and shows stats
  - [ ] Shows: mean, min, max, stddev
  - [ ] Warmup runs (exclude from stats)
  - [ ] Configurable iterations: `bench -n 100 command`
  - [ ] Optional comparison: `bench cmd1 vs cmd2`
  - [ ] Clean, readable output
  - [ ] cargo test passes
  - [ ] cargo build --release succeeds
  - [ ] cargo clippy -- -D warnings passes

  ## Use Cases
  ```bash
  # Quick benchmark
  bench find . -name "*.rs"
  # Iterations: 10
  # Mean:   45.2ms
  # Min:    42.1ms
  # Max:    51.3ms
  # Stddev:  2.8ms

  # Compare commands
  bench "rush -c 'cat file | grep foo'" vs "bash -c 'cat file | grep foo'"
  # rush:  4.5ms (baseline)
  # bash: 12.3ms (2.7x slower)

  # Custom iterations
  bench -n 100 echo hello
  ```

  ## Technical Implementation
  - Add to src/builtins/bench.rs
  - Use std::time::Instant for timing
  - Calculate statistics (mean, stddev)
  - Format output nicely
  - Optional: integration with criterion

  ## Differentiation
  - Built-in hyperfine equivalent
  - Faster than external tools
  - Rush-specific optimizations
  - Great for demos and HN posts

  ## Testing
  - Benchmark accuracy
  - Statistics calculation
  - Comparison mode
  - Edge cases

  ## Estimated Effort: 2 days
labels:
- benchmarking
- builtin
- differentiation
- p3
- unique
