id: '84'
title: 'POSIX-022: Implement terminal control'
status: open
priority: 2
created_at: 2026-01-30T18:49:24.714928Z
updated_at: 2026-01-30T18:49:24.714928Z
description: |-
  Implement terminal foreground process group control.

  ## Context
  POSIX requires foreground jobs to control the terminal. Use tcsetpgrp() to manage terminal control.

  ## Acceptance Criteria
  - Implement tcsetpgrp() to give terminal to foreground job
  - Return terminal control to shell when job finishes
  - Test foreground job receives SIGINT from Ctrl+C
  - Test background job doesn't receive SIGINT
  - Test fg command gives terminal to job
  - Test terminal state is restored after job exits
  - Handle SIGTTIN/SIGTTOU for background jobs accessing terminal
  - Add integration tests
  - Document terminal control

  ## POSIX Requirements
  - Foreground job has control of terminal
  - tcsetpgrp() sets foreground process group
  - Background jobs that access terminal get SIGTTIN/SIGTTOU
  - Shell regains terminal control when foreground job finishes

  ## Files to Modify
  - src/executor/mod.rs (call tcsetpgrp for foreground jobs)
  - src/jobs/mod.rs (restore terminal to shell after job)
  - src/builtins/jobs.rs (fg command gives terminal to job)
  - libc or nix crate for tcsetpgrp syscall
  - tests/terminal_control_tests.rs (add tests)

  ## Estimated Effort
  50-60k tokens (implement terminal management, signal handling, add tests)
labels:
- important
- job-control
- posix
- terminal
verify: 'cargo build --release && cargo test && cargo clippy -- -D warnings'
