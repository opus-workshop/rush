id: '163'
title: 'FOUNDATION-008: Here-documents'
status: open
priority: 2
created_at: 2026-01-30T18:49:25.326082Z
updated_at: 2026-01-30T18:49:25.326082Z
description: "## Problem\nHere-documents (`<<EOF`) don't work.\n\n## Current Behavior\n```bash\ncat <<EOF\nhello\nEOF\n# Error: unexpected token or hangs\n```\n\n## Expected Behavior\n```bash\ncat <<EOF      # Feed multi-line input to command\nhello\nworld\nEOF\n\ncat <<'EOF'    # No variable expansion (quoted delimiter)\n$HOME\nEOF\n\ncat <<-EOF     # Strip leading tabs\n\tindented\nEOF\n```\n\n## Implementation\n1. Lexer must recognize `<<WORD` as here-doc start\n2. Read lines until delimiter WORD appears alone on a line\n3. Handle quoting:\n   - Unquoted delimiter: expand variables in body\n   - Quoted delimiter ('EOF' or \"EOF\"): literal body\n4. Handle `<<-` variant (strip leading tabs)\n5. Multiple here-docs can appear on same line\n\n## Test Cases\n```bash\ntest_case \"here-doc basic\" $'cat <<EOF\\nhello\\nEOF' 'hello'\ntest_case \"here-doc multiline\" $'cat <<EOF\\nline1\\nline2\\nEOF' $'line1\\nline2'\ntest_case \"here-doc with var\" $'x=world; cat <<EOF\\nhello $x\\nEOF' 'hello world'\n```"
